"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Frontend=t():(e.Frontend=e.Frontend||{},e.Frontend["pages/ide"]=t())}(self,(()=>(self.webpackChunkFrontend=self.webpackChunkFrontend||[]).push([[1320],{7725:(e,t,n)=>{n.d(t,{GR:()=>l,xx:()=>a});n(97107);var r=n(14041),i=n(89139),s=n(31085);const o=(0,r.createContext)(void 0),a=e=>{let{children:t}=e;const[n,a]=(0,r.useState)((()=>({settingToFocus:void 0})));return(0,i.A)("ui.focus-setting",(0,r.useCallback)((e=>{a((t=>({...t,settingToFocus:e.detail})))}),[])),(0,s.jsx)(o.Provider,{value:n,children:t})},l=()=>{const e=(0,r.useContext)(o);if(!e)throw new Error("useEditorLeftMenuContext is only available inside EditorLeftMenuProvider");return e}},80124:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(22046),i=n(39067),s=n.n(i),o=n(31085);function a(e){let{children:t}=e;return(0,o.jsx)(r.A,{type:"error",content:t})}a.propTypes={children:s().any.isRequired}},60718:(e,t,n)=>{n.d(t,{A:()=>h});var r=n(39067),i=n.n(r),s=n(97434),o=n(37858),a=n(14041),l=n(66666),c=n(89753);function d(){const{t:e}=(0,s.Bd)(),{_id:t}=(0,l.O)(),[n,r]=(0,a.useState)(10),i=(0,c.z)();return(0,a.useEffect)((()=>{r(10);const e=window.setInterval((()=>{r((n=>0===n?(window.clearInterval(e),i.assign(`/login?redir=/project/${t}`),0):n-1))}),1e3);return()=>{window.clearInterval(e)}}),[t,i]),e("session_expired_redirecting_to_login",{seconds:n})}var u=n(27916),p=n(80124),m=n(31085);function h(e){let{error:t}=e;const{t:n}=(0,s.Bd)();if("string"==typeof t)switch(t){case"name-exists":return(0,m.jsx)(p.A,{children:n("file_already_exists")});case"too-many-files":return(0,m.jsx)(p.A,{children:n("project_has_too_many_files")});case"remote-service-error":return(0,m.jsx)(p.A,{children:n("remote_service_error")});case"folder_not_found":return(0,m.jsx)(p.A,{children:n("the_target_folder_could_not_be_found")});case"invalid_filename":return(0,m.jsx)(p.A,{children:n("invalid_filename",{nameLimit:150})});case"duplicate_file_name":return(0,m.jsx)(p.A,{children:n("file_or_folder_name_already_exists")});case"rate-limit-hit":return(0,m.jsx)(p.A,{children:n("too_many_files_uploaded_throttled_short_period")});case"not-logged-in":return(0,m.jsx)(p.A,{children:(0,m.jsx)(d,{})});case"linked-project-compile-error":return(0,m.jsx)(p.A,{children:n("generic_linked_file_compile_error")});default:return(0,m.jsx)(p.A,{children:n("generic_something_went_wrong")})}switch(t.constructor){case o.fk:{const e=t.data?.message;if(e)return(0,m.jsx)(p.A,{children:e.text||e});switch(t.response?.status){case 400:return(0,m.jsx)(p.A,{children:n("invalid_request")});case 403:return(0,m.jsx)(p.A,{children:n("session_error")});case 429:return(0,m.jsx)(p.A,{children:n("too_many_attempts")});default:return(0,m.jsx)(p.A,{children:n("something_went_wrong_server")})}}case u.Lc:case u.di:case u.yG:return null;default:return(0,m.jsx)(p.A,{children:n("generic_something_went_wrong")})}}h.propTypes={error:i().oneOfType([i().string,i().object]).isRequired}},92902:(e,t,n)=>{n.d(t,{g:()=>y,m:()=>v});n(97107);var r=n(14041),i=n(22344),s=n(9993),o=n(79550),a=n(71735),l=n(67227),c=n(66666),d=n(71573),u=n(88588),p=n(27916),m=n(94012),h=n(58516),f=n(31085);const g=(0,r.createContext)(void 0);var x=function(e){return e.START_RENAME="START_RENAME",e.START_DELETE="START_DELETE",e.DELETING="DELETING",e.START_CREATE_FILE="START_CREATE_FILE",e.START_CREATE_FOLDER="START_CREATE_FOLDER",e.CREATING_FILE="CREATING_FILE",e.CREATING_FOLDER="CREATING_FOLDER",e.MOVING="MOVING",e.CANCEL="CANCEL",e.CLEAR="CLEAR",e.ERROR="ERROR",e}(x||{});const j={isDeleting:!1,isRenaming:!1,isCreatingFile:!1,isCreatingFolder:!1,isMoving:!1,inFlight:!1,actionedEntities:null,newFileCreateMode:null,error:null};function b(e){return e}function _(e,t){switch(t.type){case x.START_RENAME:return{...j,isRenaming:!0};case x.START_DELETE:return{...j,isDeleting:!0,actionedEntities:t.actionedEntities};case x.START_CREATE_FILE:return{...j,isCreatingFile:!0,newFileCreateMode:t.newFileCreateMode};case x.START_CREATE_FOLDER:return{...j,isCreatingFolder:!0};case x.CREATING_FILE:return{...j,isCreatingFile:!0,newFileCreateMode:e.newFileCreateMode,inFlight:!0};case x.CREATING_FOLDER:return{...j,isCreatingFolder:!0,inFlight:!0};case x.DELETING:return{...j,isDeleting:!0,inFlight:!0,actionedEntities:e.actionedEntities};case x.MOVING:return{...j,isMoving:!0,inFlight:!0};case x.CLEAR:return{...j};case x.CANCEL:return e.inFlight?e:{...j};case x.ERROR:return{...e,inFlight:!1,error:t.error};default:throw new Error(`Unknown user action type: ${t.type}`)}}const y=e=>{let{children:t}=e;const{_id:n}=(0,c.O)(),{fileTreeReadOnly:y}=(0,d.Q)(),{indexAllReferences:v}=(0,m.B4)(),{write:w}=(0,h.Tg)(),[C,k]=(0,r.useReducer)(y?b:_,j),{fileTreeData:A,dispatchRename:E,dispatchMove:S}=(0,d.Q)(),{selectedEntityIds:N,isRootFolderSelected:R}=(0,u.G1)(),[F,T]=(0,r.useState)(null),P=(0,r.useCallback)((()=>{k({type:x.START_RENAME})}),[]),L=(0,r.useCallback)((e=>{const t=Array.from(N)[0],r=(0,o.k3)(A,t),i=r.entity.name;if(e===i)return k({type:x.CLEAR});const c=function(e,t,n){if(!(0,l.tL)(n))return new p.di;if(!(0,a.MS)(e,t.parentFolderId,n))return new p.Lc;const r=1===t.path.length,i="folder"===t.type;if(r&&!i&&(0,l.kW)(n))return new p.yG}(A,r,e);return c?k({type:x.ERROR,error:c}):(k({type:x.CLEAR}),E(t,e),(0,s.Mb)(n,r.type,r.entity._id,e).catch((e=>{E(t,i),k({type:x.ERROR,error:e})})))}),[E,A,n,N]),D=(0,r.useCallback)(((e,t)=>!(0,a.MS)(A,e,t)),[A]),I=(0,r.useCallback)((()=>{const e=Array.from(N).map((e=>(0,o.k3)(A,e).entity));k({type:x.START_DELETE,actionedEntities:e})}),[A,N]),M=(0,r.useCallback)((()=>{k({type:x.DELETING});let e=!1;return(0,i._)(Array.from(N),(t=>{const r=(0,o.k3)(A,t);return e=e||/\.bib$/.test(r.entity.name),(0,s.Dl)(n,r.type,r.entity._id).catch((e=>{if(404!==e.info.statusCode)throw e}))})).then((()=>{e&&v(!0),k({type:x.CLEAR})})).catch((e=>{k({type:x.ERROR,error:e})}))}),[A,n,N,v]),O=(0,r.useCallback)(((e,t)=>{k({type:x.MOVING});const r=Array.from(t).map((e=>(0,o.k3)(A,e))).filter((n=>n.parentFolderId!==e&&!t.has(n.parentFolderId))),c=e===A._id,d=r.map((t=>function(e,t,n,r){if(!(0,a.MS)(e,t,n.entity.name)){const e=new p.ui;return e.entityName=n.entity.name,e}const i="folder"===n.type;if(r&&!i&&(0,l.kW)(n.entity.name))return new p.yG}(A,e,t,c))).find((e=>e));if(d)return k({type:x.ERROR,error:d});const u={};let m=!1;return r.forEach((t=>{u[t.entity._id]=t.parentFolderId,S(t.entity._id,e)})),(0,i._)(r,(async t=>{try{await(0,s.r_)(n,t.type,t.entity._id,e)}catch(e){m=!0,S(t.entity._id,u[t.entity._id]),k({type:x.ERROR,error:e})}})).then((()=>{m||k({type:x.CLEAR})}))}),[S,A,n]),B=(0,r.useCallback)((()=>{k({type:x.START_CREATE_FOLDER})}),[]),q=(0,r.useMemo)((()=>function(e,t,n){if(n)return e._id;const r=Array.from(t)[0];if(!r)return e._id;const i=(0,o.lE)(e,r);if(!i)return e._id;return"folder"===i.type?i.entity._id:i.parentFolderId}(A,N,R)),[A,N,R]),$=(0,r.useMemo)((()=>{if(1===N.size){const[e]=N,t=(0,o.lE)(A,e);return t?.entity?.name}return null}),[A,N]),z=(0,r.useCallback)((e=>{const t=function(e,t,n){if(!(0,l.tL)(n.name))return new p.di;if(!(0,a.MS)(e,t,n.name))return new p.Lc;const r=t===e._id,i="folder"===n.endpoint;if(r&&!i&&(0,l.kW)(n.name))return new p.yG}(A,q,e);return t?Promise.reject(t):(0,s.xy)(n,q,e)}),[A,q,n]),U=(0,r.useCallback)((e=>(k({type:x.CREATING_FOLDER}),z({endpoint:"folder",name:e}).then((()=>{k({type:x.CLEAR})})).catch((e=>{k({type:x.ERROR,error:e})})))),[z]),V=(0,r.useCallback)((e=>{k({type:x.START_CREATE_FILE,newFileCreateMode:e})}),[]),H=(0,r.useCallback)((()=>{V("doc")}),[V]),G=(0,r.useCallback)((()=>{V("upload")}),[V]),K=(0,r.useCallback)((e=>(k({type:x.CREATING_FILE}),z(e).then((()=>{k({type:x.CLEAR})})).catch((e=>{k({type:x.ERROR,error:e})})))),[z]),Y=(0,r.useCallback)((e=>(e.endpoint="doc",K(e))),[K]),W=(0,r.useCallback)((e=>(e.endpoint="linked_file",K(e))),[K]),Q=(0,r.useCallback)((()=>{k({type:x.CANCEL})}),[]);(0,r.useEffect)((()=>{function e(e){k({type:x.START_CREATE_FILE,newFileCreateMode:e.detail.mode})}return window.addEventListener("file-tree.start-creating",e),()=>{window.removeEventListener("file-tree.start-creating",e)}}),[]);const X=(0,r.useMemo)((()=>{if(1===N.size){const[e]=N,t=(0,o.lE)(A,e);if("fileRef"===t?.type)return`/project/${n}/blob/${t.entity.hash}?fallback=${e}`;if("doc"===t?.type)return`/project/${n}/doc/${e}/download`}}),[A,n,N]),Z=(0,r.useMemo)((()=>({canDelete:w&&N.size>0&&!R,canRename:w&&1===N.size&&!R,canCreate:w&&N.size<2,...C,parentFolderId:q,selectedFileName:$,isDuplicate:D,startRenaming:P,finishRenaming:L,startDeleting:I,finishDeleting:M,finishMoving:O,startCreatingFile:V,startCreatingFolder:B,finishCreatingFolder:U,startCreatingDocOrFile:H,startUploadingDocOrFile:G,finishCreatingDoc:Y,finishCreatingLinkedFile:W,cancel:Q,droppedFiles:F,setDroppedFiles:T,downloadPath:X})),[Q,X,F,Y,U,W,M,O,L,D,R,q,N.size,$,H,V,B,I,P,G,C,w]);return(0,f.jsx)(g.Provider,{value:Z,children:t})};function v(){const e=(0,r.useContext)(g);if(!e)throw new Error("useFileTreeActionable is only available inside FileTreeActionableProvider");return e}},11787:(e,t,n)=>{n.d(t,{e:()=>o,r:()=>a});n(97107);var r=n(14041),i=n(31085);const s=(0,r.createContext)(void 0);function o(){const e=(0,r.useContext)(s);if(!e)throw new Error("useFileTreeMainContext is only available inside FileTreeMainProvider");return e}const a=e=>{let{refProviders:t,setRefProviderEnabled:n,setStartedFreeTrial:o,children:a}=e;const[l,c]=(0,r.useState)(null);return(0,i.jsx)(s.Provider,{value:{refProviders:t,setRefProviderEnabled:n,setStartedFreeTrial:o,contextMenuCoords:l,setContextMenuCoords:c},children:a})}},88588:(e,t,n)=>{n.d(t,{G1:()=>C,hj:()=>w,k2:()=>y});n(97107),n(85100),n(27162),n(66403),n(94154),n(64777),n(38846),n(62896);var r=n(14041),i=n(53373),s=n.n(i),o=n(45250),a=n.n(o),l=n(79550),c=n(71573),d=n(66666),u=n(56447),p=n(42093),m=n(28699),h=n(11787),f=n(88091),g=n(31085);const x=(0,r.createContext)(void 0);var j=function(e){return e.SELECT="SELECT",e.MULTI_SELECT="MULTI_SELECT",e.UNSELECT="UNSELECT",e}(j||{});function b(e,t){switch(t.type){case j.SELECT:return new Set(Array.isArray(t.id)?t.id:[t.id]);case j.MULTI_SELECT:{const n=new Set(e);return n.has(t.id)?n.size>1&&n.delete(t.id):n.add(t.id),n}case j.UNSELECT:{const n=new Set(e);return n.delete(t.id),n}default:throw new Error(`Unknown selectable action type: ${t.type}`)}}function _(e,t){switch(t.type){case j.SELECT:return new Set([t.id]);case j.MULTI_SELECT:case j.UNSELECT:return e;default:throw new Error(`Unknown selectable action type: ${t.type}`)}}const y=e=>{let{onSelect:t,children:n}=e;const{_id:i,rootDocId:s}=(0,d.O)(),[o]=(0,p.A)(`doc.open_id.${i}`,s),{fileTreeData:u,setSelectedEntities:h,fileTreeReadOnly:f}=(0,c.Q)(),[y,v]=(0,r.useState)(!1),[w,C]=(0,r.useReducer)(f?_:b,null,(()=>o&&(0,l.lE)(u,o)?new Set([o]):new Set)),[k,A]=(0,r.useState)(new Set);(0,r.useEffect)((()=>{const e=new Set;w.forEach((t=>{const n=(0,l.lE)(u,t);n&&n.path.forEach((t=>e.add(t)))})),A(e)}),[u,w]);const E=(0,m.A)(w);(0,r.useEffect)((()=>{if(a().isEqual(w,E))return;const e=Array.from(w).map((e=>(0,l.lE)(u,e))).filter(Boolean);t(e),h(e)}),[u,w,E,t,h]),(0,r.useEffect)((()=>{function e(e){const t=(0,l.lE)(u,e.detail);t&&C({type:j.SELECT,id:t.entity._id})}return window.addEventListener("editor.openDoc",e),()=>window.removeEventListener("editor.openDoc",e)}),[u]);const S=(0,r.useCallback)((e=>{C({type:j.SELECT,id:e})}),[]),N=(0,r.useCallback)((e=>{C({type:j.UNSELECT,id:e})}),[]),R=(0,r.useCallback)(((e,t)=>{const n=t?j.MULTI_SELECT:j.SELECT;C({type:n,id:e})}),[]),F={selectedEntityIds:w,selectedEntityParentIds:k,select:S,unselect:N,selectOrMultiSelectEntity:R,isRootFolderSelected:y,setIsRootFolderSelected:v};return(0,g.jsx)(x.Provider,{value:F,children:n})},v=/Mac/.test(window.navigator?.platform);function w(e,t){const{view:n,setView:i}=(0,u.LV)(),{setContextMenuCoords:o}=(0,h.e)(),{fileTreeData:a}=(0,c.Q)(),{selectedEntityIds:d,selectOrMultiSelectEntity:p,isRootFolderSelected:m,setIsRootFolderSelected:f}=C(),g=d.has(e),x=(0,r.useCallback)((e=>{const t=[];let n=!1;for(const r of A(a))if(r===e){if(t.push(r),n)break;n=!0}else if(d.has(r)){if(t.push(r),n)break;n=!0}else n&&t.push(r);return t}),[a,d]),j=(0,r.useCallback)((()=>{for(const e of d){const t=(0,l.lE)(a,e);if("doc"===t.type)return"editor";if("fileRef"===t.type)return"file";if("folder"===t.type)return n}return null}),[a,d,n]),b=(0,r.useCallback)((n=>{n.stopPropagation();const r=!m&&(v?n.metaKey:n.ctrlKey);f(!1),n.shiftKey?p(x(e)):p(e,r),"file"===t?i("file"):"doc"===t?i("editor"):"folder"===t&&i(j())}),[e,m,f,p,i,t,x,j]),_=(0,r.useCallback)((e=>{b(e),e.ctrlKey||e.metaKey||o(null)}),[b,o]),y=(0,r.useCallback)((e=>{"Enter"!==e.key&&" "!==e.key||b(e)}),[b]),w=(0,r.useCallback)((t=>{d.has(e)||b(t)}),[e,b,d]),k=!m&&g&&"pdf"!==n;return{isSelected:g,props:(0,r.useMemo)((()=>({className:s()({selected:k}),"aria-selected":k,onClick:_,onContextMenu:w,onKeyPress:y})),[_,w,y,k])}}function C(){const e=(0,r.useContext)(x);if(!e)throw new Error("useFileTreeSelectable is only available inside FileTreeSelectableProvider");return e}const k=(e,t)=>f.h.compare(e.name,t.name);function*A(e){yield e._id;const t=[...e.folders].sort(k);for(const e of t)for(const t of A(e))yield t;const n=[...e.docs,...e.fileRefs].sort(k);for(const e of n)yield e._id}},27916:(e,t,n)=>{n.d(t,{Lc:()=>DuplicateFilenameError,di:()=>InvalidFilenameError,ui:()=>DuplicateFilenameMoveError,yG:()=>BlockedFilenameError});n(97107);class InvalidFilenameError extends Error{constructor(){super("invalid filename")}}class BlockedFilenameError extends Error{constructor(){super("blocked filename")}}class DuplicateFilenameError extends Error{constructor(){super("duplicate filename")}}class DuplicateFilenameMoveError extends Error{constructor(){super("duplicate filename on move")}}},4941:(e,t,n)=>{n.d(t,{i:()=>l});var r=n(14041),i=n(37858),s=n(88091),o=n(52155);const a=(e,t)=>s.h.compare(e.path,t.path);function l(e){const[t,n]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),{signal:u}=(0,o.A)();return(0,r.useEffect)((()=>{e&&(n(!0),d(!1),l(null),(0,i.hm)(`/project/${e}/entities`,{signal:u}).then((e=>{l(e.entities.sort(a))})).catch((e=>d(e))).finally((()=>n(!1))))}),[e,u]),{loading:t,data:s,error:c}}},87833:(e,t,n)=>{n.d(t,{z:()=>l});var r=n(14041),i=n(37858),s=n(88091),o=n(52155);const a=(e,t)=>s.h.compare(e.path,t.path);function l(e){const[t,n]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),{signal:u}=(0,o.A)();return(0,r.useEffect)((()=>{e&&(n(!0),d(!1),l(null),(0,i.TB)(`/project/${e}/compile`,{body:{check:"silent",draft:!1,incrementalCompilesEnabled:!1},signal:u}).then((e=>{if("success"===e.status){const t=e.outputFiles.filter((e=>e.path.match(/.*\.(pdf|png|jpeg|jpg|gif)/)));e.outputFiles.forEach((t=>{t.clsiServerId=e.clsiServerId,t.compileGroup=e.compileGroup})),l(t.sort(a))}else d("linked-project-compile-error")})).catch((e=>d(e))).finally((()=>n(!1))))}),[e,u]),{loading:t,data:s,error:c}}},45524:(e,t,n)=>{n.d(t,{r:()=>l});var r=n(14041),i=n(37858),s=n(88091),o=n(52155);const a=(e,t)=>s.h.compare(e.name,t.name);function l(){const[e,t]=(0,r.useState)(!0),[n,s]=(0,r.useState)(null),[l,c]=(0,r.useState)(!1),{signal:d}=(0,o.A)();return(0,r.useEffect)((()=>{(0,i.hm)("/user/projects",{signal:d}).then((e=>{s(e.projects.sort(a))})).catch((e=>c(e))).finally((()=>t(!1)))}),[d]),{loading:e,data:n,error:l}}},88091:(e,t,n)=>{n.d(t,{h:()=>r});const r=new Intl.Collator("en",{numeric:!0,sensitivity:"variant",caseFirst:"upper"})},66285:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(10009);function i(e){let t=e.split(".").pop();return t=t?t.toLowerCase():t,["png","pdf","jpg","jpeg","gif"].includes(t)?"image":["csv","xls","xlsx"].includes(t)?(0,r.yU)()?"table_chart":"table":["py","r"].includes(t)?(0,r.yU)()?"code":"file-text":["bib"].includes(t)?(0,r.yU)()?"menu_book":"book":(0,r.yU)()?"description":"file"}},4816:(e,t,n)=>{n.d(t,{n:()=>o});var r=n(69687),i=n(64932);let s;const o=(e,t)=>(s||(s=new r.VR((0,i.A)("ol-ExposedSettings").fileIgnorePattern,{nocase:!0,dot:!0})),!!e&&(!t||!s.match(t+"/"+e)))},71735:(e,t,n)=>{n.d(t,{MS:()=>i,Ro:()=>s,tL:()=>o});var r=n(79550);function i(e,t,n){return!(s(e,t,n)||o(e,t,n))}function s(e,t,n){return e._id!==t&&(e=(0,r.lE)(e,t).entity),e.docs.find((e=>e.name===n))||e.fileRefs.find((e=>e.name===n))}function o(e,t,n){return e._id!==t&&(e=(0,r.lE)(e,t).entity),e.folders.find((e=>e.name===n))}},67227:(e,t,n)=>{n.d(t,{kW:()=>l,tL:()=>a});n(14293);const r=new RegExp("[\\/\\\\\\*\\u0000-\\u001F\\u007F\\u0080-\\u009F\\uD800-\\uDFFF]","g"),i=new RegExp("(^\\.$)|(^\\.\\.$)|(^\\s+)|(\\s+$)","g"),s=new RegExp("^(prototype|constructor|toString|toLocaleString|valueOf|hasOwnProperty|isPrototypeOf|propertyIsEnumerable|__defineGetter__|__lookupGetter__|__defineSetter__|__lookupSetter__|__proto__)$"),o=1024;function a(e){return(t=e).length>0&&t.length<=o&&!e.match(r)&&!e.match(i);var t}function l(e){return s.test(e)}},9993:(e,t,n)=>{n.d(t,{Dl:()=>s,Mb:()=>i,r_:()=>o,xy:()=>a});var r=n(37858);function i(e,t,n,i){return(0,r.TB)(`/project/${e}/${l(t)}/${n}/rename`,{body:{name:i}})}function s(e,t,n){return(0,r.Un)(`/project/${e}/${l(t)}/${n}`)}function o(e,t,n,i){return(0,r.TB)(`/project/${e}/${l(t)}/${n}/move`,{body:{folder_id:i}})}function a(e,t,n){const{endpoint:i,...s}=n;return(0,r.TB)(`/project/${e}/${i}`,{body:{parent_folder_id:t,...s}})}function l(e){return"fileRef"===e?"file":e}},36471:(e,t,n)=>{n.d(t,{J:()=>a,a:()=>o});n(97107);var r=n(14041),i=n(31085);const s=(0,r.createContext)(void 0),o=e=>{let{children:t}=e;const[n,o]=(0,r.useState)(null),a=(0,r.useCallback)((e=>{o(e)}),[]);return(0,i.jsxs)(s.Provider,{value:n,children:[(0,i.jsx)("div",{className:"global-alerts",ref:a}),t]})},a=()=>{const e=(0,r.useContext)(s);if(void 0===e)throw new Error("useGlobalAlertsContainer is only available inside GlobalAlertsProvider");return e}},17515:(e,t,n)=>{n.d(t,{A:()=>A,h:()=>k});n(97107);var r=n(14041),i=n(97434),s=n(89135),o=n(10646),a=n(56015),l=n(57732),c=n(28812),d=n(22046),u=n(71627),p=n(67993),m=n(10009),h=n(99852),f=n(31085);const g=(0,r.lazy)((()=>n.e(4761).then(n.bind(n,14761)).then((e=>{let{ReadOnlyTokenLink:t}=e;return{default:t}})))),x=(0,r.lazy)((()=>Promise.all([n.e(3939),n.e(1168)]).then(n.bind(n,11168))));function j(e){let{show:t,cancel:n,animation:j,inFlight:_,error:y}=e;const{t:v}=(0,i.Bd)(),{isRestrictedTokenMember:w}=(0,o.mi)();return(0,f.jsxs)(c.Ay,{show:t,onHide:n,animation:j,children:[(0,f.jsx)(c.IK,{closeButton:!0,children:(0,f.jsx)(c.rA,{children:v("share_project")})}),(0,f.jsx)(c.$8,{className:"modal-body-share modal-link-share-new",children:(0,f.jsxs)("div",{className:"container-fluid",children:[(0,f.jsx)(r.Suspense,{fallback:(0,f.jsx)(a.e,{minHeight:"15rem"}),children:w?(0,f.jsx)(g,{}):(0,f.jsx)(x,{})}),y&&(0,f.jsx)(d.A,{type:"error",content:(0,f.jsx)(b,{error:y}),className:"mb-0 mt-3"})]})}),(0,f.jsxs)(c.E9,{children:[(0,f.jsx)("div",{className:(0,m.q$)({bs3:"pull-left",bs5:"me-auto"}),children:_&&(0,f.jsx)(p.A,{bs3:(0,f.jsx)(s.A,{type:"refresh",spin:!0}),bs5:(0,f.jsx)(h.A,{animation:"border","aria-hidden":"true",size:"sm",role:"status"})})}),(0,f.jsx)(l.A,{onClick:n,as:u.A,variant:"secondary",disabled:_,children:v("close")})]})]})}function b(e){let{error:t}=e;const{t:n}=(0,i.Bd)();switch(t){case"cannot_invite_non_user":return(0,f.jsx)(f.Fragment,{children:n("cannot_invite_non_user")});case"cannot_verify_user_not_robot":return(0,f.jsx)(f.Fragment,{children:n("cannot_verify_user_not_robot")});case"cannot_invite_self":return(0,f.jsx)(f.Fragment,{children:n("cannot_invite_self")});case"invalid_email":return(0,f.jsx)(f.Fragment,{children:n("invalid_email")});case"too_many_requests":return(0,f.jsx)(f.Fragment,{children:n("too_many_requests")});case"invite_expired":return(0,f.jsx)(f.Fragment,{children:n("invite_expired")});case"invite_resend_limit_hit":return(0,f.jsx)(f.Fragment,{children:n("invite_resend_limit_hit")});default:return(0,f.jsx)(f.Fragment,{children:n("generic_something_went_wrong")})}}var _=n(66666),y=n(17112),v=n(5964),w=n(83566);const C=(0,r.createContext)(void 0);function k(){const e=(0,r.useContext)(C);if(!e)throw new Error("useShareProjectContext is only available inside ShareProjectProvider");return e}const A=r.memo((function(e){let{handleHide:t,show:n,handleOpen:i,animation:s=!0}=e;const[a,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(),u=(0,_.O)(),{isProjectOwner:p}=(0,o.mi)(),{splitTestVariants:m}=(0,y.d1)();(0,r.useEffect)((()=>{if(!(!p||!u.features)&&-1!==u.features.collaborators&&(u.members.filter((e=>"readAndWrite"===e.privileges)).length>(u.features.collaborators??1)||u.members.some((e=>e.pendingEditor)))){const e=`last-shown-share-modal.${u._id}`,t=w.A.getItem(e);(!t||t+864e5<Date.now())&&(i(),w.A.setItem(e,Date.now()))}}),[u,p,i]),(0,r.useEffect)((()=>{n&&(0,v._)("share-modal-opened",{splitTestVariant:m["null-test-share-modal"],project_id:u._id})}),[m,u._id,n]),(0,r.useEffect)((()=>{n&&d(void 0)}),[n]);const h=(0,r.useCallback)((()=>{a||t()}),[t,a]),g=(0,r.useCallback)((e=>{d(void 0),l(!0);const t=e();return t.catch((e=>{d(e.data?.errorReason||e.data?.error||"generic_something_went_wrong")})),t.finally((()=>{l(!1)})),t}),[]),x=(0,r.useCallback)((e=>Object.assign(u,e)),[u]);return u?(0,f.jsx)(C.Provider,{value:{updateProject:x,monitorRequest:g,inFlight:a,setInFlight:l,error:c,setError:d},children:(0,f.jsx)(j,{animation:s,cancel:h,error:c,inFlight:a,show:n})}):null}))},30158:(e,t,n)=>{n.d(t,{A:()=>k,h:()=>C});n(97107);var r=n(14041),i=n(97434),s=n(89135),o=n(10646),a=n(56015),l=n(57732),c=n(28812),d=n(22046),u=n(71627),p=n(67993),m=n(10009),h=n(99852),f=n(31085);const g=(0,r.lazy)((()=>n.e(4903).then(n.bind(n,64903)).then((e=>{let{ReadOnlyTokenLink:t}=e;return{default:t}})))),x=(0,r.lazy)((()=>Promise.all([n.e(3939),n.e(890)]).then(n.bind(n,20890))));function j(e){let{show:t,cancel:n,animation:j,inFlight:_,error:y}=e;const{t:v}=(0,i.Bd)(),{isRestrictedTokenMember:w}=(0,o.mi)();return(0,f.jsxs)(c.Ay,{show:t,onHide:n,animation:j,children:[(0,f.jsx)(c.IK,{closeButton:!0,children:(0,f.jsx)(c.rA,{children:v("share_project")})}),(0,f.jsx)(c.$8,{className:"modal-body-share",children:(0,f.jsxs)("div",{className:"container-fluid",children:[(0,f.jsx)(r.Suspense,{fallback:(0,f.jsx)(a.e,{minHeight:"15rem"}),children:w?(0,f.jsx)(g,{}):(0,f.jsx)(x,{})}),y&&(0,f.jsx)(d.A,{type:"error",content:(0,f.jsx)(b,{error:y}),className:"mb-0 mt-3"})]})}),(0,f.jsxs)(c.E9,{children:[(0,f.jsx)("div",{className:(0,m.q$)({bs3:"pull-left",bs5:"me-auto"}),children:_&&(0,f.jsx)(p.A,{bs3:(0,f.jsx)(s.A,{type:"refresh",spin:!0}),bs5:(0,f.jsx)(h.A,{animation:"border","aria-hidden":"true",size:"sm",role:"status"})})}),(0,f.jsx)(l.A,{onClick:n,as:u.A,variant:"secondary",disabled:_,children:v("close")})]})]})}function b(e){let{error:t}=e;const{t:n}=(0,i.Bd)();switch(t){case"cannot_invite_non_user":return(0,f.jsx)(f.Fragment,{children:n("cannot_invite_non_user")});case"cannot_verify_user_not_robot":return(0,f.jsx)(f.Fragment,{children:n("cannot_verify_user_not_robot")});case"cannot_invite_self":return(0,f.jsx)(f.Fragment,{children:n("cannot_invite_self")});case"invalid_email":return(0,f.jsx)(f.Fragment,{children:n("invalid_email")});case"too_many_requests":return(0,f.jsx)(f.Fragment,{children:n("too_many_requests")});case"invite_expired":return(0,f.jsx)(f.Fragment,{children:n("invite_expired")});case"invite_resend_limit_hit":return(0,f.jsx)(f.Fragment,{children:n("invite_resend_limit_hit")});default:return(0,f.jsx)(f.Fragment,{children:n("generic_something_went_wrong")})}}var _=n(66666),y=n(17112),v=n(5964);const w=(0,r.createContext)(void 0);function C(){const e=(0,r.useContext)(w);if(!e)throw new Error("useShareProjectContext is only available inside ShareProjectProvider");return e}const k=r.memo((function(e){let{handleHide:t,show:n,animation:i=!0}=e;const[s,o]=(0,r.useState)(!1),[a,l]=(0,r.useState)(),c=(0,_.O)(),{splitTestVariants:d}=(0,y.d1)();(0,r.useEffect)((()=>{n&&(0,v._)("share-modal-opened",{splitTestVariant:d["null-test-share-modal"],project_id:c._id})}),[d,c._id,n]),(0,r.useEffect)((()=>{n&&l(void 0)}),[n]);const u=(0,r.useCallback)((()=>{s||t()}),[t,s]),p=(0,r.useCallback)((e=>{l(void 0),o(!0);const t=e();return t.catch((e=>{l(e.data?.errorReason||e.data?.error||"generic_something_went_wrong")})),t.finally((()=>{o(!1)})),t}),[]),m=(0,r.useCallback)((e=>Object.assign(c,e)),[c]);return c?(0,f.jsx)(w.Provider,{value:{updateProject:m,monitorRequest:p,inFlight:s,setInFlight:o,error:a,setError:l},children:(0,f.jsx)(j,{animation:i,cancel:u,error:a,inFlight:s,show:n})}):null}))},31622:(e,t,n)=>{n.d(t,{kn:()=>f,hu:()=>h,ee:()=>u,$S:()=>l,eb:()=>c,kw:()=>a,u6:()=>m,mI:()=>p,ON:()=>d});var r=n(37858);let i,s;var o=n(64932);function a(e,t,n){return function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise(((t,n)=>{if(e||!window.grecaptcha)return t();try{i||(i=window.grecaptcha.render("recaptcha",{callback:e=>{s&&(s(e),s=void 0),window.grecaptcha.reset()}})),s=t}catch(e){n(e)}}))}((0,o.A)("ol-ExposedSettings").recaptchaDisabled?.invite).then((i=>(0,r.TB)(`/project/${e}/invite`,{body:{email:t,privileges:n,"g-recaptcha-response":i}})))}function l(e,t){return(0,r.TB)(`/project/${e}/invite/${t._id}/resend`)}function c(e,t){return(0,r.Un)(`/project/${e}/invite/${t._id}`)}function d(e,t,n){return(0,r.mI)(`/project/${e}/users/${t._id}`,{body:n})}function u(e,t){return(0,r.Un)(`/project/${e}/users/${t._id}`)}function p(e,t){return(0,r.TB)(`/project/${e}/transfer-ownership`,{body:{user_id:t._id}})}function m(e,t){return(0,r.TB)(`/project/${e}/settings/admin`,{body:{publicAccessLevel:t}})}function h(e){return(0,r.hm)(`/project/${e}/members`)}function f(e){return(0,r.hm)(`/project/${e}/invites`)}},43480:(e,t,n)=>{n.d(t,{V:()=>r});const r=(0,n(86954).Y)(new Date(2024,7,26),"MMMM Do")},15947:(e,t,n)=>{n.d(t,{By:()=>l,QV:()=>c,zP:()=>o});var r=n(57195);const i=r.Pe.define(),s=r.Pe.define(),o=()=>[a],a=r.sU.define({create:()=>[],update(e,t){for(const n of t.effects){n.is(i)&&e.push(n.value),n.is(s)&&(e=e.filter((e=>!(e.effect===n.value.effect&&e.callback===n.value.callback))));for(let t=0;t<e.length;++t){const r=e[t];n.is(r.effect)&&(setTimeout((()=>r.callback(n.value))),r.options?.once&&(e.splice(t,1),--t))}}return e}}),l=(e,t,n,r)=>{e.dispatch({effects:i.of({effect:t,callback:n,options:r})})},c=(e,t,n)=>{e.dispatch({effects:s.of({effect:t,callback:n})})}},83290:(e,t,n)=>{n.d(t,{FW:()=>u,Ib:()=>m,Nw:()=>c,a9:()=>p,nE:()=>f,sp:()=>d});n(85100),n(27162),n(66403),n(94154),n(64777),n(38846),n(62896);var r=n(57195),i=n(83173),s=n(15947),o=n(38188),a=n(60961);function l(e,t){return e?{...e,from:t.mapPos(e.from),to:t.mapPos(e.to)}:e}class c{constructor(e){this.props=e}get from(){return this.props.from}get to(){return this.props.to}get caption(){return this.props.caption}get label(){return this.props.label}get width(){return this.props.width}get unknownGraphicsArguments(){return this.props.unknownGraphicsArguments}get graphicsCommandArguments(){return this.props.graphicsCommandArguments}get graphicsCommand(){return this.props.graphicsCommand}get file(){return this.props.file}map(e){return new c({from:e.mapPos(this.from),to:e.mapPos(this.to),caption:l(this.caption,e),label:l(this.label,e),graphicsCommand:l(this.graphicsCommand,e),width:this.width,file:l(this.file,e),graphicsCommandArguments:l(this.graphicsCommandArguments,e),unknownGraphicsArguments:this.unknownGraphicsArguments})}}const d=r.Pe.define(),u=r.sU.define({create:()=>null,update:(e,t)=>{let n;for(const e of t.effects)e.is(d)&&(n=e.value);return void 0!==n?n:e?e.map(t.changes):e}}),p=()=>[u];function m(e){const t=new AbortController,n=new Promise((n=>{const r=()=>{a.$.warn("Aborting wait for file tree update"),(0,s.QV)(e,o.TY,i),n()};function i(){t.signal.aborted||(t.signal.removeEventListener("abort",r),n())}t.signal.addEventListener("abort",r,{once:!0}),(0,s.By)(e,o.TY,i,{once:!0})}));return{withTimeout(){return setTimeout((()=>t.abort()),arguments.length>0&&void 0!==arguments[0]?arguments[0]:500),n},promise:n}}const h=new Set(["image/jpeg","image/png","application/pdf"]),f=()=>i.Lz.domEventHandlers({drop:e=>{if(!e.dataTransfer||0===e.dataTransfer.files.length)return;const t=e.dataTransfer.files[0];h.has(t.type)&&window.dispatchEvent(new CustomEvent("figure-modal:paste-image",{detail:{name:t.name,type:t.type,data:t}}))},paste:e=>{if(!e.clipboardData||0===e.clipboardData.files.length)return;if(e.clipboardData.types.includes("text/plain"))return;const t=e.clipboardData.files[0];h.has(t.type)&&window.dispatchEvent(new CustomEvent("figure-modal:paste-image",{detail:{name:t.name,type:t.type,data:t}}))}})},38188:(e,t,n)=>{n.d(t,{B8:()=>c,BH:()=>m,HT:()=>u,TY:()=>g,Tm:()=>l,_X:()=>j,jC:()=>b,kq:()=>x,xC:()=>f});var r=n(57195),i=n(30789),s=n(83173),o=n(29587),a=n(45197);const l=r.Pe.define(),c=(0,a.v)(l),d=new r.xx,u=r.sU.define({create:()=>{},update:(e,t)=>{for(const e of t.effects)if(e.is(g))return e.value;return e}}),p=new r.xx,m=(e,t,n)=>{let{syntaxValidation:r}=n;return p.of(h(e,t,r))},h=(e,t,n)=>{const r=o.t$.matchFilename(i.e,e);return r?[d.of(o.Xt.of("    ")),u,s.Z9.define((e=>(r.load().then((r=>{e.dispatch({effects:[d.reconfigure(r),l.of(null)]}),e.dispatch({effects:[g.of(t),j.of(n)]})})),{}))),u]:[]},f=(e,t,n)=>({effects:p.reconfigure(h(e,t,n))}),g=r.Pe.define(),x=e=>({effects:g.of(e)}),j=r.Pe.define(),b=e=>({effects:j.of(e)})},30789:(e,t,n)=>{n.d(t,{e:()=>i});var r=n(29587);const i=[r.t$.of({name:"latex",extensions:["tex","sty","cls","clo","bst","bbl","pdf_tex","pdf_t","map","fd","enc","def","mf","pgf","tikz","bbx","cbx","dbx","lbx","lco","ldf","xmpdata","Rnw","rnw","lyx","inc","dtx","hak","eps_tex","brf","ins","hva","Rtex","rtex","pstex","pstex_t","gin","fontspec","pygstyle","pygtex","ps_tex","ltx"],load:()=>Promise.all([n.e(4695),n.e(5982),n.e(188),n.e(5463),n.e(9796),n.e(5639)]).then(n.bind(n,45639)).then((e=>e.latex()))}),r.t$.of({name:"bibtex",extensions:["bib"],load:()=>Promise.all([n.e(4695),n.e(5982),n.e(9065)]).then(n.bind(n,9065)).then((e=>e.bibtex()))}),r.t$.of({name:"markdown",extensions:["md","markdown"],load:()=>Promise.all([n.e(4695),n.e(2348),n.e(188),n.e(4075)]).then(n.bind(n,14075)).then((e=>e.markdown()))})]},5383:(e,t,n)=>{n.r(t),n.d(t,{AffilCtrlSeq:()=>ie,AffiliationCtrlSeq:()=>se,Ampersand:()=>At,AuthorCtrlSeq:()=>re,BareFilePathArgument:()=>Nt,Begin:()=>f,BibKeyArgument:()=>mt,BibliographyCtrlSeq:()=>te,BibliographyStyleCtrlSeq:()=>ne,BlankLine:()=>He,Book:()=>ln,BookCtrlSeq:()=>$,BottomRuleCtrlSeq:()=>me,BracketMath:()=>Gt,CaptionCtrlSeq:()=>T,CenteringCtrlSeq:()=>ee,Chapter:()=>dn,ChapterCtrlSeq:()=>U,CiteCtrlSeq:()=>b,CiteStarrableCtrlSeq:()=>_,CloseBrace:()=>We,CloseBracket:()=>rt,CloseBracketCtrlSym:()=>qe,CloseBracketMath:()=>Yt,CloseParenCtrlSym:()=>Oe,CloseParenMath:()=>Xt,ColorBoxCtrlSeq:()=>ce,Command:()=>Je,Comment:()=>ze,Csname:()=>l,CtrlSeq:()=>yt,CtrlSym:()=>ht,DateCtrlSeq:()=>oe,DefCtrlSeq:()=>P,DefinitionArgument:()=>xt,DefinitionFragment:()=>bt,DefinitionFragmentArgument:()=>vt,DefinitionFragmentCommand:()=>_t,DisplayMath:()=>Ht,DocumentClassCtrlSeq:()=>k,DocumentEnvName:()=>Se,DocumentEnvironment:()=>Ke,Dollar:()=>Ct,DollarMath:()=>Pt,EmphasisCtrlSeq:()=>ke,End:()=>g,EnvName:()=>st,Environment:()=>it,EquationArrayEnvName:()=>Fe,EquationArrayEnvironment:()=>en,EquationEnvName:()=>Re,EquationEnvironment:()=>Jt,FigureEnvName:()=>Le,FigureEnvironment:()=>sn,FilePathArgument:()=>dt,HLineCtrlSeq:()=>de,HboxCtrlSeq:()=>w,HrefCtrlSeq:()=>E,IncludeCtrlSeq:()=>Q,IncludeGraphicsCtrlSeq:()=>F,InlineMath:()=>Lt,InputCtrlSeq:()=>W,ItemCtrlSeq:()=>X,KnownCtrlSym:()=>wt,KnownEnvironment:()=>Ge,LaTeX:()=>Ue,LabelArgument:()=>ut,LabelCtrlSeq:()=>y,LeftCtrlSeq:()=>D,LetCtrlSeq:()=>L,LineBreakCtrlSym:()=>$e,ListEnvName:()=>De,ListEnvironment:()=>on,LiteralArgContent:()=>s,LongArg:()=>nt,LstInlineContent:()=>i,LstInlineCtrlSeq:()=>R,MacroParameter:()=>ft,MaketitleCtrlSeq:()=>ae,Math:()=>Dt,MathArgument:()=>Mt,MathChar:()=>Vt,MathClosing:()=>$t,MathCommand:()=>It,MathDelimitedGroup:()=>Ot,MathDelimiter:()=>qt,MathOpening:()=>Bt,MathSpecialChar:()=>zt,MathTextCtrlSeq:()=>v,MidRuleCtrlSeq:()=>pe,MultiColumnCtrlSeq:()=>he,NewCommandCtrlSeq:()=>M,NewEnvironmentCtrlSeq:()=>B,NewLine:()=>jt,NewTheoremCtrlSeq:()=>Z,Normal:()=>kt,Number:()=>Ut,OpenBrace:()=>Ye,OpenBracket:()=>Xe,OpenBracketCtrlSym:()=>Be,OpenBracketMath:()=>Kt,OpenParenCtrlSym:()=>Me,OpenParenMath:()=>Qt,OptionalArgument:()=>Qe,OptionalMacroParameter:()=>gt,PackageArgument:()=>lt,ParBoxCtrlSeq:()=>fe,Paragraph:()=>hn,ParagraphCtrlSeq:()=>K,ParenMath:()=>Wt,Part:()=>cn,PartCtrlSeq:()=>z,RefArgument:()=>pt,RefCtrlSeq:()=>x,RefStarrableCtrlSeq:()=>j,RenewCommandCtrlSeq:()=>O,RenewEnvironmentCtrlSeq:()=>q,RightCtrlSeq:()=>I,Section:()=>un,SectionCtrlSeq:()=>V,SectioningArgument:()=>St,SetLengthCtrlSeq:()=>Ee,ShortArg:()=>at,ShortOptionalArg:()=>Ze,ShortTextArgument:()=>ot,SpaceDelimitedLiteralArgContent:()=>o,SubParagraph:()=>fn,SubParagraphCtrlSeq:()=>Y,SubSection:()=>pn,SubSectionCtrlSeq:()=>H,SubSubSection:()=>mn,SubSubSectionCtrlSeq:()=>G,TableEnvName:()=>Ie,TableEnvironment:()=>an,TabularArgument:()=>Rt,TabularContent:()=>Ft,TabularEnvName:()=>Ne,TabularEnvironment:()=>Zt,Text:()=>Ve,TextArgument:()=>tt,TextBoldCtrlSeq:()=>ge,TextColorCtrlSeq:()=>le,TextItalicCtrlSeq:()=>xe,TextMediumCtrlSeq:()=>_e,TextSansSerifCtrlSeq:()=>ye,TextSmallCapsCtrlSeq:()=>je,TextStrikeOutCtrlSeq:()=>Ce,TextSubscriptCtrlSeq:()=>we,TextSuperscriptCtrlSeq:()=>ve,TextTeletypeCtrlSeq:()=>be,TheoremStyleCtrlSeq:()=>J,TikzPictureContent:()=>rn,TikzPictureEnvName:()=>Pe,TikzPictureEnvironment:()=>nn,Tilde:()=>Et,TitleCtrlSeq:()=>C,TopRuleCtrlSeq:()=>ue,TrailingContent:()=>d,TrailingWhitespaceOnly:()=>c,UnderlineCtrlSeq:()=>Ae,UnknownCommand:()=>Tt,UrlArgument:()=>ct,UrlCtrlSeq:()=>S,UsePackageCtrlSeq:()=>A,VerbContent:()=>r,VerbCtrlSeq:()=>N,VerbatimContent:()=>a,VerbatimEnvName:()=>Te,VerbatimEnvironment:()=>tn,Whitespace:()=>et,endOfArguments:()=>p,endOfArgumentsAndOptionals:()=>h,hasMoreArguments:()=>u,hasMoreArgumentsOrOptionals:()=>m});const r=1,i=2,s=3,o=4,a=5,l=6,c=7,d=8,u=376,p=377,m=378,h=379,f=9,g=10,x=11,j=12,b=13,_=14,y=15,v=16,w=17,C=18,k=19,A=20,E=21,S=22,N=23,R=24,F=25,T=26,P=27,L=28,D=29,I=30,M=31,O=32,B=33,q=34,$=35,z=36,U=37,V=38,H=39,G=40,K=41,Y=42,W=43,Q=44,X=45,Z=46,J=47,ee=48,te=49,ne=50,re=51,ie=52,se=53,oe=54,ae=55,le=56,ce=57,de=58,ue=59,pe=60,me=61,he=62,fe=63,ge=64,xe=65,je=66,be=67,_e=68,ye=69,ve=70,we=71,Ce=72,ke=73,Ae=74,Ee=75,Se=76,Ne=77,Re=78,Fe=79,Te=80,Pe=81,Le=82,De=83,Ie=84,Me=85,Oe=86,Be=87,qe=88,$e=89,ze=90,Ue=91,Ve=92,He=93,Ge=94,Ke=95,Ye=98,We=99,Qe=100,Xe=101,Ze=102,Je=103,et=106,tt=107,nt=108,rt=109,it=111,st=114,ot=121,at=122,lt=131,ct=135,dt=143,ut=146,pt=148,mt=150,ht=152,ft=153,gt=154,xt=155,jt=156,bt=157,_t=158,yt=160,vt=161,wt=162,Ct=165,kt=166,At=167,Et=168,St=170,Nt=179,Rt=189,Ft=190,Tt=205,Pt=206,Lt=207,Dt=208,It=209,Mt=224,Ot=272,Bt=273,qt=274,$t=275,zt=276,Ut=277,Vt=278,Ht=279,Gt=280,Kt=281,Yt=282,Wt=283,Qt=284,Xt=285,Zt=288,Jt=293,en=298,tn=302,nn=307,rn=311,sn=314,on=318,an=322,ln=327,cn=330,dn=333,un=336,pn=339,mn=342,hn=345,fn=348},45197:(e,t,n)=>{n.d(t,{u:()=>r,v:()=>i});const r=e=>t=>t.effects.some((t=>t.is(e))),i=e=>t=>t.transactions.some((t=>t.effects.some((t=>t.is(e)))))},94355:(e,t,n)=>{n.d(t,{Kn:()=>l,l_:()=>o});n(97107);var r=n(97900),i=n(47200);i.Tq;const s=(e,t,n)=>{const i=(0,r.G2)(e,...n);if(i){const e=t.doc.sliceString(i.from,i.to);if(e.length>0)return e}return null},o=(e,t,n,i)=>{if(t.type.is("NewCommand")||t.type.is("RenewCommand")){if(!i(t.node))return;const o=s(t.node,e,["LiteralArgContent","Csname"]);if(null===o)return;const a=t.node.getChildren("OptionalArgument");let l=0;if(a.length>0){const t=a[0],n=(0,r.H)(e,t);if(n)try{l=parseInt(n,10)}catch(e){}}const c=2===a.length;c&&l>0&&l--,n.push({line:e.doc.lineAt(t.from).number,title:o,from:t.from,to:t.to,optionalArgCount:c?1:0,requiredArgCount:l,type:"definition",raw:e.sliceDoc(t.from,t.to)})}else if(t.type.is("Def")){if(!i(t.node))return;const r=s(t.node,e,["Csname","CtrlSym"]);if(null===r)return;const o=t.node.getChildren("MacroParameter").length,a=t.node.getChildren("OptionalMacroParameter").length;n.push({line:e.doc.lineAt(t.from).number,title:r,from:t.from,to:t.to,optionalArgCount:a,requiredArgCount:o,type:"definition",raw:e.sliceDoc(t.from,t.to)})}else if(t.type.is("Let")){if(!i(t.node))return;const r=s(t.node,e,["Csname"]);if(null===r)return;n.push({line:e.doc.lineAt(t.from).number,title:r,from:t.from,to:t.to,ignoreInAutocomplete:!0,optionalArgCount:void 0,requiredArgCount:void 0,type:"definition",raw:e.sliceDoc(t.from,t.to)})}else if(t.type.is("UnknownCommand")||t.type.is("KnownCommand")||t.type.is("MathUnknownCommand")||t.type.is("DefinitionFragmentUnknownCommand")){if(!i(t.node))return;let r=t.node;if(t.type.is("KnownCommand")&&(r=r.firstChild),!r)return;const s=r.getChild("$CtrlSeq");if(!s)return;if(s.type.is("$CtrlSym"))return;const o=r.getChildren("OptionalArgument"),a=r.getChildren("$Argument"),l=e.doc.sliceString(s.from,s.to);n.push({line:e.doc.lineAt(r.from).number,title:l,from:r.from,to:r.to,optionalArgCount:o.length,requiredArgCount:a.length-o.length,type:"usage",raw:void 0})}},a={tex:0,pdf:1},l=(e,t,n)=>{if("\\texorpdfstring"===s(t.node,e,["CtrlSeq"])){const r=t.getChildren("TextArgument")[a[n]]?.getChild("LongArg");if(r)return e.doc.sliceString(r.from,r.to)}}},97900:(e,t,n)=>{n.d(t,{B9:()=>nodeHasError,G2:()=>o,H:()=>s,I8:()=>i});var r=n(29587);const i=(e,t,n)=>{const i=(0,r.a_)(e,t,100);if(!i)return null;const s=i.resolve(t),o=s?.prevSibling;return o?.type.name===n},s=(e,t)=>{const n=t.getChild("ShortOptionalArg");if(n)return e.doc.sliceString(n.from,n.to)},nodeHasError=e=>{let t=!1;return e.cursor().iterate((e=>{let{type:n}=e;return!t&&(!n.isError||(t=!0,!1))})),t},o=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let i=null;return e.cursor().iterate((e=>{if(null!==i)return!1;for(const t of n)if(e.type.is(t))return i=e.node,!1;return!0})),i}},21947:(e,t,n)=>{n.d(t,{$2:()=>d,E9:()=>p,ee:()=>l,hN:()=>u,l_:()=>a,ob:()=>c,qI:()=>m});n(97107);var r=n(29587),i=n(97900),s=n(47200),o=n(83290);s.Tq;const a=(e,t,n,r)=>{if(t.type.is("EnvNameGroup")){if(!r(t.node))return!1;if(!t.node.prevSibling?.type.is("Begin"))return!1;const i=t.node.getChild("OpenBrace");if(!i)return!1;const s=i.node.nextSibling;if(!s)return!1;const o=e.doc.sliceString(s.from,s.to);if(o.length<1)return!1;const a={title:o,from:s.from,to:s.to,line:e.doc.lineAt(s.from).number,type:"usage",raw:e.sliceDoc(t.from,t.to)};n.push(a)}else if(t.type.is("NewEnvironment")||t.type.is("RenewEnvironment")){if(!r(t.node))return!1;const i=t.node.getChild("LiteralArgContent");if(!i)return;const s=e.doc.sliceString(i.from,i.to);if(!s)return;const o={title:s,from:i.from,to:i.to,line:e.doc.lineAt(i.from).number,type:"definition",raw:e.sliceDoc(t.from,t.to)};n.push(o)}},l=(e,t)=>{const n=(0,r.a_)(e,t,100);if(!n)return;let s=n.resolve(t);if(s){if(s.type.is("EnvNameGroup")&&(0,i.I8)(e,t,"Begin"))return!0;if(s.type.is("$Environment")||s.type.is("LaTeX")&&t===e.doc.length){if(s=n.resolve(t,-1),!s)return;if(s.type.is("OpenBrace")||s.type.is("$EnvName"))return!0}}},c=(e,t)=>{const n=(0,r.a_)(e,t,100);if(!n)return;let s=n.resolve(t);if(s){if(s.type.is("EnvNameGroup")&&(0,i.I8)(e,t,"End"))return!0;if(s.type.is("$Environment")||s.type.is("Content")){if(s=n.resolve(t,-1),!s)return;if(s.type.is("OpenBrace")||s.type.is("EnvName"))return!0}}};function d(e,t){if(e?.type.is("$Environment")&&(e=e.getChild("BeginEnv")),!e?.type.is("BeginEnv")&&!e?.type.is("EndEnv"))return null;const n=e?.getChild("EnvNameGroup")?.getChild("OpenBrace")?.nextSibling;return n?n.type.is("CloseBrace")?null:t.sliceDoc(n.from,n.to):null}const u=(e,t)=>d(e,t)?.replace(/\*$/,"");function p(e){return e.getChild("BeginEnv")?.getChildren("TextArgument")}function m(e,t){let n,r,i,s,a=null,l=null,c=null;const d=e.from,u=e.to;let p=!1;return e.cursor().iterate((e=>{if(p)return!1;if(e.type.is("Caption")){if(a)return p=!0,!1;a={from:e.from,to:e.to}}if(e.type.is("Label")){if(l)return p=!0,!1;l={from:e.from,to:e.to}}if(e.type.is("IncludeGraphics")){if(n)return p=!0,!1;s={from:e.from,to:e.to};const o=e.node.getChild("IncludeGraphicsArgument")?.getChild("FilePathArgument")?.getChild("LiteralArgContent");if(!o)return p=!0,!1;n={from:o.from,to:o.to,path:t.sliceDoc(o.from,o.to)};const a=e.node.getChild("OptionalArgument")?.getChild("ShortOptionalArg");if(!a)return r=void 0,!1;c={from:a.from,to:a.to};const l=t.sliceDoc(a.from,a.to),d=l.match(/^width=([0-9]|(?:[0-9]*\.[0-9]+)|(?:[0-9]+\.))\\(linewidth|pagewidth|textwidth|hsize|columnwidth)$/);d?(r=parseFloat(d[1]),"linewidth"!==d[2]&&(i=l)):i=l}})),p||void 0===s||void 0===n?null:new o.Nw({caption:a,label:l,file:n,from:d,to:u,width:r,unknownGraphicsArguments:i,graphicsCommand:s,graphicsCommandArguments:c})}},60347:(e,t,n)=>{n.d(t,{l_:()=>u,z_:()=>m});n(97107);var r=n(47200),i=n(5383),s=n(21947),o=n(94355);r.Tq;var a=function(e){return e[e.Book=1]="Book",e[e.Part=2]="Part",e[e.Chapter=3]="Chapter",e[e.Section=4]="Section",e[e.SubSection=5]="SubSection",e[e.SubSubSection=6]="SubSubSection",e[e.Paragraph=7]="Paragraph",e[e.SubParagraph=8]="SubParagraph",e[e.Frame=9]="Frame",e[e.Invalid=-1]="Invalid",e}(a||{});const l={book:a.Book,part:a.Part,chapter:a.Part,section:a.Section,subsection:a.SubSection,subsubsection:a.SubSubSection,paragraph:a.Paragraph,subparagraph:a.SubParagraph,frame:a.Frame},c=e=>{if("string"==typeof e)return l[e]??a.Invalid;switch(e){case i.Book:return a.Book;case i.Part:return a.Part;case i.Chapter:return a.Chapter;case i.Section:return a.Section;case i.SubSection:return a.SubSection;case i.SubSubSection:return a.SubSubSection;case i.Paragraph:return a.Paragraph;case i.SubParagraph:return a.SubParagraph;default:return a.Invalid}},d=(e,t)=>{const n=[];return t.node.cursor().iterate((r=>{if(r.from>=t.to)return!1;if(r.type.is("Label"))return!1;if(r.type.is("UnknownCommand")){const t=(0,o.Kn)(e,r.node,"pdf");if(t)return n.push(t),!1}if(r.node.firstChild)return!0;n.push(e.doc.sliceString(r.from,r.to))})),n.join("")},u=(e,t,n,r)=>{if(t.type.is("SectioningCommand")){const i=t.node,s=i.parent;if(!r(i))return;const o=i.getChild("SectioningArgument")?.getChild("LongArg");if(!o)return;for(let e=s;e;e=e.parent)if(e.type.is("NewCommand")||e.type.is("RenewCommand"))return!1;const a=()=>{const t=i.firstChild;return t?e.doc.sliceString(t.from+1,t.to):""},l=s?.type.is("$Section")?c(s.type.id):c(a()),u={line:e.doc.lineAt(i.from).number,title:d(e,o),from:i.from,to:i.to,level:l};n.push(u)}if(t.type.is("$Environment")){const i=t.node;if("frame"===(0,s.$2)(i,e)){const t=i.getChild("BeginEnv");if(!r(t))return;const o=(0,s.E9)(i)?.map((e=>e.getChild("LongArg")));if(o?.length){const r=o[0],i=r?e.sliceDoc(r.from,r.to):"",s={line:e.doc.lineAt(t.from).number,title:i,from:t.from,to:t.to,level:a.Frame};n.push(s)}}}},p=e=>({title:e.title,line:e.line,level:e.level}),m=e=>{const t=[],n=[];for(const r of e){const e=p(r);for(;t.length&&t[t.length-1].level>=e.level;)t.pop();if(t.length){const n=t[t.length-1];n.children?n.children.push(e):n.children=[e],t.push(e)}else t.push(e),n.push(e)}return n}},47200:(e,t,n)=>{n.d(t,{CN:()=>c,P4:()=>u,Tq:()=>l});n(97107);var r=n(29587),i=n(79066);function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const o=20,a=500;class l{constructor(){s(this,"from",0),s(this,"to",0),s(this,"line",0)}}let c=function(e){return e[e.Pending=0]="Pending",e[e.Partial=1]="Partial",e[e.Complete=2]="Complete",e}({});const d=(e,t,n,r)=>!(t<n||e>r);function u(e,t,n,s,l){let u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],p=arguments.length>6?arguments[6]:void 0,m=arguments.length>7?arguments[7]:void 0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:{items:[],status:c.Pending};const f=h.status===c.Complete?h.items.filter((e=>!d(e.from,e.to,t,n))).map((e=>function(e,t){if(!t)return e;const{from:n,to:r}=e,i=t.changes.mapPos(n),s=t.changes.mapPos(r),o=t.state.doc.lineAt(i).number;return i===n&&s===r&&o===e.line?e:{...e,from:i,to:s,line:o}}(e,m))):[];h.status!==c.Complete&&(l=e.doc.length,s=0);const g=(0,r.a_)(e,l,u?a:o);return g?(g.iterate({from:s,to:l,enter:t=>p(e,t,f,(e=>d(e.from,e.to,s,l))),mode:i.Qj.IgnoreMounts|i.Qj.IgnoreOverlays}),{status:c.Complete,items:f.sort(((e,t)=>e.from-t.from))}):h.status!==c.Pending?{status:c.Partial,items:h.items}:{items:[],status:c.Pending}}},85868:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(14041),i=n(14088),s=n(46794),o=n(67993),a=n(10009),l=n(31085);const c=(0,r.forwardRef)(((e,t)=>{const{bs3Props:n,...r}=e,c={children:r.children,bsSize:r.size,name:r.name,value:r.value,defaultValue:r.defaultValue,disabled:r.disabled,onChange:r.onChange,required:r.required,placeholder:r.placeholder,className:r.className,inputRef:e=>{"function"==typeof t?t(e):t&&(t.current=e)},...n},d=(0,a.tz)(r);return(0,l.jsx)(o.A,{bs3:(0,l.jsx)(s.A,{componentClass:"select",...c,...d}),bs5:(0,l.jsx)(i.A.Select,{ref:t,...r})})}));c.displayName="OLFormSelect";const d=c},52553:(e,t,n)=>{n.d(t,{Pp:()=>o,fU:()=>s,mp:()=>a});var r=n(99420),i=n.n(r);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"h:mm a";return i()(e).format(t)}function o(e){return i()(e).calendar()}function a(e){return i()().diff(e,"years")>0?s(e,"D MMMM YYYY, h:mm a"):s(e,"D MMMM, h:mm a")}i().updateLocale("en",{calendar:{lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",lastWeek:"ddd, Do MMM YY",nextWeek:"ddd, Do MMM YY",sameElse:"ddd, Do MMM YY"}})},95898:(e,t,n)=>{n.d(t,{T:()=>A,k:()=>v});var r=n(57195),i=n(45250),s=n(37235),o=n(64932),a=n(60961);const l="CM6-BeforeUpdate",c="CM6-AfterUpdate",d="CM6-DomUpdate",u="CM6-Update",p="CM6-Keypress-Measure";let m=0;const h=Date.now();let f=!1;try{const e="featureTestMark";performance.mark(e,{startTime:performance.now(),detail:{test:1}}),performance.clearMarks(e);const t="featureTestMeasure";performance.measure(t,{start:performance.now(),detail:{test:1}}),performance.clearMeasures(t),f=!0}catch(e){}let g=!1;function x(){return performance.memory.usedJSHeapSize}try{"memory"in window.performance&&(x(),g=!0)}catch(e){}let j=!1,b=0;try{if(PerformanceObserver.supportedEntryTypes.includes("longtask")){j=!0;new PerformanceObserver((e=>{b+=e.getEntries().length})).observe({entryTypes:["longtask"]})}}catch(e){}function _(e){return!!e&&["input","delete"].includes(e.split(".")[0])}function y(e){return!!e&&["input.type","delete.forward","delete.backward"].includes(e)}function v(){if(!f)return{start:()=>{},end:()=>{}};let e=0,t=0;const n=[];return{start:e=>{const t=performance.now();e.forEach((e=>{y(e.annotation(r.ZX.userEvent))&&n.push(t)})),performance.mark(l)},end:(i,s)=>{performance.mark(c);let o=!1;i.forEach((n=>{const i=n.annotation(r.ZX.userEvent);_(i)&&(o=!0,++e,y(i)&&++t,performance.measure(u,{start:l,end:c,detail:{userEventType:i,userEventsSinceDomUpdateCount:e}}))})),o&&s.requestMeasure({key:"inputEventCounter",read(){performance.mark(d,{detail:{keypressesSinceDomUpdateCount:t}}),e=0,t=0;const r=performance.now();for(const e of n)performance.measure(p,{start:e,end:r});n.length=0}}),m=i[i.length-1].state.doc.length}}}function w(e){if(0===e.length)return 0;return e.reduce(((e,t)=>e+t),0)/e.length}function C(e){return e.reduce(((e,t)=>Math.max(e,t)),0)}function k(e){switch(e){case"measure":performance.clearMeasures(u),performance.clearMarks(l),performance.clearMarks(c);break;case"dom":performance.clearMarks(d);break;case"keypress":performance.clearMeasures(p)}}function A(){const e=performance.getEntriesByName(u,"measure");k("measure");const t=e.filter((e=>{let{detail:t}=e;return _(t.userEventType)})),n=t.map((e=>{let{duration:t}=e;return t})).sort(((e,t)=>e-t)),r=(0,i.round)(C(n),2),a=(0,i.round)(w(n),2),l=(0,i.round)(function(e){if(0===e.length)return 0;const t=Math.floor(e.length/2);return e.length%2==0?(e[t-1]+e[t])/2:e[t]}(n),2),c=(0,i.round)(0===(f=n).length?0:f[Math.round(.95*(f.length-1))],2);var f;const y=C(t.map((e=>e.detail.userEventsSinceDomUpdateCount))),v=(0,s.A)(),A=Math.floor((Date.now()-h)/1e3),E=g?x():null,S=performance.getEntriesByName(d,"mark");k("dom");let N=0,R=0,F=0,T=0;for(const e of S){const t=e.detail.keypressesSinceDomUpdateCount;1===t?++R:t>1&&++N,t>F&&(F=t),T+=t}const P=(0,i.round)(N/(N+R),4),L=(0,i.round)(T/(N+R),4),D=performance.getEntriesByName(p,"measure").map((e=>{let{duration:t}=e;return t})),I=(0,i.round)(w(D),2);k("keypress");let M=null;j&&(M=b,b=0);const O=(0,o.A)("ol-ExposedSettings")?.sentryRelease||null;return{max:r,mean:a,median:l,ninetyFifthPercentile:c,maxUserEventsBetweenDomUpdates:y,docLength:m,numberOfEntries:n.length,grammarly:v,sessionLength:A,memory:E,lags:N,nonLags:R,longestLag:F,meanLagsPerMeasure:P,meanKeypressesPerMeasure:L,meanKeypressPaint:I,longTasks:M,release:O}}window.addEventListener("editor:visual-switch",(()=>{k("measure"),k("dom"),k("keypress")})),window._reportCM6Perf=()=>{a.$.warn(A())}},17484:(e,t,n)=>{var r=n(64932),i=n(60961);const{hotjarId:s,hotjarVersion:o}=(0,r.A)("ol-ExposedSettings"),a=(0,r.A)("ol-shouldLoadHotjar");let l=!1;if(s&&o&&a){const e=()=>{document.cookie.split("; ").some((e=>"oa=1"===e))&&(/^\d+$/.test(s)&&/^\d+$/.test(o)?l||(i.$.log("Loading Hotjar"),l=!0,((e,t)=>{return n=window,r=document,n.hj=n.hj||function(){(n.hj.q=n.hj.q||[]).push(arguments)},n._hjSettings={hjid:e,hjsv:t},i=r.getElementsByTagName("head")[0],(s=r.createElement("script")).async=1,s.src="https://static.hotjar.com/c/hotjar-"+n._hjSettings.hjid+".js?sv="+n._hjSettings.hjsv,void i.appendChild(s);var n,r,i,s})(s,o)):i.$.error("Invalid Hotjar id or version"))};"function"==typeof window.requestIdleCallback?window.requestIdleCallback(e):e(),window.addEventListener("cookie-consent",(t=>{t.detail&&e()}))}},22344:(e,t,n)=>{function r(e,t){return e.reduce((async(e,n)=>[...await e,await t(n)]),Promise.resolve([]))}n.d(t,{_:()=>r})},29868:(e,t,n)=>{var r={};n.r(r),n.d(r,{default:()=>$});var i={};n.r(i),n.d(i,{default:()=>oe});var s={};n.r(s),n.d(s,{default:()=>Ce});var o={};n.r(o),n.d(o,{CreateFileMode:()=>Pr,CreateFilePane:()=>Lr});var a={};n.r(a),n.d(a,{CreateFileMode:()=>Dr,CreateFilePane:()=>Ir});var l={};n.r(l),n.d(l,{CreateFileMode:()=>Mr,CreateFilePane:()=>Or});var c={};n.r(c),n.d(c,{default:()=>Hr});var d={};n.r(d),n.d(d,{TPRFileViewNotOriginalImporter:()=>Mi});var u={};n.r(u),n.d(u,{TPRFileViewInfo:()=>qi});var p={};n.r(p),n.d(p,{TPRFileViewRefreshButton:()=>Ui});var m={};n.r(m),n.d(m,{TPRFileViewRefreshError:()=>TPRFileViewRefreshError});var h={};n.r(h),n.d(h,{default:()=>vs});var f={};n.r(f),n.d(f,{default:()=>co});n(76786),n(9155),n(17484);var g=n(43144),x=n(14041),j=n(36266),b=n(64826),_=n(97434),y=n(3218),v=n(22046),w=n(71627),C=n(31085);function k(e){let{reconnectAt:t,tryReconnectNow:n}=e;const{t:r}=(0,_.Bd)(),[i,s]=(0,x.useState)((0,y.C)(t));return(0,x.useEffect)((()=>{const e=window.setInterval((()=>{s((0,y.C)(t))}),1e3);return()=>window.clearInterval(e)}),[t]),(0,C.jsx)(v.A,{type:"warning",content:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("strong",{children:r("lost_connection")})," ",r("reconnecting_in_x_secs",{seconds:i}),"."]}),action:(0,C.jsx)(w.A,{id:"try-reconnect-now-button",onClick:()=>n(),size:"sm",variant:"secondary",bs3Props:{className:"pull-right"},children:r("try_now")})})}var A=n(12391),E=n(60961),S=n(14936),N=n(36471);function R(){const{t:e}=(0,_.Bd)(),{connectionState:t,isConnected:n,isStillReconnecting:r,tryReconnectNow:i,secondsUntilReconnect:s}=(0,A.FX)(),o=(0,N.J)(),[a]=(0,S.A)("sync_tex_error");return o?(0,g.createPortal)((0,C.jsxs)(C.Fragment,{children:[t.forceDisconnected?(0,C.jsx)(v.A,{type:"error",content:(0,C.jsx)("strong",{children:e("disconnected")})}):null,t.reconnectAt?(0,C.jsx)(k,{reconnectAt:t.reconnectAt,tryReconnectNow:i}):null,r?(0,C.jsx)(v.A,{type:"warning",content:(0,C.jsxs)("strong",{children:[e("reconnecting"),"…"]})}):null,a?(0,C.jsx)(v.A,{type:"warning",content:(0,C.jsx)("strong",{children:e("synctex_failed")}),action:(0,C.jsx)(w.A,{href:"/learn/how-to/SyncTeX_Errors",target:"_blank",id:"synctex-more-info-button",variant:"secondary",size:"sm",bs3Props:{className:"alert-link-as-btn pull-right"},children:e("more_info")})}):null,t.inactiveDisconnect||t.readyState===WebSocket.CLOSED&&("rate-limited"===t.error||"unable-to-connect"===t.error)&&!s()?(0,C.jsx)(v.A,{type:"warning",content:(0,C.jsx)("strong",{children:e("editor_disconected_click_to_reconnect")})}):null,E.v?(0,C.jsx)(v.A,{type:"warning",content:(0,C.jsxs)("strong",{children:["Connected: ",n.toString()]})}):null]}),o):null}var F=n(73613),T=n(53373),P=n.n(T);const L=e=>{let{children:t,resizable:n=!0,onDoubleClick:r,...i}=e;const{t:s}=(0,_.Bd)(),[o,a]=(0,x.useState)(!1);return(0,x.useEffect)((()=>{if(o){const e=()=>{i.onDragging?.(!0)};return document.addEventListener("pointermove",e),()=>{document.removeEventListener("pointermove",e)}}i.onDragging?.(!1)}),[o,i]),(0,C.jsx)(F.TW,{disabled:!n&&!o,...i,onDragging:function(e){(o||n)&&a(e)},children:(0,C.jsx)("div",{className:P()("horizontal-resize-handle",{"horizontal-resize-handle-enabled":n}),title:s("resize"),onDoubleClick:()=>r?.(),children:t})})};var D=n(56447),I=n(52036),M=n(77135),O=n(5964),B=(n(34397),n(61412),n(91883),n(70286),n(96713)),q=n(65982);function $(){const{fileTreeFromHistory:e,snapshotLoadingState:t,setFileTreeFromHistory:n}=(0,q.P4)();let r="sync_disabled";if(e)switch(t){case"":r="cloud_sync";break;case"loading":r="hourglass_top";break;case"error":r="sync_problem"}return(0,C.jsx)("div",{className:"toolbar-item",children:(0,C.jsx)("button",{className:"btn btn-full-height",onClick:()=>n(!e),children:(0,C.jsx)(B.A,{type:r})})})}var z=n(16065),U=n(81023),V=n(51763),H=n(9781),G=n(81114),K=n(97294),Y=n(46794),W=n(43721),Q=n(309),X=n(89135),Z=n(22743),J=n(37603),ee=n.n(J);class te extends(ee()){}function ne(e){let{handleHide:t}=e;const{snapshot:n,snapshotVersion:r}=(0,q.P4)(),{t:i}=(0,_.Bd)(),[s,o]=(0,x.useState)(""),[a,l]=(0,x.useState)(!1),[c,d]=(0,x.useState)(!1),[u,p]=(0,x.useState)(""),[m,h]=(0,x.useState)([]),[f,g]=(0,x.useState)(!1),[j,b]=(0,x.useState)(!1),[y,v]=(0,x.useState)(),w=(0,Q.A)(s,100);(0,x.useEffect)((()=>{if(0===w.length)return h([]),void b(!0);v(void 0),p(""),g(!0),n&&async function(e){let t,n,{snapshot:r,term:i,isRegex:s,matchCase:o,maxResultsPerFile:a}=e;if(s)try{t=new RegExp(i,"g"+(o?"":"i"))}catch(e){throw new te(e.message)}else n=o?i:i.toLowerCase();return await(0,Z.populateSnapshot)(r),r.getFileMap().map((e=>{const r=[];if(!e||!e.isEditable())return r;const l=e.getContent({filterTrackedDeletes:!0});if(s){for(const e of l.matchAll(t))if(r.push({idx:e.index,match:e[0],content:l}),r.length>a)break}else{let e=-1;const t=o?l:l.toLowerCase();for(;-1!==(e=t.indexOf(n,e+1))&&(r.push({idx:e,match:l.slice(e,e+i.length),content:l}),!(r.length>a)););}return r}))}({snapshot:n,term:w,isRegex:a,matchCase:c,maxResultsPerFile:100}).then((e=>{h(Object.entries(e).filter((e=>{let[,t]=e;return 0!==t.length})).map((e=>{let[t,n]=e;return{path:t,results:n}}))),b(!0)})).catch((e=>{e instanceof te?p(e.message):(E.$.error(e),v(e))})).finally((()=>{g(!1)}))}),[a,c,w,n,r]);const k=(0,x.useCallback)((e=>{let{inputValue:t}=e;o(t)}),[]),A=(0,x.useCallback)((()=>{t()}),[t]),{getMenuProps:S,getInputProps:N,getComboboxProps:R,getItemProps:F,highlightedIndex:T}=(0,z.Bp)({items:m,itemToString:e=>e?.path??"",onInputValueChange:k,onSelectedItemChange:A});return(0,C.jsxs)(U.A,{fluid:!0,children:[(0,C.jsx)(V.A,{children:(0,C.jsx)(H.A,{md:12,className:"search-form",children:(0,C.jsxs)(G.A,{...R(),children:[(0,C.jsx)(K.A,{srOnly:!0,children:i("search_terms")}),(0,C.jsx)(Y.A,{...N({autoFocus:!0,autoComplete:"off",refKey:"inputRef",placeholder:i("search_all_project_files")+"…"})}),(0,C.jsx)("input",{type:"checkbox",id:"full-project-search-regex",checked:a,onChange:e=>l(e.target.checked)})," ",(0,C.jsx)("label",{htmlFor:"full-project-search-regex",children:i("search_regexp")})," ",(0,C.jsx)("input",{type:"checkbox",id:"full-project-search-case-sensitive",checked:c,onChange:e=>d(e.target.checked)})," ",(0,C.jsx)("label",{htmlFor:"full-project-search-case-sensitive",children:i("search_match_case")}),f&&(0,C.jsx)(X.A,{type:"spinner",spin:!0,className:"form-control-feedback"}),(0,C.jsx)(Y.A.Feedback,{})]})})}),y&&(0,C.jsx)(V.A,{children:(0,C.jsx)(H.A,{md:12,children:(0,C.jsx)(W.A,{bsStyle:"danger",children:i("generic_something_went_wrong")})})}),u&&(0,C.jsx)(V.A,{children:(0,C.jsx)(H.A,{md:12,children:(0,C.jsx)(W.A,{bsStyle:"warning",children:u})})}),(0,C.jsxs)(V.A,{className:"search-results",children:[(0,C.jsxs)(H.A,{md:12,children:[j&&0===m.length&&(0,C.jsx)("div",{className:"no-results-message",children:(0,C.jsx)("div",{className:"text-center",children:i("no_search_results")})}),m.length>100&&(0,C.jsx)("div",{className:"too-many-results-message text-center",children:i("too_many_search_results")})]}),(0,C.jsx)(H.A,{md:12,className:"search-results-scroll-container",children:(0,C.jsx)("ul",{...S(),className:"list-unstyled",children:m.map(((e,t)=>{const n=e.results[0];return(0,C.jsxs)("li",{...F({item:e,index:t}),className:P()("search-result-hit",{"selected-search-result-hit":T===t}),children:[(0,C.jsx)(V.A,{children:(0,C.jsxs)(H.A,{md:12,children:[(0,C.jsx)("span",{className:"hit-title",children:(0,C.jsx)("b",{children:e.path})}),(0,C.jsx)("span",{className:"hit-key pull-right",children:i("n_matches",{n:e.results.length>100?"100+":e.results.length})})]})}),(0,C.jsx)(V.A,{children:(0,C.jsxs)(H.A,{md:12,children:["…"," ",n.content.slice(Math.max(0,n.idx-15),n.idx),(0,C.jsx)("b",{children:n.match}),n.content.slice(n.idx+n.match.length,n.idx+n.match.length+15)," ","…"]})})]},e.path)}))})})]})]})}var re=n(28812);const ie=x.memo((function(e){let{show:t,handleHide:n}=e;const{t:r}=(0,_.Bd)();return(0,C.jsxs)(re.Ay,{animation:!0,show:t,onHide:n,id:"full-project-search-modal",children:[(0,C.jsx)(re.IK,{closeButton:!0,children:(0,C.jsx)(re.rA,{children:r("full_project_search")})}),(0,C.jsx)(re.$8,{children:(0,C.jsx)(ne,{handleHide:n})}),(0,C.jsx)(re.E9,{children:(0,C.jsx)(w.A,{variant:"secondary",onClick:n,children:r("close")})})]})})),se=(0,b.A)(ie);const oe=function(){const{fileTreeFromHistory:e}=(0,q.P4)(),[t,n]=(0,x.useState)(!1);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"toolbar-item",children:(0,C.jsx)("button",{className:"btn btn-full-height",disabled:!e,onClick:()=>n(!0),children:(0,C.jsx)(B.A,{type:"search"})})}),t&&(0,C.jsx)(se,{show:t,handleHide:()=>n(!1)})]})};var ae=n(39067),le=n.n(ae),ce=n(67993),de=(n(97107),n(10646)),ue=n(85960),pe=n(8164),me=n(69475),he=n(66666),fe=n(71573),ge=n(37858),xe=n(67353);const je=(0,x.createContext)(void 0),be=e=>{let{children:t}=e;const{first_name:n,last_name:r}=(0,ue.ur)(),{_id:i,name:s,rootDocId:o}=(0,he.O)(),{hasFolders:a}=(0,fe.Q)(),l=(0,xe.nK)(),{cobranding:c}=(0,de.mi)(),{pdfDownloadUrl:d,pdfUrl:u,logEntries:p}=(0,pe.Rf)(),{uncompiled:m}=(0,pe.Rf)();let h,f,g;c&&(c.publishGuideHtml||c.partner)?c.brandedMenu?(f=`/journals/${c.brandId}`,h="branded"):c.partner?(f=`/journals/${c.brandId}`,h="export",g=c.brandVariationId):(f=`/journals/${c.brandId}`,h="guide",g=c.brandVariationId):(f="/journals",h="basic");const[j,b]=(0,x.useState)(null),[_,y]=(0,x.useState)(null),v=(0,me.A)(),w=(0,x.useCallback)((()=>{const e=`/latest_template/${i}`;return Promise.all([(0,ge.hm)(e),(0,ge.hm)(f)]).then((e=>{let[t,n]=e;if(v.current){const e=t.title?{title:t.title}:{};e.description=t.description,e.author=t.author,e.license=t.license,y(t),b(n)}}))}),[v,f,i]),k=(0,x.useCallback)((()=>{const e=o;if(l.editorManager.getCurrentDocId()===e)return!1;const t=l.editorManager.getCurrentDocValue();if(null==t)return!1;for(const e of t.split("\n"))if(/^[^%]*\\documentclass/.test(e))return!0;return!1}),[l.editorManager,o]),A={entries:j,initialShown:h,brandVariationId:g,fetchData:w,initParams:{projectId:i,pdfUrl:u?d:void 0,logs:p,uncompiled:m,hasFolders:a,rootDocOverridden:k(),firstName:n,lastName:r,title:s,..._}};return(0,C.jsx)(je.Provider,{value:A,children:t})};class DestinationsError extends x.Component{render(){return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)("p",{children:["Sorry, we had trouble retrieving our list of submission destinations. If you give us a minute, retry, and still find this error, please notify support at"," ",(0,C.jsx)("a",{href:"mailto:support@overleaf.com?subject=Unable to submit",children:"support@overleaf.com"})]})})}}var _e=n(56015);const ye=(0,x.lazy)((()=>Promise.all([n.e(4651),n.e(4528),n.e(5196)]).then(n.bind(n,85196))));function ve(e){let{handleHide:t}=e;const{t:r}=(0,_.Bd)(),{entries:i,initialShown:s,initParams:o,fetchData:a,brandVariationId:l}=function(){const e=(0,x.useContext)(je);if(!e)throw new Error("usePublishContext is only available inside PublishProvider");return e}(),[c,d]=(0,x.useState)(!0),[u,p]=(0,x.useState)(!1),[m,h]=(0,x.useState)(!1),f=(0,me.A)();let g;function j(){t(),d(!1)}return(0,x.useEffect)((()=>{Promise.all([n.e(4651),n.e(4528),n.e(5196)]).then(n.bind(n,85196)).catch((()=>h(!0))),u||(a().catch((()=>{f.current&&h(!0)})),p(!0))}),[f,u,a]),g=i&&o?.logs?(0,C.jsx)(x.Suspense,{fallback:(0,C.jsx)(_e.A,{}),children:(0,C.jsx)(ye,{entries:i,initialShown:s,initParams:o,brandVariationId:l})}):m?(0,C.jsx)(DestinationsError,{}):(0,C.jsx)(_e.A,{}),(0,C.jsxs)(re.Ay,{size:"lg",show:c,onHide:j,children:[(0,C.jsx)(re.IK,{closeButton:!0,children:(0,C.jsx)(re.rA,{children:r("submit_title")})}),(0,C.jsx)(re.$8,{children:(0,C.jsx)("div",{className:"modal-body-publish",children:g})}),(0,C.jsx)(re.E9,{children:(0,C.jsx)(w.A,{variant:"secondary",onClick:j,children:r("close")})})]})}function we(e){let{cobranding:t}=e;const{t:n}=(0,_.Bd)(),[r,i]=(0,x.useState)(!1);const s=P()("btn","btn-full-height");return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"toolbar-item",children:(0,C.jsxs)("button",{type:"button",id:"publishButton",className:s,onClick:function(){O._("navigation-clicked-submit"),i(!0)},children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"globe",fw:!0}),bs5:(0,C.jsx)(B.A,{type:"public",className:"align-middle"})}),t?.submitBtnHtml?(0,C.jsx)("p",{className:"toolbar-label toolbar-label-multiline",dangerouslySetInnerHTML:{__html:t.submitBtnHtml}}):(0,C.jsx)("p",{className:"toolbar-label",children:n("submit_title")})]})}),r&&(0,C.jsx)(be,{children:(0,C.jsx)(ve,{handleHide:function(){i(!1)}})})]})}we.propTypes={cobranding:le().shape({submitBtnHtml:le().string})};const Ce=(0,b.A)(we);function ke(e){let{onClick:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsx)("div",{className:"toolbar-item",children:(0,C.jsxs)("button",{type:"button",className:"btn btn-full-height",onClick:t,children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"bars",fw:!0,className:"editor-menu-icon"}),bs5:(0,C.jsx)(B.A,{type:"menu",className:"editor-menu-icon align-middle"})}),(0,C.jsx)("p",{className:"toolbar-label",children:n("menu")})]})})}ke.propTypes={onClick:le().func.isRequired};const Ae=ke;function Ee(e){let{brandVariationHomeUrl:t,brandVariationName:n,logoImgUrl:r}=e;return(0,C.jsx)("a",{className:"btn btn-full-height header-cobranding-logo-container",href:t,target:"_blank",rel:"noreferrer noopener",children:(0,C.jsx)("img",{src:r,className:"header-cobranding-logo",alt:n})})}Ee.propTypes={brandVariationHomeUrl:le().string.isRequired,brandVariationName:le().string.isRequired,logoImgUrl:le().string.isRequired};const Se=Ee;var Ne=n(93075);const Re=function(){const{t:e}=(0,_.Bd)();return(0,C.jsx)(Ne.A,{id:"back-to-projects",description:e("back_to_your_projects"),overlayProps:{placement:"right"},children:(0,C.jsx)("div",{className:"toolbar-item",children:(0,C.jsx)("a",{className:"btn btn-full-height",draggable:"false",href:"/project",onClick:()=>{O._("navigation-clicked-home")},children:(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"home",fw:!0,accessibilityLabel:e("back_to_your_projects")}),bs5:(0,C.jsx)(B.A,{type:"home",className:"align-text-bottom",accessibilityLabel:e("back_to_your_projects")})})})})})};var Fe=n(10009);const Te=function(){const{t:e}=(0,_.Bd)();return(0,C.jsx)(w.A,{variant:"primary",size:"sm",className:P()("toolbar-header-upgrade-prompt",(0,Fe.q$)({bs3:"btn-xs"})),href:"/user/subscription/plans?itm_referrer=editor-header-upgrade-prompt",target:"_blank",onClick:function(e){O.tN("subscription-funnel","code-editor","upgrade"),O._("upgrade-button-click",{source:"code-editor"})},children:e("upgrade")})};var Pe=n(35722);function Le(e){let{chatIsOpen:t,unreadMessageCount:n,onClick:r}=e;const{t:i}=(0,_.Bd)(),s=P()("btn","btn-full-height",{active:t}),o=n>0;return(0,C.jsx)("div",{className:"toolbar-item",children:(0,C.jsxs)("button",{type:"button",className:s,onClick:r,children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"comment",fw:!0,className:P()({bounce:o})}),bs5:(0,C.jsx)(B.A,{type:"chat",className:P()("align-middle",{bounce:o})})}),o&&(0,C.jsx)(Pe.A,{bg:"info",children:n}),(0,C.jsx)("p",{className:"toolbar-label",children:i("chat")})]})})}Le.propTypes={chatIsOpen:le().bool,unreadMessageCount:le().number.isRequired,onClick:le().func.isRequired};const De=Le;var Ie=n(2439),Me=n(42118),Oe=n(99852),Be=n(61160),qe=n(96047);const $e=function(){const{t:e}=(0,_.Bd)();return(0,C.jsx)(X.A,{type:"check",fw:!0,accessibilityLabel:e("selected")})};var ze=n(64526),Ue=n(89139);function Ve(){return(0,C.jsx)(X.A,{type:"",fw:!0})}function He(){return(0,C.jsx)(X.A,{type:"refresh",fw:!0,spin:!0})}function Ge(){return(0,C.jsx)(X.A,{type:"columns",fw:!0})}function Ke(){return(0,C.jsx)(X.A,{type:"columns",fw:!0})}function Ye(){return(0,C.jsx)(X.A,{type:"window-restore",fw:!0})}function We(){return(0,C.jsx)(X.A,{type:"code",fw:!0})}function Qe(){return(0,C.jsx)(X.A,{type:"file-pdf-o",fw:!0})}const Xe=e=>{let{iconFor:t,pdfLayout:n,view:r,detachRole:i}=e;return"detacher"!==i&&"history"!==r&&("editorOnly"===t&&"flat"===n&&("editor"===r||"file"===r)||("pdfOnly"===t&&"flat"===n&&"pdf"===r||"sideBySide"===t&&"sideBySide"===n))};function Ze(e){return Xe(e)?(0,C.jsx)($e,{}):(0,C.jsx)(Ve,{})}function Je(e){let{checkmark:t,icon:n,text:r,...i}=e;return(0,C.jsx)(Ie.A,{...i,children:(0,C.jsx)("div",{className:"layout-menu-item",children:(0,C.jsxs)("div",{className:"layout-menu-item-start",children:[(0,C.jsx)("div",{children:t}),(0,C.jsx)("div",{children:n}),(0,C.jsx)("div",{children:r})]})})})}function et(e){let{active:t,...n}=e;return(0,C.jsx)(Be.tJ,{active:t,"aria-current":t,trailingIcon:t?"check":null,...n})}const tt=(0,x.forwardRef)(((e,t)=>{let{onClick:n,...r}=e;return(0,C.jsx)(Be.fu,{...r,ref:t,onClick:e=>{O._("navigation-clicked-layout"),n(e)}})}));function nt(){const{t:e}=(0,_.Bd)();return(0,C.jsx)(qe.A,{id:"detach-disabled",description:e("your_browser_does_not_support_this_feature"),overlayProps:{placement:"left"},children:(0,C.jsx)(Je,{disabled:!0,checkmark:(0,C.jsx)(Ve,{}),icon:(0,C.jsx)(Ye,{}),text:e("pdf_in_separate_tab")})})}function rt(){const{t:e}=(0,_.Bd)();return(0,C.jsx)(Ne.A,{id:"detach-disabled",description:e("your_browser_does_not_support_this_feature"),overlayProps:{placement:"left"},children:(0,C.jsx)("span",{children:(0,C.jsx)(et,{disabled:!0,leadingIcon:"select_window",children:e("pdf_in_separate_tab")})})})}function it(){const{reattach:e,detach:t,detachIsLinked:n,detachRole:r,changeLayout:i,view:s,pdfLayout:o}=(0,D.LV)(),a=(0,x.useCallback)((()=>{t(),O._("project-layout-detach")}),[t]),l=(0,x.useCallback)((()=>{"detacher"===r&&(e(),O._("project-layout-reattach"))}),[r,e]);(0,Ue.A)("ui:pdf-open",l);const c=(0,x.useCallback)(((e,t)=>{l(),i(e,t),O._("project-layout-change",{layout:e,view:t})}),[i,l]);return(0,C.jsx)(st,{processing:!n&&"detacher"===r,handleChangeLayout:c,handleDetach:a,detachIsLinked:n,detachRole:r,pdfLayout:o,view:s,detachable:"BroadcastChannel"in window})}tt.displayName="LayoutDropdownToggleButton";const st=e=>{let{processing:t,handleChangeLayout:n,handleDetach:r,detachIsLinked:i,detachRole:s,view:o,pdfLayout:a,detachable:l}=e;const{t:c}=(0,_.Bd)();return(0,C.jsxs)(C.Fragment,{children:[t&&(0,C.jsx)("div",{"aria-live":"assertive",className:"sr-only",children:c("layout_processing")}),(0,C.jsx)(ce.A,{bs3:(0,C.jsxs)(ze.A,{id:"layout-dropdown",onMainButtonClick:()=>{O._("navigation-clicked-layout")},className:"toolbar-item layout-dropdown",pullRight:!0,children:[(0,C.jsxs)(Me.A.Toggle,{className:"btn-full-height",bsStyle:"link",children:[t?(0,C.jsx)(He,{}):(0,C.jsx)(Ge,{}),(0,C.jsx)("span",{className:"toolbar-label",children:c("layout")})]}),(0,C.jsxs)(Me.A.Menu,{className:"layout-dropdown-list",children:[(0,C.jsx)(Je,{onSelect:()=>n("sideBySide"),checkmark:(0,C.jsx)(Ze,{iconFor:"sideBySide",pdfLayout:a,view:o,detachRole:s}),icon:(0,C.jsx)(Ke,{}),text:c("editor_and_pdf")}),(0,C.jsx)(Je,{onSelect:()=>n("flat","editor"),checkmark:(0,C.jsx)(Ze,{iconFor:"editorOnly",pdfLayout:a,view:o,detachRole:s}),icon:(0,C.jsx)(We,{}),text:(0,C.jsx)(_.x6,{i18nKey:"editor_only_hide_pdf",components:[(0,C.jsx)("span",{className:"subdued"},"editor_only_hide_pdf")]})}),(0,C.jsx)(Je,{onSelect:()=>n("flat","pdf"),checkmark:(0,C.jsx)(Ze,{iconFor:"pdfOnly",pdfLayout:a,view:o,detachRole:s}),icon:(0,C.jsx)(Qe,{}),text:(0,C.jsx)(_.x6,{i18nKey:"pdf_only_hide_editor",components:[(0,C.jsx)("span",{className:"subdued"},"pdf_only_hide_editor")]})}),l?(0,C.jsx)(Je,{onSelect:()=>r(),checkmark:"detacher"===s?i?(0,C.jsx)($e,{}):(0,C.jsx)(He,{}):(0,C.jsx)(Ve,{}),icon:(0,C.jsx)(Ye,{}),text:c("pdf_in_separate_tab")}):(0,C.jsx)(nt,{})]})]}),bs5:(0,C.jsxs)(Be.ms,{className:"toolbar-item layout-dropdown",align:"end",children:[(0,C.jsxs)(Be.C,{id:"layout-dropdown-btn",className:"btn-full-height",as:tt,children:[t?(0,C.jsx)(Oe.A,{animation:"border","aria-hidden":"true",size:"sm",role:"status"}):(0,C.jsx)(B.A,{type:"dock_to_right",className:"align-middle"}),(0,C.jsx)("span",{className:"toolbar-label",children:c("layout")})]}),(0,C.jsxs)(Be.rI,{children:[(0,C.jsx)(et,{onClick:()=>n("sideBySide"),active:Xe({iconFor:"sideBySide",pdfLayout:a,view:o,detachRole:s}),leadingIcon:"dock_to_right",children:c("editor_and_pdf")}),(0,C.jsx)(et,{onClick:()=>n("flat","editor"),active:Xe({iconFor:"editorOnly",pdfLayout:a,view:o,detachRole:s}),leadingIcon:"code",children:(0,C.jsx)("div",{className:"d-flex flex-column",children:(0,C.jsx)(_.x6,{i18nKey:"editor_only_hide_pdf",components:[(0,C.jsx)("span",{className:"subdued"},"editor_only_hide_pdf")]})})}),(0,C.jsx)(et,{onClick:()=>n("flat","pdf"),active:Xe({iconFor:"pdfOnly",pdfLayout:a,view:o,detachRole:s}),leadingIcon:"picture_as_pdf",children:(0,C.jsx)("div",{className:"d-flex flex-column",children:(0,C.jsx)(_.x6,{i18nKey:"pdf_only_hide_editor",components:[(0,C.jsx)("span",{className:"subdued"},"pdf_only_hide_editor")]})})}),l?(0,C.jsx)(et,{onClick:()=>r(),active:"detacher"===s&&i,trailingIcon:"detacher"===s?i?"check":(0,C.jsxs)("span",{className:"spinner-container",children:[(0,C.jsx)(Oe.A,{animation:"border","aria-hidden":"true",size:"sm",role:"status"}),(0,C.jsx)("span",{className:"visually-hidden",children:c("loading")})]}):null,leadingIcon:"select_window",children:c("pdf_in_separate_tab")}):(0,C.jsx)(rt,{})]})]})})]})},ot=(0,x.memo)(it);var at=n(37365);function lt(e){let{onlineUsers:t,goToUser:n}=e;const{t:r}=(0,_.Bd)();return t.length>=4?(0,C.jsx)(ce.A,{bs3:(0,C.jsxs)(ze.A,{id:"online-users",className:"online-users",pullRight:!0,children:[(0,C.jsx)(dt,{bsRole:"toggle",onlineUserCount:t.length}),(0,C.jsxs)(Me.A.Menu,{children:[(0,C.jsx)(Ie.A,{header:!0,children:r("connected_users")}),t.map(((e,t)=>(0,C.jsx)(Ie.A,{as:"button",eventKey:e,onSelect:n,children:(0,C.jsx)(ct,{user:e,showName:!0})},`${e.user_id}_${t}`)))]})]}),bs5:(0,C.jsxs)(Be.ms,{id:"online-users",className:"online-users",align:"end",children:[(0,C.jsx)(Be.C,{as:dt,onlineUserCount:t.length}),(0,C.jsxs)(Be.rI,{children:[(0,C.jsx)(Be.hO,{"aria-hidden":"true",children:r("connected_users")}),t.map(((e,t)=>(0,C.jsx)("li",{role:"none",children:(0,C.jsx)(Be.tJ,{as:"button",tabIndex:-1,onClick:()=>n(e),children:(0,C.jsx)(ct,{user:e,showName:!0})})},`${e.user_id}_${t}`)))]})]})}):(0,C.jsx)("div",{className:"online-users",children:t.map(((e,t)=>(0,C.jsx)(Ne.A,{id:"online-user",description:e.name,overlayProps:{placement:"bottom",trigger:["hover","focus"]},children:(0,C.jsx)("span",{children:(0,C.jsx)(ct,{user:e,onClick:n})})},`${e.user_id}_${t}`)))})}function ct(e){let{user:t,showName:n,onClick:r}=e;const i=`hsl(${(0,at.O)(t.user_id)}, 70%, 50%)`;const[s]=[...t.name];return(0,C.jsxs)("span",{onClick:function(){r?.(t)},children:[(0,C.jsx)("span",{className:"online-user",style:{backgroundColor:i},children:s}),n&&t.name]})}lt.propTypes={onlineUsers:le().arrayOf(le().shape({user_id:le().string.isRequired,name:le().string.isRequired})).isRequired,goToUser:le().func.isRequired},ct.propTypes={user:le().shape({user_id:le().string.isRequired,name:le().string.isRequired}),showName:le().bool,onClick:le().func};const dt=x.forwardRef(((e,t)=>{const{t:n}=(0,_.Bd)();return(0,C.jsx)(Ne.A,{id:"connected-users",description:n("connected_users"),overlayProps:{placement:"left"},children:(0,C.jsxs)("button",{type:"button",className:"online-user online-user-multi",onClick:e.onClick,ref:t,children:[(0,C.jsx)("strong",{children:e.onlineUserCount})," ",(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"users",fw:!0}),bs5:(0,C.jsx)(B.A,{type:"groups"})})]})})}));dt.displayName="DropDownToggleButton",dt.propTypes={onlineUserCount:le().number.isRequired,onClick:le().func};const ut=lt;var pt=n(23588);const mt=function(e){let{projectName:t,hasRenamePermissions:n,onChange:r,className:i}=e;const{t:s}=(0,_.Bd)(),[o,a]=(0,x.useState)(!1),l=n&&!o,[c,d]=(0,x.useState)(t),u=(0,x.useRef)(null);function p(){l&&(d(t),a(!0))}function m(){a(!1),r(c)}return(0,x.useEffect)((()=>{o&&u.current?.select()}),[o]),(0,C.jsxs)("div",{className:P()("project-name",i),children:[!o&&(0,C.jsx)("span",{className:"name",onDoubleClick:p,children:t}),o&&(0,C.jsx)(pt.A,{ref:u,type:"text",onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),m())},onChange:function(e){d(e.target.value)},onBlur:function(){o&&m()},value:c}),l&&(0,C.jsx)(Ne.A,{id:"online-user",description:s("rename"),overlayProps:{placement:"bottom",trigger:["hover","focus"]},children:(0,C.jsx)("a",{className:"rename",role:"button",onClick:p,children:(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"pencil",fw:!0}),bs5:(0,C.jsx)(B.A,{type:"edit",className:"align-text-bottom"})})})})]})};function ht(e){let{trackChangesIsOpen:t,disabled:n,onMouseDown:r}=e;const{t:i}=(0,_.Bd)(),s=P()("btn","btn-full-height",{active:t&&!n,disabled:n});return(0,C.jsx)("div",{className:"toolbar-item",children:(0,C.jsxs)("button",{type:"button",disabled:n,className:s,onMouseDown:r,children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)("i",{className:"review-icon"}),bs5:(0,C.jsx)(B.A,{type:"rate_review",className:"align-middle"})}),(0,C.jsx)("p",{className:"toolbar-label",children:i("review")})]})})}ht.propTypes={trackChangesIsOpen:le().bool,disabled:le().bool,onMouseDown:le().func.isRequired};const ft=ht;function gt(e){let{onClick:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsx)("div",{className:"toolbar-item",children:(0,C.jsxs)("button",{type:"button",className:"btn btn-full-height",onClick:t,children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"history",fw:!0}),bs5:(0,C.jsx)(B.A,{type:"history",className:"align-middle"})}),(0,C.jsx)("p",{className:"toolbar-label",children:n("history")})]})})}gt.propTypes={onClick:le().func.isRequired};const xt=gt;function jt(e){let{onClick:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsx)("div",{className:"toolbar-item",children:(0,C.jsxs)("button",{type:"button",className:"btn btn-full-height",onClick:t,children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"group",fw:!0}),bs5:(0,C.jsx)(B.A,{type:"group_add",className:"align-middle"})}),(0,C.jsx)("p",{className:"toolbar-label",children:n("share")})]})})}jt.propTypes={onClick:le().func.isRequired};const bt=jt;const _t=function(e){let{onClick:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsxs)(w.A,{variant:"secondary",size:"sm",onClick:t,className:"back-to-editor-btn",children:[(0,C.jsx)(B.A,{type:"arrow_back",className:"toolbar-btn-secondary-icon"}),(0,C.jsx)("span",{className:"toolbar-label",children:n("back_to_editor")})]})};var yt=n(64932),vt=n(58528);const[wt]=[{import:s,path:"/overleaf/services/web/modules/publish-modal/frontend/js/components/publish-toolbar-button"}],Ct=wt?.import.default,kt=[{import:r,path:"/overleaf/services/web/modules/offline-mode/frontend/js/components/editor-toolbar/file-tree-from-history-button"},{import:i,path:"/overleaf/services/web/modules/offline-mode/frontend/js/components/editor-toolbar/full-project-search-button"}],At=(0,vt.g9)("ro-mirror-on-client")&&"enabled"===new URLSearchParams(window.location.search).get("ro-mirror-on-client"),Et=x.memo((function(e){let{cobranding:t,onShowLeftMenuClick:n,chatIsOpen:r,toggleChatOpen:i,reviewPanelOpen:s,toggleReviewPanelOpen:o,historyIsOpen:a,toggleHistoryOpen:l,unreadMessageCount:c,onlineUsers:d,goToUser:u,isRestrictedTokenMember:p,hasPublishPermissions:m,chatVisible:h,projectName:f,renameProject:g,hasRenamePermissions:x,openShareModal:j,trackChangesVisible:b}=e;const y=(0,yt.A)("ol-chatEnabled"),{t:v}=(0,_.Bd)(),w=m&&Ct;return(0,C.jsxs)("header",{className:"toolbar toolbar-header",role:"navigation","aria-label":v("project_layout_sharing_submission"),children:[(0,C.jsxs)("div",{className:"toolbar-left",children:[(0,C.jsx)(Ae,{onClick:n}),t&&t.logoImgUrl&&(0,C.jsx)(Se,{...t}),(0,C.jsx)(Re,{}),At&&kt.map((e=>{let{path:t,import:{default:n}}=e;return(0,C.jsx)(n,{},t)}))]}),(0,yt.A)("ol-showUpgradePrompt")&&(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(Te,{}),bs5:(0,C.jsx)("div",{className:"d-flex align-items-center",children:(0,C.jsx)(Te,{})})}),(0,C.jsx)(mt,{className:"toolbar-center",projectName:f,hasRenamePermissions:x,onChange:g}),(0,C.jsxs)("div",{className:"toolbar-right",children:[(0,C.jsx)(ut,{onlineUsers:d,goToUser:u}),a?(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(_t,{onClick:l}),bs5:(0,C.jsx)("div",{className:"d-flex align-items-center",children:(0,C.jsx)(_t,{onClick:l})})}):(0,C.jsxs)(C.Fragment,{children:[b&&(0,C.jsx)(ft,{onMouseDown:o,disabled:a,trackChangesIsOpen:s}),(0,C.jsx)(bt,{onClick:j}),w&&(0,C.jsx)(Ct,{cobranding:t}),!p&&(0,C.jsx)(xt,{onClick:l}),(0,C.jsx)(ot,{}),y&&h&&(0,C.jsx)(De,{chatIsOpen:r,onClick:i,unreadMessageCount:c})]})]})]})}));Et.propTypes={onShowLeftMenuClick:le().func.isRequired,cobranding:le().object,chatIsOpen:le().bool,toggleChatOpen:le().func.isRequired,reviewPanelOpen:le().bool,toggleReviewPanelOpen:le().func.isRequired,historyIsOpen:le().bool,toggleHistoryOpen:le().func.isRequired,unreadMessageCount:le().number.isRequired,onlineUsers:le().array.isRequired,goToUser:le().func.isRequired,isRestrictedTokenMember:le().bool,hasPublishPermissions:le().bool,chatVisible:le().bool,projectName:le().string.isRequired,renameProject:le().func.isRequired,hasRenamePermissions:le().bool,openShareModal:le().func.isRequired,trackChangesVisible:le().bool};const St=Et;var Nt=n(99806);function Rt(e){return e?"open":"close"}const Ft=x.memo((function(e){let{onlineUsersArray:t,openDoc:n,openShareProjectModal:r}=e;const{name:i,features:{trackChangesVisible:s}}=(0,he.O)(),{cobranding:o,isRestrictedTokenMember:a,renameProject:l,permissionsLevel:c}=(0,de.mi)(),{chatIsOpen:d,setChatIsOpen:u,reviewPanelOpen:p,setReviewPanelOpen:m,view:h,setView:f,setLeftMenuShown:g}=(0,D.LV)(),{markMessagesAsRead:j,unreadMessageCount:b}=(0,Nt.vd)(),_=(0,x.useCallback)((()=>{d||j(),O._("navigation-clicked-chat",{action:Rt(!d)}),u(!d)}),[d,u,j]),y=(0,x.useCallback)((e=>{e.preventDefault(),O._("navigation-clicked-review",{action:Rt(!p)}),m((e=>!e))}),[p,m]),[v,w]=(0,x.useState)(d),k=(0,x.useCallback)((()=>{const e="history"===h?"close":"open";O._("navigation-clicked-history",{action:e}),d&&"open"===e&&(w(!0),_()),v&&"close"===e&&(w(!1),_()),f("history"===h?"editor":"history")}),[h,d,v,f,_]),A=(0,x.useCallback)((()=>{O._("navigation-clicked-share"),r()}),[r]),E=(0,x.useCallback)((()=>{O._("navigation-clicked-menu"),g((e=>!e))}),[g]),S=(0,x.useCallback)((e=>{e.doc&&"number"==typeof e.row&&n(e.doc,{gotoLine:e.row+1})}),[n]);return(0,C.jsx)(St,{cobranding:o,onShowLeftMenuClick:E,chatIsOpen:d,unreadMessageCount:b,toggleChatOpen:_,reviewPanelOpen:p,toggleReviewPanelOpen:y,historyIsOpen:"history"===h,toggleHistoryOpen:k,onlineUsers:t,goToUser:S,isRestrictedTokenMember:a,hasPublishPermissions:"owner"===c||"readAndWrite"===c,chatVisible:!a,projectName:i,renameProject:l,hasRenamePermissions:"owner"===c,openShareModal:A,trackChangesVisible:s})}));var Tt=n(17515),Pt=n(30158),Lt=n(43480);function Dt(e){let{handleHide:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(re.IK,{closeButton:!0,children:(0,C.jsx)(re.rA,{children:n("do_you_need_edit_access")})}),(0,C.jsxs)(re.$8,{children:[(0,C.jsx)("p",{children:n("this_project_has_more_than_max_collabs",{linkSharingDate:Lt.V})}),(0,C.jsx)("p",{children:n("to_keep_edit_access")})]}),(0,C.jsxs)(re.E9,{children:[(0,C.jsx)(w.A,{variant:"secondary",href:"/blog/changes-to-project-sharing",target:"_blank",rel:"noreferrer",onClick:()=>{(0,O._)("notification-click",{name:"link-sharing-collaborator-limit",button:"learn"})},children:n("learn_more")}),(0,C.jsx)(w.A,{variant:"primary",onClick:()=>{(0,O._)("notification-click",{name:"link-sharing-collaborator-limit",button:"ok"}),t()},children:n("ok")})]})]})}var It=n(83566);const Mt=()=>{const[e,t]=(0,x.useState)(!1),{isProjectOwner:n,permissionsLevel:r}=(0,de.mi)(),{members:i,features:s,_id:o}=(0,he.O)(),a=()=>{t(!1)};return(0,x.useEffect)((()=>{if(!(n||!s||"readOnly"===r)&&-1!==s.collaborators&&i.filter((e=>"readAndWrite"===e.privileges)).length>(s.collaborators??1)){const e=`last-shown-need-edit-modal.${o}`,n=It.A.getItem(e);(!n||n+864e5<Date.now())&&(t(!0),It.A.setItem(e,Date.now()),(0,O._)("notification-prompt",{name:"link-sharing-collaborator-limit"}))}}),[s,n,i,r,o]),e?(0,C.jsx)(re.Ay,{animation:!0,show:e,onHide:()=>{(0,O._)("notification-dismiss",{name:"link-sharing-collaborator-limit"}),a()},id:"editor-over-limit-modal",children:(0,C.jsx)(Dt,{handleHide:a})}):null};function Ot(e){let{handleHide:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(re.IK,{closeButton:!0,children:(0,C.jsx)(re.rA,{children:n("view_only_access")})}),(0,C.jsxs)(re.$8,{children:[(0,C.jsx)("p",{children:n("this_project_already_has_maximum_editors")}),(0,C.jsx)("p",{children:n("please_ask_the_project_owner_to_upgrade_more_editors")})]}),(0,C.jsxs)(re.E9,{children:[(0,C.jsx)(w.A,{variant:"secondary",href:"/blog/changes-to-project-sharing",target:"_blank",rel:"noreferrer",onClick:()=>{(0,O._)("notification-click",{name:"link-sharing-collaborator-limit",button:"learn"})},children:n("learn_more")}),(0,C.jsx)(w.A,{variant:"primary",onClick:()=>{(0,O._)("notification-click",{name:"link-sharing-collaborator-limit",button:"ok"}),t()},children:n("ok")})]})]})}const Bt=()=>{const[e,t]=(0,x.useState)(!1),{isProjectOwner:n,isPendingEditor:r,permissionsLevel:i}=(0,de.mi)(),{members:s,features:o,_id:a}=(0,he.O)(),l=()=>{t(!1)};return(0,x.useEffect)((()=>{if(!(n||!o)&&-1!==o.collaborators&&r){const e=`last-shown-view-only-access-modal.${a}`,n=It.A.getItem(e);(!n||n+6048e5<Date.now())&&(t(!0),It.A.setItem(e,Date.now()),(0,O._)("notification-prompt",{name:"link-sharing-collaborator-limit"}))}}),[o,n,r,s,i,a]),e?(0,C.jsx)(re.Ay,{animation:!0,show:e,onHide:()=>{(0,O._)("notification-dismiss",{name:"link-sharing-collaborator-limit"}),l()},id:"editor-over-limit-modal",children:(0,C.jsx)(Ot,{handleHide:l})}):null};const qt=function(){const[e,t]=(0,x.useState)(!1),{onlineUsersArray:n}=(0,I.E1)(),{openDoc:r}=(0,M.TS)(),i=(0,x.useCallback)((()=>{O.JY("ide-open-share-modal-once"),t(!0)}),[]),s=(0,x.useCallback)((()=>{t(!1)}),[]),o=(0,yt.A)("ol-linkSharingWarning");return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Ft,{onlineUsersArray:n,openDoc:r,openShareProjectModal:i}),o?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Mt,{}),(0,C.jsx)(Bt,{}),(0,C.jsx)(Tt.A,{show:e,handleOpen:i,handleHide:s})]}):(0,C.jsx)(Pt.A,{show:e,handleHide:s})]})};const $t=function(e){let{resetUnreadMessages:t,sendMessage:n}=e;const{t:r}=(0,_.Bd)();return(0,C.jsxs)("form",{className:"new-message",children:[(0,C.jsx)("label",{htmlFor:"chat-input",className:(0,Fe.q$)({bs3:"sr-only",bs5:"visually-hidden"}),children:r("your_message_to_collaborators")}),(0,C.jsx)("textarea",{id:"chat-input",placeholder:`${r("your_message_to_collaborators")}…`,onKeyDown:function(e){const t=e.nativeEvent.isComposing;if("Enter"===e.key&&!t){e.preventDefault();const t=e.target;n(t.value),window.setTimeout((()=>{t.blur(),t.closest("form")?.reset(),t.focus()}),0)}},onClick:t})]})};var zt=n(45250),Ut=n.n(zt);function Vt(e){let{atEnd:t,children:n,className:r="",fetchData:i,itemCount:s,isLoading:o}=e;const a=(0,x.useRef)(null),l=(0,x.useRef)(0);function c(){a.current.scrollTop=a.current.scrollHeight-a.current.clientHeight-l.current}return(0,x.useLayoutEffect)(c,[s]),(0,x.useEffect)((()=>{const e=Ut().debounce(c,400);return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,C.jsx)("div",{ref:a,onScroll:function(e){var n;n=a.current.scrollHeight-a.current.scrollTop-a.current.clientHeight,l.current=n,e.target===e.currentTarget&&function(){const e=a.current.children[0].clientHeight<a.current.clientHeight;return!(t||o||e)&&a.current.scrollTop<30}()&&i()},className:`infinite-scroll ${r}`,children:n})}Vt.propTypes={atEnd:le().bool,children:le().element.isRequired,className:le().string,fetchData:le().func.isRequired,itemCount:le().number.isRequired,isLoading:le().bool};const Ht=Vt;function ChatFallbackError(e){let{reconnect:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsx)("aside",{className:"chat",children:(0,C.jsxs)("div",{className:"chat-error",children:[(0,C.jsx)(v.A,{type:"error",content:n("chat_error")}),t&&(0,C.jsx)("p",{className:"text-center",children:(0,C.jsx)(w.A,{variant:"secondary",onClick:t,children:n("reconnect")})})]})})}ChatFallbackError.propTypes={reconnect:le().any};const Gt=ChatFallbackError,Kt=(0,x.lazy)((()=>Promise.all([n.e(4815),n.e(2212)]).then(n.bind(n,12212)))),Yt=()=>(0,C.jsx)(_e.e,{delay:500,className:(0,Fe.q$)({bs5:"pt-4"})}),Wt=x.memo((function(){const{t:e}=(0,_.Bd)(),{chatIsOpen:t}=(0,D.LV)(),n=(0,ue.ur)(),{status:r,messages:i,initialMessagesLoaded:s,atEnd:o,loadInitialMessages:a,loadMoreMessages:l,reset:c,sendMessage:d,markMessagesAsRead:u,error:p}=(0,Nt.vd)();(0,x.useEffect)((()=>{t&&!s&&a()}),[t,a,s]);const m="pending"!==r&&0===i.length,h=i.reduce(((e,t)=>{let{contents:n}=t;return e+n.length}),0),[f,g]=(0,x.useState)(t);if((0,x.useEffect)((()=>{t&&g(!0)}),[t]),p){if(p instanceof ge.fk)return(0,C.jsx)(Gt,{reconnect:c});throw p}return n&&f?(0,C.jsxs)("aside",{className:"chat",children:[(0,C.jsx)(Ht,{atEnd:o,className:"messages",fetchData:l,isLoading:"pending"===r,itemCount:h,children:(0,C.jsxs)("div",{children:[(0,C.jsx)("h2",{className:(0,Fe.q$)({bs3:"sr-only",bs5:"visually-hidden"}),children:e("chat")}),(0,C.jsxs)(x.Suspense,{fallback:(0,C.jsx)(Yt,{}),children:["pending"===r&&(0,C.jsx)(Yt,{}),m&&(0,C.jsx)(Qt,{}),(0,C.jsx)(Kt,{messages:i,userId:n.id,resetUnreadMessages:u})]})]})}),(0,C.jsx)($t,{resetUnreadMessages:u,sendMessage:d})]}):null}));function Qt(){const{t:e}=(0,_.Bd)();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"no-messages text-center small",children:e("no_messages")}),(0,C.jsxs)("div",{className:"first-message text-center",children:[e("send_first_message"),(0,C.jsx)("br",{}),(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"arrow-down"}),bs5:(0,C.jsx)(B.A,{type:"arrow_downward"})})]})]})}const Xt=(0,b.A)(Wt,Gt);function Zt(e){let{id:t,isOpen:n,setIsOpen:r,togglerType:i,tooltipWhenOpen:s,tooltipWhenClosed:o}=e;const a=n?s:o;return(0,C.jsx)(Ne.A,{id:t,description:a,overlayProps:{placement:"east"===i?"left":"right"},children:(0,C.jsx)("button",{className:P()("custom-toggler",`custom-toggler-${i}`,{"custom-toggler-open":n,"custom-toggler-closed":!n}),"aria-label":a,title:"",onClick:()=>r(!n)})})}function Jt(){return(0,C.jsx)("aside",{id:"history-file-tree",className:"ide-react-editor-sidebar history-file-tree"})}function en(e){const{t}=(0,_.Bd)();return(0,C.jsx)(F.TW,{...e,children:(0,C.jsx)("div",{className:P()("vertical-resize-handle",{"vertical-resize-handle-enabled":!e.disabled}),title:t("resize")})})}var tn=n(98125),nn=n(11787),rn=n(92902),sn=n(88588),on=(n(85100),n(27162),n(66403),n(94154),n(64777),n(38846),n(62896),n(95014)),an=n(52924),ln=n(97484),cn=n(81257),dn=n(3762),un=n(24480),pn=n(45186),mn=n(79550),hn=n(4816);const fn="ENTITY",gn=e=>{let{fileTreeContainer:t,children:n}=e;const r=(0,x.useMemo)((()=>({rootElement:t})),[t]);return(0,C.jsx)(an.Q,{backend:dn.t2,options:r,children:n})};function xn(e){const{t}=(0,_.Bd)(),{fileTreeData:n,fileTreeReadOnly:r}=(0,fe.Q)(),{selectedEntityIds:i,isRootFolderSelected:s}=(0,sn.G1)(),{finishMoving:o}=(0,rn.m)(),[a,l]=(0,x.useState)(!0),[,c,d]=(0,ln.i)({type:fn,item(){const r=function(e,t){return e.size>1&&e.has(t)?new Set(e):new Set([t])}(s?new Set:i,e),o=(0,mn.jr)(n,r);return{type:fn,title:bn(o,t),forbiddenFolderIds:_n(o),draggedEntityIds:r}},canDrag:()=>!r&&a,end(e,t){if(t.didDrop()){const n=t.getDropResult();n&&o(n.targetEntityId,e.draggedEntityIds)}}});return(0,x.useEffect)((()=>{d((0,un.n)())}),[d]),{dragRef:c,setIsDraggable:l}}function jn(e){const{setDroppedFiles:t,startUploadingDocOrFile:n}=(0,rn.m)(),[{isOver:r},i]=(0,cn.H)({accept:[fn,pn.FILE],canDrop:(t,n)=>!!n.isOver({shallow:!0})&&!(t.type===fn&&t.forbiddenFolderIds.has(e)),drop(r,i){if(!i.didDrop())return r.type===fn?{targetEntityId:e}:void(0,on.A)(r).then((e=>e.filter((e=>(0,hn.n)(e.name,e.relativePath))))).then((r=>{t({files:r,targetFolderId:e}),n()}))},collect:e=>({isOver:e.canDrop()})});return{dropRef:i,isOver:r}}function bn(e,t){if(1===e.size){return Array.from(e)[0].entity.name}return t("n_items",{count:e.size})}function _n(e){const t=Array.from(e).filter((e=>"folder"===e.type)).map((e=>e.entity)),n=new Set(t);return(0,mn.b_)(n)}const yn=e=>{let{refProviders:t,setRefProviderEnabled:n,setStartedFreeTrial:r,onSelect:i,fileTreeContainer:s,children:o}=e;return(0,C.jsx)(nn.r,{refProviders:t,setRefProviderEnabled:n,setStartedFreeTrial:r,children:(0,C.jsx)(sn.k2,{onSelect:i,children:(0,C.jsx)(rn.g,{children:(0,C.jsx)(gn,{fileTreeContainer:s,children:o})})})})};function vn(e){let{isOver:t,isDragging:n,item:r,clientOffset:i}=e;const s=(0,x.useRef)();return(0,C.jsx)("div",{ref:s,className:P()("dnd-draggable-preview-layer",{"dnd-droppable-hover":t}),children:n&&r?.title&&(0,C.jsx)("div",{style:Cn(i,s.current?.getBoundingClientRect()),children:(0,C.jsx)(wn,{title:r.title})})})}function wn(e){let{title:t}=e;return(0,C.jsx)("div",{className:"dnd-draggable-preview-item",children:t})}function Cn(e,t){if(!t||!e)return{display:"none"};const{x:n,y:r}=t,{x:i,y:s}=e,o=`translate(${i-n-15}px, ${s-r-15}px)`;return{transform:o,WebkitTransform:o}}vn.propTypes={isOver:le().bool.isRequired,isDragging:le().bool.isRequired,item:le().shape({title:le().string}),clientOffset:le().shape({x:le().number,y:le().number})},wn.propTypes={title:le().string.isRequired};const kn=vn;var An=n(88121),En=n(93045);function Sn(e){let{name:t,isSelected:n,setIsDraggable:r}=e;const{isRenaming:i,startRenaming:s,finishRenaming:o,error:a,cancel:l}=(0,rn.m)(),c=i&&n&&!a;return(0,x.useEffect)((()=>{r(!c)}),[r,c]),c?(0,C.jsx)(Rn,{initialValue:t,finishRenaming:o,cancel:l}):(0,C.jsx)(Nn,{name:t,isSelected:n,startRenaming:s})}function Nn(e){let{name:t,isSelected:n,startRenaming:r}=e;const[i,s]=(0,x.useState)(0);return(0,C.jsx)("button",{className:"item-name-button",onClick:function(){s(i+1),n||s(0)},onDoubleClick:function(){i<2||r()},children:(0,C.jsx)("span",{children:t})})}function Rn(e){let{initialValue:t,finishRenaming:n,cancel:r}=e;const[i,s]=(0,x.useState)(t),{autoFocusedRef:o}=(0,En.U)();return(0,C.jsx)("span",{className:"rename-input",children:(0,C.jsx)("input",{type:"text",value:i,onKeyDown:function(e){"Enter"===e.key&&n(i),"Escape"===e.key&&r()},onChange:function(e){s(e.target.value)},onBlur:function(){n(i)},onFocus:function(e){const t=e.target.value.lastIndexOf(".");e.target.setSelectionRange(0,t)},ref:o})})}Sn.propTypes={name:le().string.isRequired,isSelected:le().bool.isRequired,setIsDraggable:le().func.isRequired},Nn.propTypes={name:le().string.isRequired,startRenaming:le().func.isRequired,isSelected:le().bool.isRequired},Rn.propTypes={initialValue:le().string.isRequired,finishRenaming:le().func.isRequired,cancel:le().func.isRequired};const Fn=Sn;function Tn(e){let{id:t,name:n}=e;const{t:r}=(0,_.Bd)(),{contextMenuCoords:i,setContextMenuCoords:s}=(0,nn.e)(),o=(0,x.useRef)(),a=Boolean(i);return(0,C.jsx)("div",{className:"menu-button btn-group",children:(0,C.jsx)("button",{className:"entity-menu-toggle btn btn-sm",id:`menu-button-${t}`,onClick:function(e){if(e.stopPropagation(),i)s(null);else{const e=o.current.getBoundingClientRect();s({top:e.top+e.height/2,left:e.right})}},ref:o,"aria-haspopup":"true","aria-expanded":a,"aria-label":r("open_action_menu",{name:n}),children:(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"ellipsis-v",accessibilityLabel:r("menu")}),bs5:(0,C.jsx)(B.A,{type:"more_vert",accessibilityLabel:r("menu")})})})})}Tn.propTypes={id:le().string.isRequired,name:le().string.isRequired};const Pn=Tn;var Ln=n(5658);const Dn=function(e){let{id:t,name:n,type:r,isSelected:i,icons:s}=e;const{fileTreeReadOnly:o}=(0,fe.Q)(),{setContextMenuCoords:a}=(0,nn.e)(),{isRenaming:l}=(0,rn.m)(),{selectedEntityIds:c}=(0,sn.G1)(),d=!o&&i&&1===c.size,{dragRef:u,setIsDraggable:p}=xn(t),m=(0,Ln.u)().getMonitor().getItem(),h=(0,x.useRef)(null);return(0,x.useEffect)((()=>{const e=h.current;i&&e&&setTimeout((()=>{e&&(0,An.A)(e,{scrollMode:"if-needed"})}),100)}),[i,h]),(0,C.jsx)("div",{className:P()("entity",{"file-tree-entity-dragging":m?.draggedEntityIds?.has(t)}),role:"presentation",ref:u,draggable:!l,onContextMenu:function(e){e.preventDefault(),a({top:e.pageY,left:e.pageX})},"data-file-id":t,"data-file-type":r,children:(0,C.jsxs)("div",{className:"entity-name entity-name-react",role:"presentation",ref:h,children:[s,(0,C.jsx)(Fn,{name:n,isSelected:i,setIsDraggable:p}),d?(0,C.jsx)(Pn,{id:t,name:n}):null]})})};var In=n(66285);function Mn(e){let{name:t,id:n,isFile:r,isLinkedFile:i}=e;const s=r?"file":"doc",{isSelected:o,props:a}=(0,sn.hj)(n,s);return(0,C.jsx)("li",{role:"treeitem",...a,"aria-label":t,tabIndex:"0",children:(0,C.jsx)(Dn,{id:n,name:t,type:s,isSelected:o,icons:(0,C.jsx)(On,{isLinkedFile:i,name:t})})})}Mn.propTypes={name:le().string.isRequired,id:le().string.isRequired,isFile:le().bool,isLinkedFile:le().bool};const On=e=>{let{isLinkedFile:t,name:n}=e;const{t:r}=(0,_.Bd)(),i=P()("file-tree-icon",{"linked-file-icon":t});return(0,C.jsxs)(C.Fragment,{children:[" ",(0,C.jsx)(ce.A,{bs3:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(X.A,{type:(0,In.A)(n),fw:!0,className:i}),t&&(0,C.jsx)(X.A,{type:"external-link-square",modifier:"rotate-180",className:"linked-file-highlight",accessibilityLabel:r("linked_file")})]}),bs5:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(B.A,{type:(0,In.A)(n),className:i}),t&&(0,C.jsx)(B.A,{type:"open_in_new",modifier:"rotate-180",className:"linked-file-highlight",accessibilityLabel:r("linked_file")})]})})]})};On.propTypes={name:le().string.isRequired,isLinkedFile:le().bool};const Bn=Mn;var qn=n(42093);function $n(e){let{name:t,id:n,folders:r,docs:i,files:s}=e;const{t:o}=(0,_.Bd)(),{isSelected:a,props:l}=(0,sn.hj)(n,"folder"),{selectedEntityParentIds:c}=(0,sn.G1)(n),[d,u]=(0,qn.A)(`folder.${n}.expanded`,!1);function p(){u(!d)}(0,x.useEffect)((()=>{c.has(n)&&u(!0)}),[n,c,u]);const{isOver:m,dropRef:h}=jn(n),{isOver:f,dropRef:g}=jn(n),j=(0,C.jsx)(ce.A,{bs3:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("button",{onClick:p,"aria-label":o(d?"collapse":"expand"),children:(0,C.jsx)(X.A,{type:d?"angle-down":"angle-right",fw:!0,className:"file-tree-expand-icon"})}),(0,C.jsx)(X.A,{type:d?"folder-open":"folder",fw:!0,className:"file-tree-folder-icon"})]}),bs5:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("button",{onClick:p,"aria-label":o(d?"collapse":"expand"),children:(0,C.jsx)(B.A,{type:d?"expand_more":"chevron_right",className:"file-tree-expand-icon"})}),(0,C.jsx)(B.A,{type:d?"folder_open":"folder",className:"file-tree-folder-icon"})]})});return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("li",{role:"treeitem",...l,"aria-expanded":d,"aria-label":t,tabIndex:"0",ref:h,className:P()(l.className,{"dnd-droppable-hover":m||f}),children:(0,C.jsx)(Dn,{id:n,name:t,type:"folder",isSelected:a,icons:j})}),d?(0,C.jsx)(Gn,{folders:r,docs:i,files:s,dropRef:g}):null]})}$n.propTypes={name:le().string.isRequired,id:le().string.isRequired,folders:le().array.isRequired,docs:le().array.isRequired,files:le().array.isRequired};const zn=$n;var Un=n(88091);function Vn(e){let{folders:t,docs:n,files:r,classes:i={},dropRef:s=null,children:o,dataTestId:a}=e;r=r.map((e=>({...e,isFile:!0})));const l=[...n,...r];return(0,C.jsxs)("ul",{className:P()("list-unstyled",i.root),role:"tree",ref:s,"data-testid":a,children:[t.sort(Hn).map((e=>(0,C.jsx)(zn,{name:e.name,id:e._id,folders:e.folders,docs:e.docs,files:e.fileRefs},e._id))),l.sort(Hn).map((e=>(0,C.jsx)(Bn,{name:e.name,id:e._id,isFile:e.isFile,isLinkedFile:e.linkedFileData&&!!e.linkedFileData.provider},e._id))),o]})}function Hn(e,t){return Un.h.compare(e.name,t.name)}Vn.propTypes={folders:le().array.isRequired,docs:le().array.isRequired,files:le().array.isRequired,classes:le().exact({root:le().string}),dropRef:le().func,children:le().node,dataTestId:le().string};const Gn=Vn;var Kn=n(98509);function Yn(){const{t:e}=(0,_.Bd)(),{canCreate:t,startCreatingFolder:n,startCreatingDocOrFile:r,startUploadingDocOrFile:i}=(0,rn.m)();return t?(0,C.jsxs)("div",{className:"toolbar-left",children:[(0,C.jsx)(Ne.A,{id:"new-file",description:e("new_file"),overlayProps:{placement:"bottom"},children:(0,C.jsx)("button",{className:"btn",onClick:()=>{O._("new-file-click",{location:"toolbar"}),r()},children:(0,C.jsx)(ce.A,{bs5:(0,C.jsx)(B.A,{type:"description",accessibilityLabel:e("new_file")}),bs3:(0,C.jsx)(X.A,{type:"file",fw:!0,accessibilityLabel:e("new_file")})})})}),(0,C.jsx)(Ne.A,{id:"new-folder",description:e("new_folder"),overlayProps:{placement:"bottom"},children:(0,C.jsx)("button",{className:"btn",onClick:n,tabIndex:-1,children:(0,C.jsx)(ce.A,{bs5:(0,C.jsx)(B.A,{type:"folder",accessibilityLabel:e("new_folder")}),bs3:(0,C.jsx)(X.A,{type:"folder",fw:!0,accessibilityLabel:e("new_folder")})})})}),(0,C.jsx)(Ne.A,{id:"upload",description:e("upload"),overlayProps:{placement:"bottom"},children:(0,C.jsx)("button",{className:"btn",onClick:()=>{O._("upload-click",{location:"toolbar"}),i()},tabIndex:-1,children:(0,C.jsx)(ce.A,{bs5:(0,C.jsx)(B.A,{type:"upload",accessibilityLabel:e("upload")}),bs3:(0,C.jsx)(X.A,{type:"upload",fw:!0,accessibilityLabel:e("upload")})})})})]}):null}function Wn(){const{t:e}=(0,_.Bd)(),{canRename:t,canDelete:n,startRenaming:r,startDeleting:i}=(0,rn.m)();return t||n?(0,C.jsxs)("div",{className:"toolbar-right",children:[t?(0,C.jsx)(Ne.A,{id:"rename",description:e("rename"),overlayProps:{placement:"bottom"},children:(0,C.jsx)("button",{className:"btn",onClick:r,tabIndex:-1,children:(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"pencil",fw:!0,accessibilityLabel:e("rename")}),bs5:(0,C.jsx)(B.A,{type:"edit",accessibilityLabel:e("rename")})})})}):null,n?(0,C.jsx)(Ne.A,{id:"delete",description:e("delete"),overlayProps:{placement:"bottom"},children:(0,C.jsx)("button",{className:"btn",onClick:i,tabIndex:-1,children:(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"trash-o",fw:!0,accessibilityLabel:e("delete")}),bs5:(0,C.jsx)(B.A,{type:"delete",accessibilityLabel:e("delete")})})})}):null]}):null}const Qn=function(){const{fileTreeReadOnly:e}=(0,fe.Q)(),{t}=(0,_.Bd)();return e?null:(0,C.jsxs)(Kn.A,{className:"toolbar toolbar-filetree","aria-label":t("project_files"),children:[(0,C.jsx)(Yn,{}),(0,C.jsx)(Wn,{})]})};const Xn=function(){const{t:e}=(0,_.Bd)(),{isDeleting:t,inFlight:n,finishDeleting:r,actionedEntities:i,cancel:s,error:o}=(0,rn.m)();if(!t)return null;function a(){s()}return(0,C.jsxs)(re.Ay,{show:!0,onHide:a,children:[(0,C.jsx)(re.IK,{children:(0,C.jsx)(re.rA,{children:e("delete")})}),(0,C.jsxs)(re.$8,{children:[(0,C.jsx)("p",{children:e("sure_you_want_to_delete")}),(0,C.jsx)("ul",{children:i.map((e=>(0,C.jsx)("li",{children:e.name},e._id)))}),o&&(0,C.jsx)(v.A,{type:"error",content:e("generic_something_went_wrong")})]}),(0,C.jsx)(re.E9,{children:n?(0,C.jsx)(w.A,{variant:"danger",disabled:!0,isLoading:!0,bs3Props:{loading:`${e("deleting")}…`}}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(w.A,{variant:"secondary",onClick:a,children:e("cancel")}),(0,C.jsx)(w.A,{variant:"danger",onClick:function(){r()},children:e("delete")})]})})]})};var Zn=n(27916),Jn=n(67227);function er(e){let{name:t,setName:n,validName:r,setValidName:i,handleCreateFolder:s}=e;const{autoFocusedRef:o}=(0,En.U)();return(0,C.jsx)("input",{ref:o,className:"form-control",type:"text",value:t,onKeyDown:function(e){"Enter"===e.key&&r&&s()},onChange:function(e){i((0,Jn.tL)(e.target.value.trim())),n(e.target.value)},onFocus:function(e){e.target.setSelectionRange(0,-1)}})}er.propTypes={name:le().string.isRequired,setName:le().func.isRequired,validName:le().bool.isRequired,setValidName:le().func.isRequired,handleCreateFolder:le().func.isRequired};const tr=function(){const{t:e}=(0,_.Bd)(),[t,n]=(0,x.useState)(""),[r,i]=(0,x.useState)(!0),{isCreatingFolder:s,inFlight:o,finishCreatingFolder:a,cancel:l,error:c}=(0,rn.m)();if((0,x.useEffect)((()=>{s||n("")}),[s]),!s)return null;function d(){l()}function u(){a(t)}function p(){return c.constructor===Zn.Lc?e("file_already_exists"):e("generic_something_went_wrong")}return(0,C.jsxs)(re.Ay,{show:!0,onHide:d,children:[(0,C.jsx)(re.IK,{children:(0,C.jsx)(re.rA,{children:e("new_folder")})}),(0,C.jsxs)(re.$8,{children:[(0,C.jsx)(er,{name:t,setName:n,validName:r,setValidName:i,handleCreateFolder:u}),r?null:(0,C.jsx)("div",{role:"alert","aria-label":e("files_cannot_include_invalid_characters"),className:"alert alert-danger file-tree-modal-alert",children:e("files_cannot_include_invalid_characters")}),c?(0,C.jsx)("div",{role:"alert","aria-label":p(),className:"alert alert-danger file-tree-modal-alert",children:p()}):null]}),(0,C.jsx)(re.E9,{children:o?(0,C.jsx)(w.A,{variant:"primary",disabled:!0,isLoading:o,bs3Props:{loading:`${e("creating")}…`}}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(w.A,{variant:"secondary",onClick:d,children:e("cancel")}),(0,C.jsx)(w.A,{variant:"primary",onClick:u,disabled:!r,children:e("create")})]})})]})};const nr=function FileTreeModalError(){const{t:e}=(0,_.Bd)(),{isRenaming:t,isMoving:n,cancel:r,error:i}=(0,rn.m)();if(!i)return null;if(!t&&!n)return null;function s(){r()}function o(){switch(i.constructor){case Zn.Lc:return e("file_already_exists");case Zn.ui:return(0,C.jsx)(_.x6,{i18nKey:"file_already_exists_in_this_location",components:[(0,C.jsx)("strong",{})],values:{fileName:i.entityName},shouldUnescape:!0,tOptions:{interpolation:{escapeValue:!0}}});case Zn.di:return e("files_cannot_include_invalid_characters");case Zn.yG:return e("blocked_filename");default:return e("generic_something_went_wrong")}}return(0,C.jsxs)(re.Ay,{show:!0,onHide:s,children:[(0,C.jsx)(re.IK,{children:(0,C.jsx)(re.rA,{children:function(){switch(i.constructor){case Zn.Lc:case Zn.ui:return e("duplicate_file");case Zn.di:case Zn.yG:return e("invalid_file_name");default:return e("error")}}()})}),(0,C.jsx)(re.$8,{children:(0,C.jsx)("div",{role:"alert","aria-label":o(),children:o()})}),(0,C.jsx)(re.E9,{children:(0,C.jsx)(w.A,{onClick:s,variant:"primary",children:e("ok")})})]})};const rr=function(){const{t:e}=(0,_.Bd)(),{canRename:t,canDelete:n,canCreate:r,startRenaming:i,startDeleting:s,startCreatingFolder:o,startCreatingDocOrFile:a,startUploadingDocOrFile:l,downloadPath:c,selectedFileName:d}=(0,rn.m)(),{owner:u}=(0,he.O)(),p=(0,x.useCallback)((()=>{d?.endsWith(".bib")&&O._("download-bib-file",{projectOwner:u._id})}),[d,u]),m=(0,x.useCallback)((()=>{O._("new-file-click",{location:"file-menu"}),a()}),[a]),h=(0,x.useCallback)((()=>{O._("upload-click",{location:"file-menu"}),l()}),[l]);return(0,C.jsx)(ce.A,{bs3:(0,C.jsxs)(C.Fragment,{children:[t?(0,C.jsx)(Ie.A,{onClick:i,children:e("rename")}):null,c?(0,C.jsx)(Ie.A,{href:c,onClick:p,download:d,children:e("download")}):null,n?(0,C.jsx)(Ie.A,{onClick:s,children:e("delete")}):null,r?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("li",{role:"none",className:"divider"}),(0,C.jsx)(Ie.A,{onClick:m,children:e("new_file")}),(0,C.jsx)(Ie.A,{onClick:o,children:e("new_folder")}),(0,C.jsx)(Ie.A,{onClick:h,children:e("upload")})]}):null]}),bs5:(0,C.jsxs)(C.Fragment,{children:[t?(0,C.jsx)("li",{role:"none",children:(0,C.jsx)(Be.tJ,{onClick:i,children:e("rename")})}):null,c?(0,C.jsx)("li",{role:"none",children:(0,C.jsx)(Be.tJ,{href:c,onClick:p,download:d,children:e("download")})}):null,n?(0,C.jsx)("li",{role:"none",children:(0,C.jsx)(Be.tJ,{onClick:s,children:e("delete")})}):null,r?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Be.rx,{role:"none"}),(0,C.jsx)("li",{role:"none",children:(0,C.jsx)(Be.tJ,{onClick:m,children:e("new_file")})}),(0,C.jsx)("li",{role:"none",children:(0,C.jsx)(Be.tJ,{onClick:o,children:e("new_folder")})}),(0,C.jsx)("li",{role:"none",children:(0,C.jsx)(Be.tJ,{onClick:h,children:e("upload")})})]}):null]})})};const ir=x.forwardRef(((e,t)=>{let{bsRole:n}=e;return null}));ir.displayName="FakeDropDownToggle";const sr=function(){const{fileTreeReadOnly:e}=(0,fe.Q)(),{contextMenuCoords:t,setContextMenuCoords:n}=(0,nn.e)(),r=(0,x.useRef)(null);if((0,x.useEffect)((()=>{t&&(r.current=document.querySelector(".entity-menu-toggle"),function(){const e=document.querySelector('[aria-labelledby="dropdown-file-tree-context-menu"]');e?.focus()}())}),[t]),!t||e)return null;function i(){n(null),r.current&&r.current.focus()}function s(e){e||i()}function o(e){"Tab"===e.key&&i()}return g.createPortal((0,C.jsx)(ce.A,{bs3:(0,C.jsxs)(Me.A,{onClick:function(){s(!1)},open:!0,id:"dropdown-file-tree-context-menu",onToggle:s,dropup:document.body.offsetHeight/t.top<2&&document.body.offsetHeight-t.top<250,className:"context-menu",style:t,onKeyDown:o,children:[(0,C.jsx)(ir,{bsRole:"toggle"}),(0,C.jsx)(Me.A.Menu,{tabIndex:-1,children:(0,C.jsx)(rr,{})})]}),bs5:(0,C.jsx)("div",{style:t,className:"context-menu",children:(0,C.jsx)(Be.ms,{show:!0,drop:document.body.offsetHeight/t.top<2&&document.body.offsetHeight-t.top<250?"up":"down",focusFirstItemOnShow:!0,onKeyDown:o,onToggle:s,children:(0,C.jsx)(Be.rI,{className:"dropdown-menu-sm-width",id:"dropdown-file-tree-context-menu",children:(0,C.jsx)(rr,{})})})})}),document.body)};var or=n(89753);const ar=function FileTreeError(){const{t:e}=(0,_.Bd)(),{reload:t}=(0,or.z)();return(0,C.jsxs)("div",{className:"file-tree-error",children:[(0,C.jsx)("p",{children:e("generic_something_went_wrong")}),(0,C.jsx)("p",{children:e("please_refresh")}),(0,C.jsx)(w.A,{variant:"primary",onClick:t,children:e("refresh")})]})};const lr=(0,x.createContext)(void 0),cr=()=>{const e=(0,x.useContext)(lr);if(!e)throw new Error("useFileTreeCreateForm is only available inside FileTreeCreateFormProvider");return e},dr=e=>{let{children:t}=e;const[n,r]=(0,x.useState)(!1);return(0,C.jsx)(lr.Provider,{value:{valid:n,setValid:r},children:t})};function ur(e){let{mode:t,icon:n,label:r}=e;const{newFileCreateMode:i,startCreatingFile:s}=(0,rn.m)();return(0,C.jsx)("li",{className:P()({active:i===t}),children:(0,C.jsxs)(w.A,{variant:"link",onClick:()=>{s(t),O._("file-modal-click",{method:t})},className:"modal-new-file-mode",children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:n,fw:!0}),bs5:(0,C.jsx)(B.A,{type:n})})," ",r]})})}ur.propTypes={mode:le().string.isRequired,icon:le().string.isRequired,label:le().string.isRequired};const pr=(0,x.createContext)(void 0),mr=()=>{const e=(0,x.useContext)(pr);if(!e)throw new Error("useFileTreeCreateName is only available inside FileTreeCreateNameProvider");return e},hr=e=>{let{children:t,initialName:n=""}=e;const[r,i]=(0,x.useReducer)(((e,t)=>({name:t,touchedName:!0})),{name:n,touchedName:!1}),s=(0,x.useMemo)((()=>(0,Jn.tL)(r.name.trim())),[r]);return(0,C.jsx)(pr.Provider,{value:{...r,setName:i,validName:s},children:t})};var fr=n(18730),gr=n(11456),xr=n(96700);function jr(e){let{label:t,focusName:n=!1,classes:r={},placeholder:i,error:s,inFlight:o}=e;const{t:a}=(0,_.Bd)(),{name:l,setName:c,touchedName:d,validName:u}=mr(),p=(0,x.useRef)(null);return(0,x.useEffect)((()=>{p.current&&n&&window.requestAnimationFrame((()=>{p.current&&(p.current.focus(),p.current.setSelectionRange(0,p.current.value.lastIndexOf(".")))}))}),[n]),(0,C.jsxs)(gr.A,{controlId:"new-doc-name",className:r.formGroup,children:[(0,C.jsx)(xr.A,{children:t||a("file_name")}),(0,C.jsx)(pt.A,{type:"text",placeholder:i||a("file_name"),required:!0,value:l,onChange:e=>c(e.target.value),ref:p,disabled:o}),d&&!u&&(0,C.jsx)(v.A,{type:"error",className:"row-spaced-small",content:a("files_cannot_include_invalid_characters")}),s&&(0,C.jsx)(br,{error:s})]})}function br(e){let{error:t}=e;const{t:n}=(0,_.Bd)();switch(t.constructor){case Zn.Lc:return(0,C.jsx)(v.A,{type:"error",className:"row-spaced-small",content:n("file_already_exists")});case Zn.di:return(0,C.jsx)(v.A,{type:"error",className:"row-spaced-small",content:n("files_cannot_include_invalid_characters")});case Zn.yG:return(0,C.jsx)(v.A,{type:"error",className:"row-spaced-small",content:n("blocked_filename")});default:return null}}jr.propTypes={focusName:le().bool,label:le().string,classes:le().shape({formGroup:le().string}),placeholder:le().string,error:le().oneOfType([le().object,le().string]),inFlight:le().bool.isRequired},br.propTypes={error:le().oneOfType([le().object,le().string]).isRequired};var _r=n(60718),yr=n(80124),vr=n(4607),wr=n(85868);function Cr(e){let{provider:t,data:n,selectedGroupId:r,setSelectedGroupId:i}=e;const{t:s}=(0,_.Bd)();switch(t){case"mendeley":return(0,C.jsxs)(gr.A,{controlId:"group-select",children:[(0,C.jsx)(xr.A,{children:s("select_a_group_optional")}),(0,C.jsxs)(pt.A,{as:wr.A,placeholder:s("select_a_group_optional"),value:r||"",onChange:e=>i(e.target.value),children:[(0,C.jsxs)("option",{disabled:!0,value:"",children:["- ",s("select_a_group_optional")]}),n.map((e=>(0,C.jsx)("option",{value:e.id,children:e.name},e.id)))]})]});case"papers":return(0,C.jsxs)(gr.A,{controlId:"group-select",children:[(0,C.jsx)(xr.A,{children:s("library")}),(0,C.jsxs)(pt.A,{as:wr.A,required:!0,value:r||"",onChange:e=>i(e.target.value),children:[(0,C.jsx)("option",{disabled:!0,value:"",children:s("select_a_library")}),n.map((e=>(0,C.jsx)("option",{value:e.id,children:e.name??s("personal_library")},e.id)))]})]});case"zotero":return(0,C.jsxs)(gr.A,{controlId:"group-select",children:[(0,C.jsx)(xr.A,{children:s("library")}),(0,C.jsxs)(pt.A,{as:wr.A,value:r||"",onChange:e=>i(e.target.value),children:[(0,C.jsx)("option",{value:"",children:s("my_library")}),(0,C.jsx)("option",{disabled:!0,value:"_",children:s("group_libraries")}),n.map((e=>(0,C.jsx)("option",{value:e.id,children:e.name},e.id)))]})]});default:throw new Error(`Unknown reference provider "${t}"`)}}Cr.propTypes={provider:le().string.isRequired,data:le().arrayOf(le().object).isRequired,selectedGroupId:le().string,setSelectedGroupId:le().func.isRequired};var kr=n(13653),Ar=n(17112),Er=n(94012);function Sr(e){let{provider:t,providerName:n,supportsGroups:r=!1,supportsFormat:i=!1,separatePersonalLibrary:s=!0}=e;const{t:o}=(0,_.Bd)(),{name:a,validName:l}=mr(),{setValid:c}=cr(),{features:d}=(0,ue.ur)(),{refProviders:u,setStartedFreeTrial:p,setRefProviderEnabled:m}=(0,nn.e)(),{error:h,finishCreatingLinkedFile:f,inFlight:g}=(0,rn.m)(),{indexAllReferences:j}=(0,Er.B4)(),[b,y]=(0,x.useState)(""),[k,A]=(0,x.useState)("bibtex");(0,kr.Q)((0,x.useCallback)((e=>{e.refProviders&&t in e.refProviders&&(m(t,!1),window.setTimeout((()=>{m(t,e.refProviders[t])})))}),[t,m]));const E=d?.references||d?.[t]||!1,S=E&&u[t],N=(0,x.useCallback)((()=>{O._("link-integration-click",{integration:t,location:"Editor"}),window.open(`/${t}/oauth`,"reference-auth","width=700,height=500")}),[t]),R=(0,fr.J)(t,r&&S),F=s||""!==b;(0,x.useEffect)((()=>{c(l&&S&&!R.error&&F)}),[c,l,S,R.error,F]);const T=(0,x.useCallback)((e=>{e.preventDefault();const n={};b&&(n.group_id=b),i&&(n.format=k),f({name:a,provider:t,data:n}).then((()=>{j(!0)})),O._("new-file-created",{method:t,extension:a.split(".").length>1?a.split(".").pop():""})}),[a,b,t,f,k,j,i]),P=(0,Ar.u)("paywall-cta"),L=(0,Ar.u)("write-and-cite");return E?(0,C.jsxs)("div",{className:"referencesImportModal",children:[S?(0,C.jsxs)("div",{children:[R.loading?(0,C.jsx)("div",{children:(0,C.jsx)("h2",{className:"text-center mt-4",children:(0,C.jsxs)("small",{children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"spinner",spin:!0}),bs5:(0,C.jsx)(Oe.A,{animation:"border","aria-hidden":"true",role:"status",className:"align-bottom"})})," ",o("loading"),"…"]})})}):(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{children:o("import_a_bibtex_file_from_your_provider_account",{provider:n})}),(0,C.jsxs)("form",{noValidate:!0,id:"create-file",onSubmit:T,children:[R.error&&(0,C.jsx)(Rr,{provider:t,error:R.error,linkAccount:N}),R.data&&R.data.length>0&&(0,C.jsx)("div",{className:"row-spaced-small",children:(0,C.jsx)(Cr,{provider:t,data:R.data,selectedGroupId:b,setSelectedGroupId:y})}),(0,C.jsx)("div",{className:"row-spaced-small",children:(0,C.jsx)(jr,{label:o("file_name_in_this_project"),focusName:!0,error:h,inFlight:g})}),i&&(0,C.jsx)("div",{className:"row-spaced-small",children:(0,C.jsxs)(gr.A,{controlId:"format",children:[(0,C.jsx)(xr.A,{children:o("format")}),(0,C.jsxs)(wr.A,{value:k,onChange:e=>A(e.target.value),children:[(0,C.jsx)("option",{value:"bibtex",children:"BibTeX"}),(0,C.jsx)("option",{value:"biblatex",children:"BibLaTeX"})]})]})})]})]}),g&&(0,C.jsx)("h3",{className:"text-center mt-4",children:(0,C.jsxs)("small",{children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"spinner",spin:!0}),bs5:(0,C.jsx)(Oe.A,{animation:"border","aria-hidden":"true",role:"status",className:"align-bottom"})})," ",o("importing"),"…"]})})]}):(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{children:L?Nr[t].dynamic_sync_description(o):Nr[t].sync_description(o)}),(0,C.jsx)("p",{children:(0,C.jsx)(w.A,{type:"button",onClick:N,children:Nr[t].link_to(o)})})]}),h&&(0,C.jsx)(C.Fragment,{children:"string"==typeof h?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)("div",{className:"text-center",children:[(0,C.jsx)("hr",{}),(0,C.jsx)(Rr,{error:h,provider:t,linkAccount:N})]}),(0,C.jsx)(Tr,{error:h,provider:t,linkAccount:N})]}):h.data?.relink?(0,C.jsx)(Fr,{provider:t,linkAccount:N}):(0,C.jsx)(_r.A,{error:h})})]}):(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{className:"small",children:L?Nr[t].dynamic_sync_description(o):Nr[t].sync_description(o)}),(0,C.jsx)(v.A,{type:"info",content:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("p",{children:Nr[t].is_premium(o)}),(0,C.jsx)("p",{children:(0,C.jsx)(vr.A,{source:t,handleClick:()=>p(!0),children:P?Nr[t].cta(o):o("start_free_trial")})})]})})]})}const Nr={mendeley:{default:e=>e("mendeley_reference_loading_error"),expired:e=>e("mendeley_reference_loading_error_expired"),forbidden:e=>e("mendeley_reference_loading_error_forbidden"),"refresh-failed":e=>e("mendeley_reference_loading_error_expired"),sync_description:e=>e("mendeley_sync_description"),dynamic_sync_description:e=>e("mendeley_dynamic_sync_description"),link_to:e=>e("link_to_mendeley"),is_premium:e=>e("mendeley_is_premium"),loading_groups:e=>e("mendeley_groups_loading_error"),relink:e=>e("mendeley_groups_relink"),cta:e=>e("mendeley_cta")},papers:{default:e=>e("papers_reference_loading_error"),expired:e=>e("papers_reference_loading_error_expired"),forbidden:e=>e("papers_reference_loading_error_forbidden"),"refresh-failed":e=>e("papers_reference_loading_error_expired"),sync_description:e=>e("papers_sync_description"),dynamic_sync_description:e=>e("papers_dynamic_sync_description"),link_to:e=>e("link_to_papers"),is_premium:e=>e("papers_is_premium"),loading_groups:e=>e("papers_groups_loading_error"),relink:e=>e("papers_groups_relink"),cta:e=>e("papers_cta")},zotero:{default:e=>e("zotero_reference_loading_error"),expired:e=>e("zotero_reference_loading_error_expired"),forbidden:e=>e("zotero_reference_loading_error_forbidden"),"refresh-failed":e=>e("zotero_reference_loading_error_expired"),sync_description:e=>e("zotero_sync_description"),dynamic_sync_description:e=>e("zotero_dynamic_sync_description"),link_to:e=>e("link_to_zotero"),is_premium:e=>e("zotero_is_premium"),loading_groups:e=>e("zotero_groups_loading_error"),relink:e=>e("zotero_groups_relink"),cta:e=>e("zotero_cta")}};function Rr(e){let{provider:t,error:n,linkAccount:r}=e;const{t:i}=(0,_.Bd)();return"relink"===n?(0,C.jsx)(Fr,{provider:t,linkAccount:r}):n in Nr[t]?(0,C.jsx)(yr.A,{children:Nr[t][n](i)}):(0,C.jsx)(_r.A,{error:n})}function Fr(e){let{provider:t,linkAccount:n}=e;const{t:r}=(0,_.Bd)();return(0,C.jsxs)(yr.A,{children:[(0,C.jsx)("div",{children:Nr[t].relink(r)}),(0,C.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:10},children:(0,C.jsx)(w.A,{variant:"danger",type:"button",onClick:n,children:r("relink_your_account")})})]})}function Tr(e){let{error:t,provider:n,linkAccount:r}=e;const{t:i}=(0,_.Bd)(),s=(0,Ar.u)("write-and-cite");switch(t){case"refresh-failed":return(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{children:s?Nr[n].dynamic_sync_description(i):Nr[n].sync_description(i)}),(0,C.jsx)("p",{children:(0,C.jsx)(w.A,{type:"button",onClick:r,children:Nr[n].link_to(i)})})]});case"default":case"expired":case"forbidden":return(0,C.jsxs)("div",{children:[(0,C.jsxs)("div",{children:[i("reference_error_relink_hint"),"  "]}),(0,C.jsx)("div",{children:(0,C.jsx)("a",{href:"/user/settings",target:"_blank",rel:"noopener",style:{fontWeight:"bold"},children:i("account_settings")})})]});default:return null}}function Pr(){const{t:e}=(0,_.Bd)();return(0,C.jsx)(ur,{mode:"mendeley",icon:(0,Fe.q$)({bs5:"menu_book",bs3:"book"}),label:e("from_provider",{provider:"Mendeley"})})}function Lr(){const{newFileCreateMode:e}=(0,rn.m)();return"mendeley"!==e?null:(0,C.jsx)(hr,{initialName:"references.bib",children:(0,C.jsx)(Sr,{provider:"mendeley",providerName:"Mendeley",supportsGroups:!0})})}function Dr(){const{t:e}=(0,_.Bd)();return(0,Ar.u)("papers-integration")?(0,C.jsx)(ur,{mode:"papers",icon:(0,Fe.q$)({bs5:"menu_book",bs3:"book"}),label:e("from_provider",{provider:"Papers"})}):null}function Ir(){const{newFileCreateMode:e}=(0,rn.m)();return(0,Ar.u)("papers-integration")?"papers"!==e?null:(0,C.jsx)(hr,{initialName:"references.bib",children:(0,C.jsx)(Sr,{provider:"papers",providerName:"Papers",separatePersonalLibrary:!1,supportsGroups:!0})}):null}function Mr(){const{t:e}=(0,_.Bd)();return(0,C.jsx)(ur,{mode:"zotero",icon:(0,Fe.q$)({bs5:"menu_book",bs3:"book"}),label:e("from_provider",{provider:"Zotero"})})}function Or(){const{newFileCreateMode:e}=(0,rn.m)();return"zotero"!==e?null:(0,C.jsx)(hr,{initialName:"references.bib",children:(0,C.jsx)(Sr,{provider:"zotero",providerName:"Zotero",supportsGroups:!0,supportsFormat:!0})})}var Br=n(35447),qr=n(79953);const $r=e=>{let{onDismiss:t,handleLearnMore:n,handleFreeTrialClick:r}=e;const{t:i}=(0,_.Bd)(),s=(0,C.jsxs)("div",{children:[(0,C.jsx)(vr.A,{source:"create-bib-file-upgrade-prompt",handleClick:r,children:i("upgrade")}),(0,C.jsx)(w.A,{variant:"ghost",bs3Props:{className:"btn-bg-ghost"},href:"/learn/how-to/How_to_link_your_Overleaf_account_to_Mendeley_and_Zotero",target:"blank",onClick:n,children:i("learn_more")})]}),o=(0,C.jsx)("div",{children:i("easily_import_and_sync_your_references")}),a=(0,C.jsx)("img",{src:"/img/third-party-references/book-illlustration.svg","aria-hidden":"true",alt:"better bibliographies",width:64,height:64});return(0,C.jsx)("div",{className:(0,Fe.q$)({bs3:"hidden-sm",bs5:"d-none d-lg-block"}),children:(0,C.jsx)(qr.A,{type:"offer",action:s,isDismissible:!0,isActionBelowContent:!0,customIcon:a,title:i("adding_a_bibliography"),content:o,onDismiss:t})})},zr="bib-file-tpr-prompt",Ur={location:"create-bib-file-upgrade-prompt",name:zr},Vr=()=>{const{splitTestVariants:e}=(0,Ar.d1)(),{allowedFreeTrial:t,features:n}=(0,ue.ur)(),{inactiveTutorials:r}=(0,de.mi)(),{completeTutorial:i,dismissTutorial:s,tryShowingPopup:o,showPopup:a,clearAndShow:l}=(0,Br.s)(zr,Ur);(0,x.useEffect)((()=>{const i="new-bib-file"===e["bib-file-tpr-prompt"],s=r.includes(zr);if(i&&(t&&!(n?.mendeley||n?.zotero))&&!s){o("reference-manager-prompt-view")||l("reference-manager-prompt-view")}}),[l,o,t,n,r,e]);const c=(0,x.useCallback)((()=>i({event:"promo-click",action:"complete",button:"Upgrade"})),[i]),d=(0,x.useCallback)((()=>O._("promo-click",{...Ur,button:"Learn more"})),[]);return a?(0,C.jsx)($r,{handleFreeTrialClick:c,handleLearnMore:d,onDismiss:s}):null},Hr=(0,x.memo)(Vr),Gr=[{import:c,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/promotions/new-bib-file-prompt"}];function Kr(){const{name:e,validName:t}=mr(),{setValid:n}=cr(),{error:r,finishCreatingDoc:i,inFlight:s}=(0,rn.m)();(0,x.useEffect)((()=>{n(t)}),[n,t]);const o=(0,x.useCallback)((t=>{t.preventDefault(),i({name:e}),O._("new-file-created",{method:"doc",extension:e.split(".").length>1?e.split(".").pop():""})}),[i,e]);return(0,C.jsxs)("form",{noValidate:!0,id:"create-file",onSubmit:o,children:[(0,C.jsx)(jr,{focusName:!0,error:r,inFlight:s}),r&&(0,C.jsx)(_r.A,{error:r}),Gr.map((e=>{let{import:{default:t},path:n}=e;return(0,C.jsx)(t,{},n)}))]})}function Yr(){const{t:e}=(0,_.Bd)(),{name:t,setName:n,validName:r}=mr(),{setValid:i}=cr(),{finishCreatingLinkedFile:s,error:o,inFlight:a}=(0,rn.m)(),[l,c]=(0,x.useState)(""),d=(0,x.useCallback)((e=>{c(e.target.value)}),[]);(0,x.useEffect)((()=>{if(l){const e=l.match(/^\s*https?:\/\/.+\/([^/]+\.(\w+))\s*$/);n(e?e[1]:"")}}),[n,l]),(0,x.useEffect)((()=>{i(r&&!!l)}),[i,r,l]);return(0,C.jsxs)("form",{className:"form-controls",id:"create-file",noValidate:!0,onSubmit:e=>{e.preventDefault(),O._("new-file-created",{method:"url",extension:t.split(".").length>1?t.split(".").pop():""}),s({name:t,provider:"url",data:{url:l.trim()}})},children:[(0,C.jsxs)(gr.A,{controlId:"import-from-url",children:[(0,C.jsx)(xr.A,{children:e("url_to_fetch_the_file_from")}),(0,C.jsx)(pt.A,{type:"url",placeholder:"https://example.com/my-file.png",required:!0,value:l,onChange:d})]}),(0,C.jsx)(jr,{label:e("file_name_in_this_project"),placeholder:"my_file",error:o,inFlight:a}),o&&(0,C.jsx)(_r.A,{error:o})]})}var Wr=n(45524),Qr=n(4941),Xr=n(87833),Zr=n(1705);function Jr(){const{t:e}=(0,_.Bd)(),{hasLinkedProjectFileFeature:t,hasLinkedProjectOutputFileFeature:n}=(0,yt.A)("ol-ExposedSettings"),r=t&&n,{name:i,setName:s,validName:o}=mr(),{setValid:a}=cr(),{error:l,finishCreatingLinkedFile:c,inFlight:d}=(0,rn.m)(),[u,p]=(0,x.useState)(),[m,h]=(0,x.useState)(),[f,g]=(0,x.useState)(),[j,b]=(0,x.useState)(!t),y=(0,x.useCallback)((e=>{const t=e.split("/").pop();t&&s(t)}),[s]);(0,x.useEffect)((()=>{f&&("output.pdf"===f.path&&u.name?s(`${u.name}.pdf`):y(f.path))}),[u,f,s,y]),(0,x.useEffect)((()=>{m&&y(m.path)}),[m,y]),(0,x.useEffect)((()=>{const e=Boolean(j?f:m);a(o&&e)}),[a,o,j,m,f]);return(0,C.jsxs)(Zr.A,{id:"create-file",onSubmit:e=>{e.preventDefault(),O._("new-file-created",{method:"project",extension:i.split(".").length>1?i.split(".").pop():""}),c(j?{name:i,provider:"project_output_file",data:{source_project_id:u._id,source_output_file_path:f.path,build_id:f.build,clsiServerId:f.clsiServerId}}:{name:i,provider:"project_file",data:{source_project_id:u._id,source_entity_path:m.path}})},children:[(0,C.jsx)(ei,{selectedProject:u,setSelectedProject:p}),j?(0,C.jsx)(ti,{selectedProjectId:u?._id,selectedProjectOutputFile:f,setSelectedProjectOutputFile:g}):(0,C.jsx)(ni,{selectedProjectId:u?._id,selectedProjectEntity:m,setSelectedProjectEntity:h}),r&&(0,C.jsxs)("div",{className:"toggle-file-type-button",children:["or ",(0,C.jsx)(w.A,{variant:"link",type:"button",onClick:()=>b((e=>!e)),children:(0,C.jsx)("span",{children:e(j?"select_from_source_files":"select_from_output_files")})})]}),(0,C.jsx)(jr,{label:e("file_name_in_this_project"),classes:{formGroup:"form-controls row-spaced-small"},placeholder:"example.tex",error:l,inFlight:d}),l&&(0,C.jsx)(_r.A,{error:l})]})}function ei(e){let{selectedProject:t,setSelectedProject:n}=e;const{t:r}=(0,_.Bd)(),{_id:i}=(0,he.O)(),{data:s,error:o,loading:a}=(0,Wr.r)(),l=(0,x.useMemo)((()=>s?s.filter((e=>e._id!==i)):null),[s,i]);return o?(0,C.jsx)(_r.A,{error:o}):(0,C.jsxs)(gr.A,{controlId:"project-select",children:[(0,C.jsx)(xr.A,{children:r("select_a_project")}),a&&(0,C.jsxs)("span",{children:[" ",(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"spinner",spin:!0}),bs5:(0,C.jsx)(Oe.A,{animation:"border","aria-hidden":"true",size:"sm",role:"status"})})]}),(0,C.jsxs)(wr.A,{disabled:!s,value:t?t._id:"",onChange:e=>{const t=e.target.value,r=s.find((e=>e._id===t));n(r)},children:[(0,C.jsxs)("option",{disabled:!0,value:"",children:["- ",r("please_select_a_project")]}),l&&l.map((e=>(0,C.jsx)("option",{value:e._id,children:e.name},e._id)))]}),l&&!l.length&&(0,C.jsx)("small",{children:r("no_other_projects_found")})]})}function ti(e){let{selectedProjectId:t,selectedProjectOutputFile:n,setSelectedProjectOutputFile:r}=e;const{t:i}=(0,_.Bd)(),{data:s,error:o,loading:a}=(0,Xr.z)(t);return o?(0,C.jsx)(_r.A,{error:o}):(0,C.jsxs)(gr.A,{className:"row-spaced-small",controlId:"project-output-file-select",children:[(0,C.jsx)(xr.A,{children:i("select_an_output_file")}),a&&(0,C.jsxs)("span",{children:[" ",(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"spinner",spin:!0}),bs5:(0,C.jsx)(Oe.A,{animation:"border","aria-hidden":"true",size:"sm",role:"status"})})]}),(0,C.jsxs)(wr.A,{disabled:!s,value:n?.path||"",onChange:e=>{const t=e.target.value,n=s?.find((e=>e.path===t));r(n)},children:[(0,C.jsxs)("option",{disabled:!0,value:"",children:["- ",i("please_select_an_output_file")]}),s&&s.map((e=>(0,C.jsx)("option",{value:e.path,children:e.path},e.path)))]})]})}function ni(e){let{selectedProjectId:t,selectedProjectEntity:n,setSelectedProjectEntity:r}=e;const{t:i}=(0,_.Bd)(),{data:s,error:o,loading:a}=(0,Qr.i)(t);return o?(0,C.jsx)(_r.A,{error:o}):(0,C.jsxs)(gr.A,{className:"row-spaced-small",controlId:"project-entity-select",children:[(0,C.jsx)(xr.A,{children:i("select_a_file")}),a&&(0,C.jsxs)("span",{children:[" ",(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"spinner",spin:!0}),bs5:(0,C.jsx)(Oe.A,{animation:"border","aria-hidden":"true",size:"sm",role:"status"})})]}),(0,C.jsxs)(wr.A,{disabled:!s,value:n?.path||"",onChange:e=>{const t=e.target.value,n=s.find((e=>e.path===t));r(n)},children:[(0,C.jsxs)("option",{disabled:!0,value:"",children:["- ",i("please_select_a_file")]}),s&&s.map((e=>(0,C.jsx)("option",{value:e.path,children:e.path.slice(1)},e.path)))]})]})}const ri=[{import:o,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/create-file-mode-mendeley"},{import:a,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/create-file-mode-papers"},{import:l,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/create-file-mode-zotero"}],ii=(0,x.lazy)((()=>Promise.all([n.e(8722),n.e(3880),n.e(5380)]).then(n.bind(n,22159))));function si(){const{t:e}=(0,_.Bd)(),{newFileCreateMode:t}=(0,rn.m)(),{fileCount:n}=(0,fe.Q)(),{hasLinkedProjectFileFeature:r,hasLinkedProjectOutputFileFeature:i,hasLinkUrlFeature:s}=(0,yt.A)("ol-ExposedSettings");return n&&"error"!==n.status?(0,C.jsx)("table",{children:(0,C.jsx)("tbody",{children:(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{className:"modal-new-file-list",children:(0,C.jsxs)("ul",{className:"list-unstyled",children:[(0,C.jsx)(ur,{mode:"doc",icon:(0,Fe.q$)({bs5:"description",bs3:"file"}),label:e("new_file")}),(0,C.jsx)(ur,{mode:"upload",icon:"upload",label:e("upload")}),(r||i)&&(0,C.jsx)(ur,{mode:"project",icon:(0,Fe.q$)({bs5:"folder_open",bs3:"folder-open"}),label:e("from_another_project")}),s&&(0,C.jsx)(ur,{mode:"url",icon:"globe",label:e("from_external_url")}),ri.map((e=>{let{import:{CreateFileMode:t},path:n}=e;return(0,C.jsx)(t,{},n)}))]})}),(0,C.jsxs)("td",{className:`modal-new-file-body modal-new-file-body-${t}`,children:["doc"===t&&(0,C.jsx)(hr,{initialName:"name.tex",children:(0,C.jsx)(Kr,{})}),"url"===t&&(0,C.jsx)(hr,{children:(0,C.jsx)(Yr,{})}),"project"===t&&(0,C.jsx)(hr,{children:(0,C.jsx)(Jr,{})}),"upload"===t&&(0,C.jsx)(x.Suspense,{fallback:(0,C.jsx)(_e.e,{delay:500}),children:(0,C.jsx)(ii,{})}),ri.map((e=>{let{import:{CreateFilePane:t},path:n}=e;return(0,C.jsx)(t,{},n)}))]})]})})}):null}function oi(){const{valid:e}=cr(),{newFileCreateMode:t,inFlight:n,cancel:r}=(0,rn.m)(),{fileCount:i}=(0,fe.Q)();return(0,C.jsx)(ai,{valid:e,cancel:r,newFileCreateMode:t,inFlight:n,fileCount:i})}function ai(e){let{valid:t,fileCount:n,inFlight:r,newFileCreateMode:i,cancel:s}=e;const{t:o}=(0,_.Bd)();return(0,C.jsxs)(C.Fragment,{children:["warning"===n.status&&(0,C.jsxs)("div",{className:"modal-footer-left approaching-file-limit",children:[o("project_approaching_file_limit")," (",n.value,"/",n.limit,")"]}),"error"===n.status&&(0,C.jsx)(v.A,{type:"error",className:"at-file-limit",content:o("project_has_too_many_files")}),(0,C.jsx)(w.A,{variant:"secondary",type:"button",disabled:r,onClick:s,children:o("cancel")}),"upload"!==i&&(0,C.jsx)(w.A,{variant:"primary",type:"submit",form:"create-file",disabled:r||!t,isLoading:r,bs3Props:{loading:r?`${o("creating")}…`:o("create")},children:o("create")})]})}function li(){const{t:e}=(0,_.Bd)(),{isCreatingFile:t,cancel:n}=(0,rn.m)();return t?(0,C.jsx)(dr,{children:(0,C.jsxs)(re.Ay,{size:"lg",onHide:n,show:!0,children:[(0,C.jsx)(re.IK,{closeButton:!0,children:(0,C.jsx)(re.rA,{children:e("add_files")})}),(0,C.jsx)(re.$8,{className:"modal-new-file",children:(0,C.jsx)(si,{})}),(0,C.jsx)(re.E9,{children:(0,C.jsx)(oi,{})})]})}):null}ai.propTypes={cancel:le().func.isRequired,fileCount:le().shape({limit:le().number.isRequired,status:le().string.isRequired,value:le().number.isRequired}).isRequired,inFlight:le().bool.isRequired,newFileCreateMode:le().string,valid:le().bool.isRequired};const ci=e=>{let{children:t}=e;const{setIsRootFolderSelected:n,selectedEntityIds:r,select:i}=(0,sn.G1)(),s=(0,x.useCallback)((()=>{n(!0),r.size>1&&i([])}),[i,r.size,n]);return(0,C.jsx)("div",{className:"file-tree-inner",onClick:s,"data-testid":"file-tree-inner",children:t})};var di=n(15043),ui=n(35287);const pi=x.memo((function(e){let{refProviders:t,setRefProviderEnabled:n,setStartedFreeTrial:r,onSelect:i,onInit:s,onDelete:o,isConnected:a}=e;const[l,c]=(0,x.useState)(null),{_id:d}=(0,he.O)(),{fileTreeData:u}=(0,fe.Q)(),p=Boolean(d&&u);return(0,x.useEffect)((()=>{if(l){const e=e=>{if(e.dataTransfer){const{dataset:t}=e.target;if(t.fileId&&t.fileType&&"folder"!==t.fileType){e.dataTransfer.setData("application/x-overleaf-file-id",t.fileId);const n=(0,ui.$X)(u,t.fileId);n&&e.dataTransfer.setData("application/x-overleaf-file-path",n)}}};return l.addEventListener("dragstart",e),()=>{l.removeEventListener("dragstart",e)}}}),[l,u]),(0,x.useEffect)((()=>{p&&s()}),[p,s]),p?(0,C.jsx)("div",{className:"file-tree","data-testid":"file-tree",ref:c,children:l&&(0,C.jsxs)(yn,{refProviders:t,setRefProviderEnabled:n,setStartedFreeTrial:r,onSelect:i,fileTreeContainer:l,children:[a?null:(0,C.jsx)("div",{className:"disconnected-overlay"}),(0,C.jsx)(Qn,{}),(0,C.jsx)(sr,{}),(0,C.jsx)(ci,{children:(0,C.jsx)(mi,{onDelete:o})}),(0,C.jsx)(Xn,{}),(0,C.jsx)(li,{}),(0,C.jsx)(tr,{}),(0,C.jsx)(nr,{})]})}):null}));function mi(e){let{onDelete:t}=e;!function(e){const t=(0,ue.ur)(),{dispatchRename:n,dispatchDelete:r,dispatchMove:i,dispatchCreateFolder:s,dispatchCreateDoc:o,dispatchCreateFile:a,fileTreeData:l}=(0,fe.Q)(),{selectedEntityIds:c,selectedEntityParentIds:d,select:u,unselect:p}=(0,sn.G1)(),{socket:m}=(0,xe.nK)(),{fileTreeFromHistory:h}=(0,q.P4)(),f=(0,x.useCallback)(((e,n,r)=>{r&&t?.id===r&&window.expectingLinkedFileRefreshedSocketFor===n&&(u(e),window.expectingLinkedFileRefreshedSocketFor=null)}),[t,u]);(0,x.useEffect)((()=>{if(!h)return m&&m.on("reciveEntityRename",e),()=>{m&&m.removeListener("reciveEntityRename",e)};function e(e,t){n(e,t)}}),[m,n,h]),(0,x.useEffect)((()=>{if(!h)return m&&m.on("removeEntity",t),()=>{m&&m.removeListener("removeEntity",t)};function t(t){const n=(0,mn.lE)(l,t);if(p(t),d.has(t))for(const e of c)(0,mn.k3)(l,e).path.includes(t)&&p(e);r(t),e&&e(n)}}),[m,p,r,l,c,d,e,h]),(0,x.useEffect)((()=>{if(!h)return m&&m.on("reciveEntityMove",e),()=>{m&&m.removeListener("reciveEntityMove",e)};function e(e,t){i(e,t)}}),[m,i,h]),(0,x.useEffect)((()=>{if(!h)return m&&m.on("reciveNewFolder",e),()=>{m&&m.removeListener("reciveNewFolder",e)};function e(e,t){s(e,t)}}),[m,s,h]),(0,x.useEffect)((()=>{if(!h)return m&&m.on("reciveNewDoc",e),()=>{m&&m.removeListener("reciveNewDoc",e)};function e(e,t,n){o(e,t)}}),[m,o,h]),(0,x.useEffect)((()=>{if(!h)return m&&m.on("reciveNewFile",e),()=>{m&&m.removeListener("reciveNewFile",e)};function e(e,t,n,r,i){a(e,t),r&&f(t._id,t.name,i)}}),[m,a,f,h])}(t);const{fileTreeData:n}=(0,fe.Q)(),{isOver:r,dropRef:i}=jn(n._id),s=(0,di.V)((e=>({isDragging:e.isDragging(),item:e.getItem(),clientOffset:e.getClientOffset()})));return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(kn,{isOver:r,...s}),(0,C.jsx)(Gn,{folders:n.folders,docs:n.docs,files:n.fileRefs,classes:{root:P()("file-tree-list",{"file-tree-dragging":s.isDragging})},dropRef:i,dataTestId:"file-tree-list-root"})]})}const hi=(0,b.A)(pi,ar);var fi=n(99115);const gi=(0,x.memo)((function(){const e=(0,ue.ur)(),{setStartedFreeTrial:t}=(0,tn.yn)(),{isConnected:n,connectionState:r}=(0,A.FX)(),{handleFileTreeInit:i,handleFileTreeSelect:s,handleFileTreeDelete:o}=(0,fi.r)(),[a,l]=(0,x.useState)((()=>e.refProviders||{})),c=(0,x.useCallback)((function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];l((n=>({...n,[e]:t})))}),[]);return(0,C.jsx)(hi,{refProviders:a,setRefProviderEnabled:c,setStartedFreeTrial:t,isConnected:n||null!==r.reconnectAt,onInit:i,onSelect:s,onDelete:o})})),xi=(0,x.memo)((e=>{let{expanded:t,setExpanded:n}=e;const{t:r}=(0,_.Bd)();return(0,C.jsx)("button",{className:"outline-item-expand-collapse-btn",onClick:()=>n((e=>!e)),"aria-label":r(t?"collapse":"expand"),children:(0,C.jsx)(B.A,{type:t?"keyboard_arrow_down":"keyboard_arrow_right",className:"outline-caret-icon"})})}));xi.displayName="OutlineItemToggleButton";const ji=(0,x.memo)((function(e){let{outlineItem:t,jumpToLine:n,highlightedLine:r,matchesHighlightedLine:i,containsHighlightedLine:s}=e;const[o,a]=(0,x.useState)(!0),l=(0,x.useRef)(),c=(0,x.useRef)(!1),d=P()("outline-item",{"outline-item-no-children":!t.children}),u=i||!o&&s,p=P()("outline-item-link",{"outline-item-link-highlight":u});(0,x.useEffect)((()=>{const e=c.current;c.current=u,!e&&u&&(0,An.A)(l.current,{scrollMode:"if-needed",block:"center"})}),[u,l,c]);const m=t.children?o:void 0;return(0,C.jsxs)("li",{className:d,"aria-expanded":m,role:"treeitem","aria-current":u,"aria-label":t.title,children:[(0,C.jsxs)("div",{className:"outline-item-row",children:[!!t.children&&(0,C.jsx)(xi,{expanded:o,setExpanded:a}),(0,C.jsx)("button",{className:p,onClick:function(e){const r=2===e.detail;n(t.line,r)},ref:l,children:t.title})]}),o&&t.children?(0,C.jsx)(vi,{outline:t.children,jumpToLine:n,isRoot:!1,highlightedLine:s?r:null,containsHighlightedLine:s}):null]})}));ji.propTypes={outlineItem:le().exact({line:le().number.isRequired,title:le().string.isRequired,level:le().number,children:le().array,from:le().number,to:le().number}).isRequired,jumpToLine:le().func.isRequired,highlightedLine:le().number,matchesHighlightedLine:le().bool,containsHighlightedLine:le().bool};const bi=ji;function _i(e){return(e||[]).map((e=>_i(e.children).concat(e.line))).flat()}const yi=(0,x.memo)((function(e){let{outline:t,jumpToLine:n,isRoot:r,highlightedLine:i,containsHighlightedLine:s}=e;const o=P()("outline-item-list",{"outline-item-list-root":r});return(0,C.jsx)("ul",{className:o,role:r?"tree":"group",children:t.map(((e,t)=>{const r=s&&i===e.line,o=s&&_i(e.children).includes(i);return(0,C.jsx)(bi,{outlineItem:e,jumpToLine:n,highlightedLine:r||o?i:null,matchesHighlightedLine:r,containsHighlightedLine:o},`${e.level}-${t}`)}))})}));yi.propTypes={outline:le().array.isRequired,jumpToLine:le().func.isRequired,isRoot:le().bool,highlightedLine:le().number,containsHighlightedLine:le().bool};const vi=yi;function wi(e){let{outline:t,jumpToLine:n,highlightedLine:r}=e;const{t:i}=(0,_.Bd)();return(0,C.jsx)("div",{children:t.length?(0,C.jsx)(vi,{outline:t,jumpToLine:n,isRoot:!0,highlightedLine:r,containsHighlightedLine:!0}):(0,C.jsxs)("div",{className:"outline-body-no-elements",children:[i("we_cant_find_any_sections_or_subsections_in_this_file"),"."," ",(0,C.jsx)("a",{href:"/learn/how-to/Using_the_File_Outline_feature",className:"outline-body-link",target:"_blank",rel:"noopener noreferrer",children:i("find_out_more_about_the_file_outline")})]})})}wi.propTypes={outline:le().array.isRequired,jumpToLine:le().func.isRequired,highlightedLine:le().number};const Ci=wi,ki=(0,x.memo)((e=>{let{isTexFile:t,toggleExpanded:n,expanded:r,isOpen:i,isPartial:s}=e;const{t:o}=(0,_.Bd)();return(0,C.jsxs)("button",{className:"outline-header-expand-collapse-btn",disabled:!t,onClick:n,"aria-label":o(r?"hide_outline":"show_outline"),children:[(0,C.jsx)(B.A,{type:i?"keyboard_arrow_down":"keyboard_arrow_right",className:"outline-caret-icon"}),(0,C.jsx)("h4",{className:"outline-header-name",children:o("file_outline")}),s&&(0,C.jsx)(Ne.A,{id:"partial-outline",description:o("partial_outline_warning"),overlayProps:{placement:"top"},children:(0,C.jsx)("span",{role:"status",style:{display:"flex"},children:(0,C.jsx)(B.A,{type:"warning",accessibilityLabel:o("partial_outline_warning")})})})]})}));ki.displayName="OutlineToggleButton";const Ai=x.memo((function(e){let{isTexFile:t,outline:n,jumpToLine:r,onToggle:i,highlightedLine:s,isPartial:o=!1,expanded:a,toggleExpanded:l}=e;const c=Boolean(t&&a);(0,x.useEffect)((()=>{i(c)}),[c,i]);const d=P()("outline-pane",{"outline-pane-disabled":!t});return(0,C.jsxs)("div",{className:d,children:[(0,C.jsx)("header",{className:"outline-header",children:(0,C.jsx)(ki,{toggleExpanded:l,expanded:a,isOpen:c,isPartial:o,isTexFile:t})}),c&&(0,C.jsx)("div",{className:"outline-body",children:(0,C.jsx)(Ci,{outline:n,jumpToLine:r,highlightedLine:s})})]})})),Ei=(0,b.A)(Ai);var Si=n(54830),Ni=n(60347),Ri=n(37766);const Fi=(0,x.memo)((()=>{const{flatOutline:e,highlightedLine:t,canShowOutline:n,jumpToLine:r,outlineExpanded:i,toggleOutlineExpanded:s}=(0,Si.X)(),o=(0,Ri.A)("outline-toggled"),[a,l]=(0,x.useState)((()=>({items:[],partial:!1}))),c=(0,x.useRef)(void 0);return(0,x.useEffect)((()=>{const t=c.current;c.current=e,e?Ti(t?.items,e.items)&&(E.$.log("Rebuilding changed outline"),l({items:(0,Ni.z_)(e.items),partial:e.partial})):l({items:[],partial:!1})}),[e]),(0,C.jsx)("div",{className:"outline-container",children:(0,C.jsx)(Ei,{outline:a.items,onToggle:o,isTexFile:n,jumpToLine:r,highlightedLine:t,isPartial:a.partial,expanded:i,toggleExpanded:s})})}));Fi.displayName="OutlineContainer";const Ti=(e,t)=>{if(!e)return!0;if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];if(r.level!==i.level||r.line!==i.line||r.title!==i.title)return!0}return!1};function Pi(e,t){(0,x.useEffect)((()=>{const n=t.current;n&&(e?n.expand():n.collapse())}),[e,t])}function Li(){const{view:e}=(0,D.LV)(),{outlineEnabled:t,outlinePanelRef:n}=(()=>{const{canShowOutline:e,outlineExpanded:t}=(0,Si.X)(),n=(0,x.useRef)(null),r=e&&t;return Pi(r,n),{outlineEnabled:r,outlinePanelRef:n}})();return(0,C.jsx)("aside",{className:P()("ide-react-editor-sidebar",{hidden:"history"===e}),children:(0,C.jsxs)(F.YZ,{autoSaveId:"ide-editor-sidebar-layout",direction:"vertical",children:[(0,C.jsx)(F.Zk,{defaultSize:50,minSize:25,className:"ide-react-file-tree-panel",id:"panel-file-tree",order:1,children:(0,C.jsx)(gi,{})}),(0,C.jsx)(en,{disabled:!t}),(0,C.jsx)(F.Zk,{defaultSize:50,maxSize:75,id:"panel-outline",order:2,collapsible:!0,ref:n,style:{minHeight:32},children:(0,C.jsx)(Fi,{})})]})})}function Di(){const{t:e}=(0,_.Bd)();return(0,C.jsx)("div",{className:"no-file-selection",children:(0,C.jsx)("div",{className:"no-file-selection-message",children:(0,C.jsx)("h3",{children:e("no_selection_select_file")})})})}const Ii=(e,t)=>e.linkedFileData?.provider===t;function Mi(e){let{file:t}=e;const{t:n}=(0,_.Bd)(),{id:r}=(0,ue.ur)();if(!(Ii(t,"mendeley")||Ii(t,"zotero")||Ii(t,"papers")))return null;return t.linkedFileData.importer_id===r?null:(0,C.jsx)("div",{className:"row",children:(0,C.jsx)("div",{className:P()("p-3 mb-4",(0,Fe.q$)({bs3:"alert"})),children:n("only_importer_can_refresh",{provider:(0,zt.capitalize)(t.linkedFileData.provider)})})})}var Oi=n(52553);const Bi=e=>(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"external-link-square",modifier:"rotate-180",className:"linked-file-icon",...e}),bs5:(0,C.jsx)(B.A,{type:"open_in_new",modifier:"rotate-180",className:"align-middle linked-file-icon",...e})});function qi(e){let{file:t}=e;const{t:n}=(0,_.Bd)();if("mendeley"!==t.linkedFileData.provider&&"papers"!==t.linkedFileData.provider&&"zotero"!==t.linkedFileData.provider)return null;const r={formattedDate:(0,Oi.fU)(t.created),relativeDate:(0,Oi.Pp)(t.created)};return(0,C.jsxs)("p",{children:[(0,C.jsx)(Bi,{fw:!0})," ","mendeley"===t.linkedFileData.provider?n("imported_from_mendeley_at_date",r):"zotero"===t.linkedFileData.provider?n("imported_from_zotero_at_date",r):n("imported_from_papers_at_date",r)]})}qi.propTypes={file:le().shape({created:le().string,linkedFileData:le().shape({provider:le().string})})};var $i=n(93852);const zi=(e,t)=>e.linkedFileData?.provider===t;function Ui(e){let{file:t,refreshing:n,refreshFile:r}=e;const{t:i}=(0,_.Bd)(),{id:s}=(0,ue.ur)(),o=Ii(t,"mendeley")||Ii(t,"zotero")||Ii(t,"papers");let a;o&&(a=t.linkedFileData.importer_id===s);const l=!o||a;return(0,C.jsx)(w.A,{className:P()("btn",{"btn-primary":l,"btn-secondary":!l}),onClick:()=>r(o),disabled:n||!l,bs3Props:{loading:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(X.A,{type:"refresh",spin:n,fw:!0})," ",(0,C.jsx)("span",{children:n?`${i("refreshing")}…`:i("refresh")})]})},isLoading:n,children:i("refresh")})}const Vi=[{import:p,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/file-view/tpr-file-view-refresh-button"}];function Hi(e){let{setRefreshError:t,file:n}=e;const{_id:r}=(0,he.O)(),[i,s]=(0,x.useState)(!1),o=(0,me.A)(),a=(0,x.useCallback)((e=>{s(!0),window.expectingLinkedFileRefreshedSocketFor=n.name;const i={shouldReindexReferences:e||/\.bib$/.test(n.name)};(0,ge.TB)(`/project/${r}/linked_file/${n.id}/refresh`,{body:i}).then((()=>{o.current&&s(!1),(0,O._)("refresh-linked-file",{provider:n.linkedFileData?.provider})})).catch((e=>{o.current&&(s(!1),t(e.data?.message||e.message))}))}),[n,r,t,o]);return Vi.length>0?Vi.map((e=>{let{import:{TPRFileViewRefreshButton:t},path:r}=e;return(0,C.jsx)(t,{file:n,refreshFile:a,refreshing:i},r)}))[0]:(0,C.jsx)(Gi,{refreshFile:a,refreshing:i})}function Gi(e){let{refreshFile:t,refreshing:n}=e;const{t:r}=(0,_.Bd)();return(0,C.jsx)(w.A,{variant:"primary",onClick:()=>t(null),disabled:n,isLoading:n,bs3Props:{loading:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(X.A,{type:"refresh",spin:n,fw:!0})," ",(0,C.jsx)("span",{children:n?`${r("refreshing")}…`:r("refresh")})]})},children:r("refresh")})}function TPRFileViewRefreshError(e){let{file:t,refreshError:n}=e;const r=Ii(t,"mendeley")||Ii(t,"zotero")||Ii(t,"papers");return(0,C.jsx)("div",{className:"file-view-error",children:r?(0,C.jsx)(FileViewThirdPartyReferenceRefreshError,{file:t}):(0,C.jsx)(FileViewDefaultRefreshError,{refreshError:n})})}function FileViewThirdPartyReferenceRefreshError(e){let{file:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsx)(v.A,{type:"error",bs3Props:{className:"tpr-refresh-error"},content:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)("div",{children:[n("something_not_right"),"! ",(0,C.jsx)("span",{children:t.linkedFileData&&n("try_relinking_provider",{provider:(0,zt.capitalize)(t.linkedFileData.provider)})})]}),(0,C.jsx)(w.A,{variant:"secondary",size:"sm",className:"mt-2",href:"/user/settings",target:"_blank",children:n("go_to_settings")})]})})}function FileViewDefaultRefreshError(e){let{refreshError:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsx)(v.A,{type:"error",content:`${n("access_denied")}: ${t}`})}const Ki=[{import:m,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/file-view/tpr-file-view-refresh-error"}];function FileViewRefreshError(e){let{file:t,refreshError:n}=e;const{t:r}=(0,_.Bd)();return Ki.length>0?Ki.map((e=>{let{import:{TPRFileViewRefreshError:r},path:i}=e;return(0,C.jsx)(r,{file:t,refreshError:n},i)}))[0]:(0,C.jsx)("div",{className:"file-view-error",children:(0,C.jsx)(v.A,{type:"error",content:(0,C.jsxs)("span",{children:[r("access_denied"),": ",n]})})})}const Yi=[{import:u,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/file-view/tpr-file-view-info"}],Wi=[{import:d,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/file-view/tpr-file-view-not-original-importer"}],Qi=60,Xi=35,Zi="...",Ji=Qi-Xi-Zi.length;function es(e){if(e){if(e.length>Qi){const t=e.slice(0,Xi),n=e.slice(e.length-Ji);return t+Zi+n}return e}}function ts(e){let{file:t}=e;const{_id:n}=(0,he.O)(),{fileTreeReadOnly:r}=(0,fe.Q)(),{t:i}=(0,_.Bd)(),[s,o]=(0,x.useState)(null);let a;return t.linkedFileData&&(zi(t,"url")?a=(0,C.jsx)(ns,{file:t}):zi(t,"project_file")?a=(0,C.jsx)(rs,{file:t}):zi(t,"project_output_file")&&(a=(0,C.jsx)(is,{file:t}))),(0,C.jsxs)(C.Fragment,{children:[t.linkedFileData&&a,t.linkedFileData&&Yi.map((e=>{let{import:{TPRFileViewInfo:n},path:r}=e;return(0,C.jsx)(n,{file:t},r)})),(0,C.jsxs)("div",{className:"file-view-buttons",children:[t.linkedFileData&&!r&&(0,C.jsx)(Hi,{file:t,setRefreshError:o}),(0,C.jsxs)(w.A,{variant:"secondary",download:t.name,href:(0,$i.i)(n,t.id,t.hash),children:[(0,C.jsx)(ce.A,{bs3:(0,C.jsx)(X.A,{type:"download",fw:!0}),bs5:(0,C.jsx)(B.A,{type:"download",className:"align-middle"})})," ",(0,C.jsx)("span",{children:i("download")})]})]}),t.linkedFileData&&Wi.map((e=>{let{import:{TPRFileViewNotOriginalImporter:n},path:r}=e;return(0,C.jsx)(n,{file:t},r)}))[0],s&&(0,C.jsx)(FileViewRefreshError,{file:t,refreshError:s})]})}function ns(e){let{file:t}=e;return(0,C.jsxs)("p",{children:[(0,C.jsx)(Bi,{})," ",(0,C.jsx)(_.x6,{i18nKey:"imported_from_external_provider_at_date",components:[(0,C.jsx)("a",{href:t.linkedFileData.url})],values:{shortenedUrl:es(t.linkedFileData.url),formattedDate:(0,Oi.fU)(t.created),relativeDate:(0,Oi.Pp)(t.created)},shouldUnescape:!0,tOptions:{interpolation:{escapeValue:!0}}})]})}function rs(e){let{file:t}=e;return(0,C.jsxs)("p",{children:[(0,C.jsx)(Bi,{})," ",(0,C.jsx)(_.x6,{i18nKey:"imported_from_another_project_at_date",components:t.linkedFileData.v1_source_doc_id?[(0,C.jsx)("span",{})]:[(0,C.jsx)("a",{href:`/project/${t.linkedFileData.source_project_id}`,target:"_blank",rel:"noopener"})],values:{sourceEntityPath:t.linkedFileData.source_entity_path.slice(1),formattedDate:(0,Oi.fU)(t.created),relativeDate:(0,Oi.Pp)(t.created)},shouldUnescape:!0,tOptions:{interpolation:{escapeValue:!0}}})]})}function is(e){let{file:t}=e;return(0,C.jsxs)("p",{children:[(0,C.jsx)(Bi,{})," ",(0,C.jsx)(_.x6,{i18nKey:"imported_from_the_output_of_another_project_at_date",components:t.linkedFileData.v1_source_doc_id?[(0,C.jsx)("span",{})]:[(0,C.jsx)("a",{href:`/project/${t.linkedFileData.source_project_id}`,target:"_blank",rel:"noopener"})],values:{sourceOutputFilePath:t.linkedFileData.source_output_file_path,formattedDate:(0,Oi.fU)(t.created),relativeDate:(0,Oi.Pp)(t.created)},shouldUnescape:!0,tOptions:{interpolation:{escapeValue:!0}}})]})}function ss(e){let{file:t,onLoad:n,onError:r}=e;const{_id:i}=(0,he.O)();return(0,C.jsx)("img",{src:(0,$i.i)(i,t.id,t.hash),onLoad:n,onError:r,alt:t.name})}var os=n(89997);const as=e=>{let{fileId:t,onLoad:r,onError:i}=e;const s=(0,me.A)(),{previewByPath:o,pathInFolder:a}=(0,os.m8)(),l=(0,x.useCallback)((async e=>{if(e){const{loadPdfDocumentFromUrl:l}=await Promise.all([n.e(8722),n.e(6597),n.e(2404)]).then(n.bind(n,62404));if(!s.current)return;const c=a(t),d=c?o(c):null;if(!d)return void i();const u=await l(d.url).promise;if(!s.current)return;e.textContent="";const p=window.devicePixelRatio||1;for(let t=1;t<=u.numPages;t++){const n=await u.getPage(t);if(!s.current)return;const r=n.getViewport({scale:p}),i=document.createElement("canvas");i.classList.add("pdf-page"),i.width=r.width,i.height=r.height,i.style.width=r.width/p+"px",i.style.height=r.height/p+"px",e.append(i),n.render({canvasContext:i.getContext("2d"),viewport:r})}r()}}),[s,a,t,o,r,i]);return(0,C.jsx)("div",{className:"file-view-pdf",ref:l})};n(14293);var ls=n(52155);const cs=2097152;function ds(e){let{file:t,onLoad:n,onError:r}=e;const{_id:i}=(0,he.O)(),[s,o]=(0,x.useState)(""),[a,l]=(0,x.useState)(!1),[c,d]=(0,x.useState)(!1),u=(0,ls.A)(),p=(0,ls.A)();return(0,x.useEffect)((()=>{if(c)return;const e=(0,$i.i)(i,t.id,t.hash),s=setTimeout((()=>u.abort()),1e4);let a;fetch(e,{method:"HEAD",signal:u.signal}).then((e=>{if(!e.ok)throw new Error("HTTP Error Code: "+e.status);return e.headers.get("Content-Length")})).then((t=>{let r=!1;const i=new Headers;t&&Number(t)>cs&&(r=!0,i.set("Range",`bytes=0-${cs}`)),a=window.setTimeout((()=>p.abort()),6e4);const s=p.signal;return fetch(e,{signal:s,headers:i}).then((e=>e.text().then((e=>{r&&(e=e.replace(/\n.*$/,"")),o(e),n(),l(r)}))))})).catch((e=>{E.$.error("Error fetching file contents",e),r()})).finally((()=>{d(!1),clearTimeout(s),clearTimeout(a)}))}),[i,t.id,t.hash,r,n,c,u,p]),Boolean(s)&&(0,C.jsx)("div",{className:"text-preview",children:(0,C.jsxs)("div",{className:"scroll-container",children:[(0,C.jsx)("p",{children:s}),a&&(0,C.jsx)("p",{children:"..."})]})})}const us=["png","jpg","jpeg","gif"];function ps(e){let{file:t}=e;const[n,r]=(0,x.useState)(!0),[i,s]=(0,x.useState)(!1),{t:o}=(0,_.Bd)(),{textExtensions:a,editableFilenames:l}=(0,yt.A)("ol-ExposedSettings"),c=t.name.split(".").pop().toLowerCase(),d=a.includes(c)||l.includes(t.name.toLowerCase()),u=us.includes(c),p="pdf"===c,m=!d&&!u&&!p,h=(0,x.useCallback)((()=>{r(!1)}),[]),f=(0,x.useCallback)((()=>{i||(r(!1),s(!0))}),[i]),g=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(ts,{file:t}),u&&(0,C.jsx)(ss,{file:t,onLoad:h,onError:f}),d&&(0,C.jsx)(ds,{file:t,onLoad:h,onError:f}),p&&(0,C.jsx)(as,{fileId:t.id,onLoad:h,onError:f})]});return(0,C.jsxs)("div",{className:"file-view full-size",children:[!i&&g,!m&&n&&(0,C.jsx)(ms,{}),(m||i)&&(0,C.jsx)("p",{className:"no-preview",children:o("no_preview_available")})]})}function ms(){return(0,C.jsx)("div",{className:"loading-panel loading-panel-file-view","data-testid":"loading-panel-file-view",children:(0,C.jsx)(_e.A,{})})}function hs(e){let{selectedEntityCount:t}=e;const{t:n}=(0,_.Bd)();return(0,C.jsx)("div",{className:"multi-selection-ongoing",children:(0,C.jsx)("div",{className:"multi-selection-message",children:(0,C.jsx)("h4",{children:`${t} ${n("files_selected")}`})})})}ps.propTypes={file:le().shape({id:le().string,name:le().string,hash:le().string}).isRequired};var fs=n(40802),gs=n(76966);var xs=n(39891);const js=e=>{let{onDismiss:t,handleLearnMore:n,handleFreeTrialClick:r}=e;const{t:i}=(0,_.Bd)(),s=(0,C.jsxs)("div",{children:[(0,C.jsx)(vr.A,{source:"open-bib-file-upgrade-prompt",buttonProps:{variant:"secondary"},handleClick:r,children:i("upgrade")}),(0,C.jsx)(w.A,{variant:"ghost",bs3Props:{className:"btn-bg-ghost"},href:"/learn/how-to/How_to_link_your_Overleaf_account_to_Mendeley_and_Zotero",target:"blank",onClick:n,children:i("learn_more")})]}),o=(0,C.jsx)("div",{children:i("easily_import_and_sync_your_references")}),a=(0,C.jsx)("img",{src:"/img/third-party-references/book-illlustration.svg","aria-hidden":"true",alt:"better bibliographies",width:64,height:64});return(0,C.jsx)("div",{className:P()("tpr-editor-prompt-container fade-slide-in",(0,Fe.q$)({bs3:"hidden-xs-container",bs5:"d-none d-md-block"})),children:(0,C.jsx)(qr.A,{type:"offer",action:s,isDismissible:!0,isActionBelowContent:!0,customIcon:a,title:i("better_bibliographies"),content:o,onDismiss:t})})},bs="bib-file-tpr-prompt",_s={location:"open-bib-file-upgrade-prompt",name:bs},ys=()=>{const{splitTestVariants:e}=(0,Ar.d1)(),{allowedFreeTrial:t,features:n}=(0,ue.ur)(),{inactiveTutorials:r}=(0,de.mi)(),[i]=(0,S.A)("editor"),{completeTutorial:s,dismissTutorial:o,tryShowingPopup:a,showPopup:l,clearPopup:c}=(0,Br.s)(bs,_s);(0,x.useEffect)((()=>{const s="edit-bib-file"===e["bib-file-tpr-prompt"],o=r.includes(bs),l=t&&!(n?.mendeley||n?.zotero),d=i?.open_doc_name,u=d&&d?.endsWith(".bib");s&&l&&u&&!o?a("reference-manager-prompt-view"):s&&c()}),[t,n,i,r,a,o,e,c]);const d=(0,x.useCallback)((()=>s({event:"promo-click",action:"complete",button:"Upgrade"})),[s]),u=(0,x.useCallback)((()=>O._("promo-click",{..._s,button:"Learn more"})),[]);return l?(0,C.jsx)(js,{handleFreeTrialClick:d,handleLearnMore:u,onDismiss:o}):null},vs=(0,x.memo)(ys);var ws=n(45330);const Cs=[{import:h,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/promotions/edit-bib-file-prompt"}],ks=(0,x.lazy)((()=>Promise.all([n.e(4695),n.e(5982),n.e(1842),n.e(3497),n.e(188),n.e(5463),n.e(6308),n.e(9796),n.e(7565)]).then(n.bind(n,7722))));function As(){return(0,C.jsxs)(x.Suspense,{fallback:(0,C.jsx)(_e.e,{delay:500}),children:[Cs.map((e=>{let{import:{default:t},path:n}=e;return(0,C.jsx)(t,{},n)})),(0,C.jsx)(ks,{})]})}const Es=(0,b.A)((0,x.memo)(As),ws.j),Ss=()=>(0,C.jsx)("div",{className:"loading-panel",children:(0,C.jsx)(_e.A,{})}),Ns=(0,x.lazy)((()=>n.e(744).then(n.bind(n,50744)))),Rs=()=>{const[e]=(0,S.A)("editor"),{selectedEntityCount:t,openEntity:n}=(0,fi.r)(),{currentDocumentId:r}=(0,M.TS)();if(!r)return null;const i=Boolean((!e.sharejs_doc||e.opening)&&!e.error_state&&e.open_doc_id);return(0,C.jsx)("div",{className:P()("ide-react-editor-content","full-size",{hidden:"doc"!==n?.type||1!==t}),children:(0,C.jsxs)(F.YZ,{autoSaveId:"ide-editor-layout",direction:"vertical",children:[(0,C.jsxs)(F.Zk,{id:"panel-source-editor",order:1,className:"ide-react-editor-panel",children:[(0,C.jsx)(Es,{}),i&&(0,C.jsx)(Ss,{})]}),e.showSymbolPalette&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(en,{id:"editor-symbol-palette"}),(0,C.jsx)(F.Zk,{id:"panel-symbol-palette",order:2,defaultSize:25,minSize:10,maxSize:50,children:(0,C.jsx)(x.Suspense,{fallback:(0,C.jsx)(_e.e,{delay:500}),children:(0,C.jsx)(Ns,{})})})]})]})})},Fs=()=>{const[e,t]=(0,x.useState)(!1),{t:n}=(0,_.Bd)(),{togglePdfPane:r,handlePdfPaneExpand:i,handlePdfPaneCollapse:s,setPdfIsOpen:o,pdfIsOpen:a,pdfPanelRef:l}=(()=>{const{view:e,pdfLayout:t,changeLayout:n,detachRole:r,reattach:i}=(0,D.LV)(),s=(0,x.useRef)(null),o="sideBySide"===t||"pdf"===e;Pi(o,s);const a=(0,x.useCallback)((()=>{o?n("flat","editor"):n("sideBySide")}),[n,o]),l=(0,x.useCallback)((e=>{e?("detacher"===r&&i(),n("sideBySide")):n("flat","editor")}),[n,r,i]);return{togglePdfPane:a,handlePdfPaneExpand:(0,x.useCallback)((()=>{"flat"===t&&"editor"===e&&n("sideBySide","editor")}),[n,t,e]),handlePdfPaneCollapse:(0,x.useCallback)((()=>{"sideBySide"===t&&n("flat","editor")}),[n,t]),setPdfIsOpen:l,pdfIsOpen:o,pdfPanelRef:s}})(),{view:c,pdfLayout:d}=(0,D.LV)(),{selectedEntityCount:u,openEntity:p}=(0,fi.r)(),m="editor"===c||"file"===c||"sideBySide"===d;return(0,C.jsxs)(F.YZ,{autoSaveId:"ide-editor-pdf-layout",direction:"horizontal",className:P()({"ide-panel-group-resizing":e,hidden:"history"===c}),children:[(0,C.jsxs)(F.Zk,{id:"panel-ide",order:1,defaultSize:50,minSize:5,className:P()("ide-react-panel",{"ide-panel-group-resizing":e,hidden:!m}),children:[0===u&&(0,C.jsx)(Di,{}),1===u&&"fileRef"===p?.type&&(0,C.jsx)(ps,{file:(0,xs.g)(p.entity)}),u>1&&(0,C.jsx)(hs,{selectedEntityCount:u}),(0,C.jsx)(Rs,{})]}),(0,C.jsxs)(L,{resizable:"sideBySide"===d,onDoubleClick:r,onDragging:t,className:P()({hidden:!m}),hitAreaMargins:{coarse:0,fine:0},children:[(0,C.jsx)(Zt,{id:"editor-pdf",togglerType:"east",isOpen:a,setIsOpen:o,tooltipWhenOpen:n("tooltip_hide_pdf"),tooltipWhenClosed:n("tooltip_show_pdf")}),"sideBySide"===d&&(0,C.jsx)("div",{className:"synctex-controls",children:(0,C.jsx)(fs.Xq,{})})]}),(0,C.jsxs)(F.Zk,{ref:l,id:"panel-pdf",order:2,defaultSize:50,minSize:5,collapsible:!0,onCollapse:s,onExpand:i,className:"ide-react-panel",children:[(0,C.jsx)(gs.A,{}),"flat"===d&&"pdf"===c&&(0,C.jsx)("div",{className:"synctex-controls",hidden:!0,children:(0,C.jsx)(fs.Xq,{})})]})]})},Ts=(0,x.lazy)((()=>Promise.all([n.e(4695),n.e(1842),n.e(188),n.e(5463),n.e(6308),n.e(8892)]).then(n.bind(n,33578))));const Ps=(0,b.A)((function(){const{view:e}=(0,D.LV)();return"history"!==e?null:(0,C.jsx)(x.Suspense,{fallback:(0,C.jsx)(_e.e,{delay:500}),children:(0,C.jsx)(Ts,{})})}),ws.j),Ls=()=>{const{view:e}=(0,D.LV)(),{isOpen:t,setIsOpen:n,panelRef:r,togglePane:i,handlePaneExpand:s,handlePaneCollapse:o,resizing:a,setResizing:l}=(()=>{const[e,t]=(0,x.useState)(!0),[n,r]=(0,x.useState)(!1),i=(0,x.useRef)(null);Pi(e,i);const s=(0,x.useCallback)((()=>{t((e=>!e))}),[]),o=(0,x.useCallback)((()=>{t(!0)}),[]),a=(0,x.useCallback)((()=>{t(!1)}),[]);return{isOpen:e,setIsOpen:t,panelRef:i,togglePane:s,handlePaneExpand:o,handlePaneCollapse:a,resizing:n,setResizing:r}})(),{isOpen:c,panelRef:d,togglePane:u,resizing:p,setResizing:m,handlePaneCollapse:h,handlePaneExpand:f}=(()=>{const{chatIsOpen:e,setChatIsOpen:t}=(0,D.LV)(),[n,r]=(0,x.useState)(!1),i=(0,x.useRef)(null);return Pi(e,i),{isOpen:e,panelRef:i,resizing:n,setResizing:r,togglePane:(0,x.useCallback)((()=>{t((e=>!e))}),[t]),handlePaneExpand:(0,x.useCallback)((()=>{t(!0)}),[t]),handlePaneCollapse:(0,x.useCallback)((()=>{t(!1)}),[t])}})(),g=(0,yt.A)("ol-chatEnabled"),{t:j}=(0,_.Bd)();return(0,C.jsxs)("div",{className:"ide-react-main",children:[(0,C.jsx)(qt,{}),(0,C.jsx)("div",{className:"ide-react-body",children:(0,C.jsxs)(F.YZ,{autoSaveId:"ide-outer-layout",direction:"horizontal",className:P()({"ide-panel-group-resizing":a||p}),children:[(0,C.jsxs)(F.Zk,{ref:r,id:"panel-sidebar",order:1,defaultSize:15,minSize:5,maxSize:80,collapsible:!0,onCollapse:o,onExpand:s,children:[(0,C.jsx)(Li,{}),"history"===e&&(0,C.jsx)(Jt,{})]}),(0,C.jsx)(L,{onDoubleClick:i,resizable:t,onDragging:l,hitAreaMargins:{coarse:0,fine:0},children:(0,C.jsx)(Zt,{id:"panel-sidebar",togglerType:"west",isOpen:t,setIsOpen:n,tooltipWhenOpen:j("tooltip_hide_filetree"),tooltipWhenClosed:j("tooltip_show_filetree")})}),(0,C.jsx)(F.Zk,{id:"panel-outer-main",order:2,children:(0,C.jsxs)(F.YZ,{autoSaveId:"ide-inner-layout",direction:"horizontal",children:[(0,C.jsxs)(F.Zk,{className:"ide-react-panel",id:"panel-main",order:1,children:[(0,C.jsx)(Ps,{}),(0,C.jsx)(Fs,{})]}),g&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(L,{onDoubleClick:u,resizable:c,onDragging:m,hitAreaMargins:{coarse:0,fine:0}}),(0,C.jsx)(F.Zk,{ref:d,id:"panel-chat",order:2,defaultSize:20,minSize:5,maxSize:30,collapsible:!0,onCollapse:h,onExpand:f,children:(0,C.jsx)(Xt,{})})]})]})})]})})]})};var Ds=n(66020);const Is=(0,x.memo)((function(){const{setLeftMenuShown:e}=(0,D.LV)(),{userSettings:t}=(0,Ds.dk)(),{editorTheme:n,overallTheme:r}=t,[i]=(0,x.useState)({editorTheme:n,overallTheme:r}),s=(0,x.useRef)(null);return(0,x.useEffect)((()=>{s.current&&(n===i.editorTheme&&r===i.overallTheme||(s.current.style.opacity="0"))}),[n,r,i]),(0,C.jsx)("div",{id:"left-menu-mask",ref:s,onClick:()=>e(!1)})}));var Ms=n(58278),Os=n(1251),Bs=n(81354),qs=n(7725);const $s=(0,x.lazy)((()=>Promise.all([n.e(4686),n.e(4128)]).then(n.bind(n,54128))));function zs(){const{leftMenuShown:e,setLeftMenuShown:t}=(0,D.LV)(),n=()=>{t(!1)};return(0,C.jsx)(ce.A,{bs3:(0,C.jsxs)(qs.xx,{children:[(0,C.jsx)(Ms.A,{backdropClassName:"left-menu-modal-backdrop",keyboard:!0,onHide:n,id:"left-menu-modal",show:e,children:(0,C.jsx)(Os.A.Body,{className:P()("full-size",{shown:e}),id:"left-menu",children:(0,C.jsx)(x.Suspense,{fallback:(0,C.jsx)(_e.e,{delay:500}),children:(0,C.jsx)($s,{})})})}),e&&(0,C.jsx)(Is,{})]}),bs5:(0,C.jsxs)(qs.xx,{children:[(0,C.jsx)(Bs.A,{show:e,onHide:n,backdropClassName:"left-menu-modal-backdrop",id:"left-menu-offcanvas",children:(0,C.jsx)(Bs.A.Body,{className:P()("full-size","left-menu",{shown:e}),id:"left-menu",children:(0,C.jsx)(x.Suspense,{fallback:(0,C.jsx)(_e.e,{delay:500}),children:(0,C.jsx)($s,{})})})}),e&&(0,C.jsx)(Is,{})]})})}const Us=(0,x.memo)(zs);var Vs=n(6599),Hs=n(31622),Gs=n(60715);const Ks=function(){const{t:e}=(0,_.Bd)(),{socket:t}=(0,A.FX)(),{projectId:n}=(0,tn.yn)(),{showGenericMessageModal:r}=(0,Gs.T)(),[,i]=(0,S.A)("project.publicAccesLevel"),[,s]=(0,S.A)("project.members"),[,o]=(0,S.A)("project.invites"),a=(0,or.z)();(0,Vs.A)(t,"project:access:revoked",(0,x.useCallback)((()=>{r(e("removed_from_project"),e("you_have_been_removed_from_this_project_and_will_be_redirected_to_project_dashboard"));const t=window.setTimeout((()=>{a.assign("/project")}),5e3);return()=>{window.clearTimeout(t)}}),[r,e,a])),(0,Vs.A)(t,"project:publicAccessLevel:changed",(0,x.useCallback)((e=>{e.newAccessLevel&&i(e.newAccessLevel)}),[i])),(0,Vs.A)(t,"project:collaboratorAccessLevel:changed",(0,x.useCallback)((()=>{(0,Hs.hu)(n).then((e=>{let{members:t}=e;t&&s(t)})).catch((e=>{E.$.error("Error fetching members for project",e)}))}),[n,s])),(0,Vs.A)(t,"project:membership:changed",(0,x.useCallback)((e=>{e.members&&(0,Hs.hu)(n).then((e=>{let{members:t}=e;t&&s(t)})).catch((e=>{E.$.error("Error fetching members for project",e)})),e.invites&&(0,Hs.kn)(n).then((e=>{let{invites:t}=e;t&&o(t)})).catch((e=>{E.$.error("Error fetching invites for project",e)}))}),[n,o,s]))};var Ys=n(95898),Ws=n(99420),Qs=n.n(Ws);function Xs(e,t,n){(0,x.useEffect)((()=>(e.addEventListener(t,n),()=>{e.removeEventListener(t,n)})),[e,t,n])}function Zs(){const{projectId:e}=(0,tn.yn)(),{getEditorType:t}=(0,M.TS)(),[n,r]=(0,x.useState)(0),[i,s]=(0,x.useState)((()=>new Date)),o=(0,x.useCallback)((()=>{E.$.log("[Event] heartbeat trigger");const o=t();if(null===o)return;if(i>new Date)return;const a=function(e){const t={editorType:e},n=(0,Ys.T)();if(n.numberOfEntries>0)for(const[e,r]of Object.entries(n)){const n="cm6Perf"+e.charAt(0).toUpperCase()+e.slice(1);null!==r&&(t[n]=r)}return t}(o);E.$.log("[Event] send heartbeat request",a),function(e,t){(0,ge.mI)(`/editingSession/${e}`,{body:{segmentation:t}}).catch(E.$.error)}(e,a),r((e=>e+1));const l=n<=2?30:n<=6?60*(n-2):300;s(Qs()().add(l,"seconds").toDate())}),[t,n,i,e]);(0,Ue.A)("cursor:editor:update",o),(0,Ue.A)("scroll:editor:update",o),Xs(document,"click",o)}var Js=n(71110);function eo(){const{connectionState:e}=(0,A.FX)(),{t}=(0,_.Bd)(),[n,r]=(0,x.useState)(0),[i,s]=(0,x.useState)(!1);return(0,x.useEffect)((()=>{e.forceDisconnected&&s(!0)}),[e.forceDisconnected]),(0,x.useEffect)((()=>{e.forceDisconnected&&r(e.forcedDisconnectDelay)}),[e.forceDisconnected,e.forcedDisconnectDelay]),(0,x.useEffect)((()=>{if(i){const e=window.setInterval((()=>{r((e=>Math.max(0,e-1)))}),1e3);return()=>{window.clearInterval(e)}}}),[i]),i?(0,C.jsxs)(re.Ay,{show:!0,onHide:()=>{},className:"lock-editor-modal",backdrop:!1,keyboard:!1,children:[(0,C.jsx)(re.IK,{children:(0,C.jsx)(re.rA,{children:t("please_wait")})}),(0,C.jsx)(re.$8,{children:t("were_performing_maintenance",{seconds:n})})]}):null}const to=(0,x.memo)(eo),no=()=>{const{t:e}=(0,_.Bd)();return(0,C.jsxs)(re.Ay,{show:!0,onHide:()=>{},className:"lock-editor-modal",backdrop:!1,keyboard:!1,children:[(0,C.jsx)(re.IK,{children:(0,C.jsx)(re.rA,{children:e("connection_lost")})}),(0,C.jsx)(re.$8,{children:e("sorry_the_connection_to_the_server_is_down")})]})},ro=e=>{let{unsavedDocs:t}=e;return(0,C.jsx)(C.Fragment,{children:[...t.entries()].map((e=>{let[t,n]=e;return n>8&&(0,C.jsx)(io,{docId:t,seconds:n},t)}))})},io=e=>{let{docId:t,seconds:n}=e;const{pathInFolder:r,findEntityByPath:i}=(0,os.m8)(),{t:s}=(0,_.Bd)(),o=(0,x.useMemo)((()=>{const e=r(t);return e?i(e):null}),[t,i,r]);return o?(0,C.jsx)(v.A,{type:"warning",content:s("saving_notification_with_seconds",{docname:o.entity.name,seconds:n})}):null},so=()=>{const{openDocs:e,debugTimers:t}=(0,M.TS)(),{permissionsLevel:n,setPermissionsLevel:r}=(0,de.mi)(),[i,s]=(0,x.useState)(!1),[o,a]=(0,x.useState)(new Map),l=(0,N.J)(),c=(0,x.useRef)(o);(0,x.useEffect)((()=>{c.current=o}),[o]);const d=(0,x.useRef)(n);(0,x.useEffect)((()=>{d.current=n}),[n]),(0,Ue.A)("beforeunload",(0,x.useCallback)((t=>{e.hasUnsavedChanges()&&t.preventDefault()}),[e])),(0,x.useEffect)((()=>{const n=window.setInterval((()=>{t.current.CheckUnsavedDocs=Date.now();const n=new Map,r=e.unsavedDocIds();for(const e of r){const t=(c.current.get(e)??0)+1;n.set(e,t)}(n.size>0||c.current.size>0)&&(c.current=n,a(n))}),1e3);return()=>{window.clearInterval(n)}}),[e,t]);const u=Math.max(0,...o.values());(0,x.useEffect)((()=>{s(u>15)}),[u]);const p=(0,x.useRef)(null);return(0,x.useEffect)((()=>{i?(p.current=d.current,r("readOnly"),s(!0)):p.current&&r(p.current)}),[i,r]),(0,x.useEffect)((()=>{0===o.size&&"readOnly"===d.current&&s(!1)}),[o]),(0,C.jsxs)(C.Fragment,{children:[i&&(0,C.jsx)(no,{}),o.size>0&&l&&(0,g.createPortal)((0,C.jsx)(ro,{unsavedDocs:o}),l)]})};var oo=n(37318);const ao=(0,x.memo)((()=>(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(to,{}),(0,C.jsx)(so,{}),(0,C.jsx)(oo.A,{})]})));ao.displayName="Modals";const lo=e=>{let{data:t}=e;const{t:n}=(0,_.Bd)();return t?.filePath||t.providerName?t?.filePath?t.providerName?(0,C.jsx)("span",{children:(0,C.jsx)(_.x6,{i18nKey:"a_new_reference_was_added_to_file_from_provider",shouldUnescape:!0,values:{filePath:t.filePath,provider:t.providerName},tOptions:{interpolation:{escapeValue:!0}},components:[(0,C.jsx)("strong",{})]})}):(0,C.jsx)("span",{children:(0,C.jsx)(_.x6,{i18nKey:"a_new_reference_was_added_to_file",shouldUnescape:!0,values:{filePath:t.filePath},tOptions:{interpolation:{escapeValue:!0}},components:[(0,C.jsx)("strong",{})]})}):(0,C.jsx)("span",{children:n("a_new_reference_was_added_from_provider",{provider:t.providerName})}):(0,C.jsx)("span",{children:n("a_new_reference_was_added")})},co=[{key:"write-and-cite:entry-added",generator:e=>({content:(0,C.jsx)(lo,{data:e}),type:"success",autoHide:!0,delay:4e3,isDismissible:!0})}];var uo=n(27198);const po=e=>{let{children:t,delay:n=5e3,onClose:r,onExited:i,autohide:s,show:o,className:a}=e;const l=(0,x.useRef)(n),c=(0,x.useRef)(r),d=(0,x.useRef)(i),u=Boolean(s&&o),p=(0,x.useCallback)((()=>{u&&(c.current?.(),d.current?.())}),[u]);return(0,x.useEffect)((()=>{const e=window.setTimeout(p,l.current);return()=>window.clearTimeout(e)}),[p]),o?(0,C.jsx)("div",{className:P()("toast",o?"show":"hide",a),"aria-live":"assertive",role:"alert",children:t}):null},mo=e=>{let{type:t="info",className:n="",content:r,title:i,isDismissible:s,onDismiss:o,autoHide:a,delay:l}=e;const{t:c}=(0,_.Bd)(),[d,u]=(0,x.useState)(!0),p=P()("notification",`notification-type-${t}`,n,"toast-content"),m=(0,x.useCallback)((()=>{u(!1)}),[]),h=(0,x.useCallback)((()=>{o&&o()}),[o]),f=(0,C.jsxs)("div",{className:p,children:[(0,C.jsx)(qr.H,{notificationType:t}),(0,C.jsx)("div",{className:"notification-content-and-cta",children:(0,C.jsxs)("div",{className:"notification-content",children:[i&&(0,C.jsx)("p",{children:(0,C.jsx)("b",{children:i})}),r]})}),s&&(0,C.jsx)("div",{className:"notification-close-btn",children:(0,C.jsx)("button",{"aria-label":c("close"),"data-bs-dismiss":"toast",onClick:m,children:(0,C.jsx)(B.A,{type:"close"})})})]});return(0,C.jsx)(ce.A,{bs5:(0,C.jsx)(uo.A,{onClose:m,autohide:a,onExited:h,delay:l,show:d,children:f}),bs3:(0,C.jsx)(po,{onClose:m,autohide:a,delay:l,onExited:h,show:d,children:f})})};var ho=n(69523);const fo=e=>{let{children:t,className:n,...r}=e;return(0,C.jsx)("div",{className:P()("toast-container",n),...r,children:t})},go=e=>{let{children:t,className:n,style:r}=e;return(0,C.jsx)(ce.A,{bs5:(0,C.jsx)(ho.A,{className:n,style:r,children:t}),bs3:(0,C.jsx)(fo,{className:n,style:r,children:t})})},xo=[{import:f,path:"/overleaf/services/web/modules/references-search/frontend/js/toasts"}].map((e=>{let{import:{default:t}}=e;return t})).flat(),jo=new Map(xo.map((e=>{let{key:t,generator:n}=e;return[t,n]})));let bo=1;const _o=()=>{const[e,t]=(0,x.useState)([]),n=(0,x.useCallback)((e=>{t((t=>t.filter((t=>t.id!==e))))}),[]),r=(0,x.useCallback)(((e,t,r)=>{const i=jo.get(t);if(!i)return E.$.error("No toast generator found for key:",t),null;const s=i(r);return s.autoHide||s.isDismissible||(s.isDismissible=!0),s.autoHide&&!s.isDismissible&&void 0!==s.delay&&(s.delay=Math.min(s.delay,6e4)),(0,C.jsx)(mo,{...s,onDismiss:()=>n(e)})}),[n]),i=(0,x.useCallback)(((e,n)=>{const i="toast-"+bo++,s=r(i,e,n);s&&t((e=>[...e,{id:i,component:s}]))}),[r]),s=(0,x.useCallback)((e=>{if(!e.detail?.key)return void E.$.error("No key provided for toast");const{key:t,...n}=e.detail;i(t,n)}),[i]);return(0,Ue.A)("ide:show-toast",s),(0,C.jsx)(go,{className:"global-toasts",children:e.map((e=>{let{component:t,id:n}=e;return(0,C.jsx)(x.Fragment,{children:t},n)}))})};function yo(){return function(){const{view:e,leftMenuShown:t,chatIsOpen:n}=(0,D.LV)();(0,x.useEffect)((()=>{e&&"editor"!==e&&"pdf"!==e&&(0,O.JY)(`ide-open-view-${e}-once`)}),[e]),(0,x.useEffect)((()=>{t&&(0,O.JY)("ide-open-left-menu-once")}),[t]),(0,x.useEffect)((()=>{n&&(0,O.JY)("ide-open-chat-once")}),[n])}(),Ks(),Zs(),function(){const{registerUserActivity:e}=(0,A.FX)();(0,Ue.A)("cursor:editor:update",e),Xs(document.body,"click",e)}(),function useHasLintingError(){const{setHasLintingError:e}=(0,Js.tB)();(0,Ue.A)("editor:lint",(t=>{e(t.detail.hasLintingError)}))}(),function(){const e=(0,xe.nK)(),{fileTreeData:t}=(0,fe.Q)(),n=(0,x.useCallback)((e=>{const n=(0,mn.lE)(t,e);"fileRef"===n?.type&&window.dispatchEvent(new CustomEvent("editor.openDoc",{detail:e}))}),[t]);e.binaryFilesManager={openFileWithId:n}}(),(0,C.jsxs)(N.a,{children:[(0,C.jsx)(R,{}),(0,C.jsx)(ao,{}),(0,C.jsx)(Us,{}),(0,C.jsx)(Ls,{}),(0,C.jsx)(_o,{})]})}var vo=n(10228),wo=n(80997),Co=n(27602);const ko={"io-not-loaded":"ol-translationIoNotLoaded","unable-to-join":"ol-translationUnableToJoin","i18n-error":"ol-translationLoadErrorMessage"},LoadingError=e=>{let{errorCode:t}=e;return t in ko?(0,C.jsx)("p",{className:"loading-screen-error",children:(0,yt.A)(ko[t])}):null},Ao=new Set(["initial"]),Eo=new Set(["initial","render","connection","translations","project"]),So=e=>{let{setLoaded:t}=e;const[n,r]=(0,x.useState)(Ao),i=n.size/Eo.size*100;(0,x.useEffect)((()=>{t(100===i)}),[i,t]);const{connectionState:s,isConnected:o}=(0,A.FX)(),a=(0,Co.A)(),{projectJoined:l}=(0,tn.yn)();(0,x.useEffect)((()=>{r((e=>new Set(e).add("render")))}),[]),(0,x.useEffect)((()=>{o&&r((e=>new Set(e).add("connection")))}),[o]),(0,x.useEffect)((()=>{a.isReady&&r((e=>new Set(e).add("translations")))}),[a.isReady]),(0,x.useEffect)((()=>{l&&r((e=>new Set(e).add("project")))}),[l]);const c=(0,yt.A)("ol-loadingText"),d=s.error??(a.error?"i18n-error":"");return(0,C.jsx)(No,{progress:i,label:c,errorCode:d})},No=e=>{let{progress:t,label:n,errorCode:r}=e;return(0,C.jsxs)("div",{className:"loading-screen",children:[(0,C.jsx)(wo.A,{loadProgress:t,label:n,hasError:Boolean(r)}),Boolean(r)&&(0,C.jsx)(LoadingError,{errorCode:r})]})},Ro=()=>{const[e,t]=(0,x.useState)(!1);return(0,C.jsx)(vo.F,{children:e?(0,C.jsx)(yo,{}):(0,C.jsx)(So,{setLoaded:t})})},Fo=(0,b.A)((0,x.memo)(Ro),j.s);g.render((0,C.jsx)(Fo,{}),document.getElementById("ide-root"));try{if(document.body.parentElement&&document.body.parentElement?.clientHeight<document.body.clientHeight){const e=document.querySelector("#ide-root");e&&(e.style.height="100vh")}}catch{}},57732:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(14041),i=n(57232),s=n(31085);const o=function(e){let{onClick:t,onMouseDown:n,offset:o=50,...a}=e;const l=(0,r.useRef)(!1),c=(0,r.useRef)(),d=a;return(0,r.useEffect)((()=>{const e=e=>{if(l.current){if(l.current=!1,!c.current)return;const n=c.current.width/2,r=c.current.height/2,i=c.current.x+n,s=c.current.y+r,a=Math.abs(e.clientX-i),d=Math.abs(e.clientY-s);a<n+o&&d<r+o&&t()}};return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}}),[t,o]),(0,s.jsx)(i.A,{onMouseDown:e=>{l.current=!0,c.current=e.target.getBoundingClientRect(),n?.(e)},...d})}},75962:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(97434),i=n(96713),s=n(67993),o=n(31085);const a=function(e){let{onDismiss:t,variant:n="light"}=e;const{t:a}=(0,r.Bd)();return(0,o.jsxs)("button",{type:"button",className:`close pull-right ${n}`,onClick:t,children:[(0,o.jsx)(s.A,{bs3:(0,o.jsx)("span",{"aria-hidden":"true",children:"×"}),bs5:(0,o.jsx)(i.A,{type:"close",className:"align-text-bottom",accessibilityLabel:a("close")})}),(0,o.jsx)("span",{className:"sr-only",children:a("close")})]})}},36266:(e,t,n)=>{n.d(t,{s:()=>u});var r=n(97434),i=n(89135),s=n(89753),o=n(29295),a=n(67993),l=n(96713),c=n(71627),d=n(31085);const u=e=>{let{children:t}=e;const{t:n}=(0,r.Bd)(),{reload:u}=(0,s.z)();return(0,d.jsxs)("div",{className:"error-boundary-container",children:[(0,d.jsx)(a.A,{bs3:(0,d.jsx)(i.A,{accessibilityLabel:`${n("generic_something_went_wrong")} ${n("please_refresh")}`,type:"exclamation-triangle fa-2x",fw:!0}),bs5:(0,d.jsx)(l.A,{accessibilityLabel:`${n("generic_something_went_wrong")} ${n("please_refresh")}`,type:"warning",size:"2x"})}),t||(0,d.jsx)("div",{className:"error-message",children:(0,d.jsx)(o.f,{className:"small",style:{fontWeight:"bold"}})}),(0,d.jsx)(c.A,{variant:"primary",onClick:u,children:n("refresh")})]})}},80997:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(31085);function i(e){let{loadProgress:t,label:n,hasError:i=!1}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"loading-screen-brand-container",children:(0,r.jsx)("div",{className:"loading-screen-brand",style:{height:`${t}%`}})}),!i&&(0,r.jsxs)("div",{className:"h3 loading-screen-label","aria-live":"polite",children:[n,(0,r.jsx)("span",{className:"loading-screen-ellip","aria-hidden":"true",children:"."}),(0,r.jsx)("span",{className:"loading-screen-ellip","aria-hidden":"true",children:"."}),(0,r.jsx)("span",{className:"loading-screen-ellip","aria-hidden":"true",children:"."})]})]})}},57232:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(31085);const i=function(e){let{as:t,...n}=e;const i=t||"div";return(0,r.jsx)(i,{...n})}},37318:(e,t,n)=>{n.d(t,{A:()=>h});var r=n(14041),i=n(75962),s=n(42093),o=n(31085);const a=function(e){let{id:t,children:n}=e;const[r,a]=(0,s.A)(`systemMessage.hide.${t}`,!1);return r?null:(0,o.jsxs)("li",{className:"system-message",children:["protected"!==t?(0,o.jsx)(i.A,{onDismiss:()=>a(!0),variant:"dark"}):null,n]})};var l=n(97434),c=n(64932);const d=function(){const{t:e}=(0,l.Bd)(),[t,n]=(0,s.A)("hide-i18n-notification",!1),r=(0,c.A)("ol-suggestedLanguage"),a=(0,c.A)("ol-currentUrl");return t?null:(0,o.jsxs)("li",{className:"system-message",children:[(0,o.jsx)(i.A,{onDismiss:()=>n(!0)}),(0,o.jsx)("div",{className:"text-center",children:(0,o.jsxs)("a",{href:r.url+a,children:[(0,o.jsx)(l.x6,{i18nKey:"click_here_to_view_sl_in_lng",components:[(0,o.jsx)("strong",{})],values:{lngName:r.lngName},shouldUnescape:!0,tOptions:{interpolation:{escapeValue:!0}}}),(0,o.jsx)("img",{className:"ms-1",src:r.imgUrl,alt:e("country_flag",{country:r.lngName}),"aria-hidden":!0})]})})]})};var u=n(37e3),p=n(37858),m=n(60961);const h=function(){const{data:e,runAsync:t}=(0,u.A)(),n=(0,c.A)("ol-suggestedLanguage");return(0,r.useEffect)((()=>{const e=()=>{!document.hidden&&navigator.onLine&&t((0,p.hm)("/system/messages")).catch(m.$.error)};e();const n=setInterval(e,9e5);return()=>{clearInterval(n)}}),[t]),e?.length||n?(0,o.jsxs)("ul",{className:"system-messages",children:[e?.map(((e,t)=>(0,o.jsx)(a,{id:e._id,children:e.content},t))),n?(0,o.jsx)(d,{}):null]}):null}},35447:(e,t,n)=>{n.d(t,{A:()=>c,s:()=>l});var r=n(14041),i=n(5964),s=n(37858),o=n(60961),a=n(10646);const l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[n,l]=(0,r.useState)(!1),{deactivateTutorial:c,currentPopup:d,setCurrentPopup:u}=(0,a.mi)(),p=(0,r.useCallback)((async n=>{let{event:r="promo-click",action:a="complete",...d}=n;i._(r,{...t,...d});try{await(0,s.TB)(`/tutorial/${e}/${a}`)}catch(e){o.$.error(e)}l(!1),c(e)}),[c,t,e]),m=(0,r.useCallback)((async()=>{await p({event:"promo-dismiss",action:"complete"})}),[p]),h=(0,r.useCallback)((async()=>{await p({event:"promo-click",action:"postpone",button:"maybe-later"})}),[p]),f=(0,r.useCallback)((function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"promo-prompt";return null===d&&(u(e),l(!0),i._(n,t),!0)}),[d,u,e,t]),g=(0,r.useCallback)((()=>{d===e&&(u(null),l(!1))}),[u,l,d,e]),x=(0,r.useCallback)((function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"promo-prompt";u(e),l(!0),i._(n,t)}),[u,l,e,t]),j=(0,r.useCallback)((()=>{g(),c(e)}),[g,c,e]);return{completeTutorial:p,dismissTutorial:m,maybeLater:h,tryShowingPopup:f,clearPopup:g,clearAndShow:x,showPopup:n,hideUntilReload:j}},c=l},37e3:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(14041),i=n(90274);const s={status:"idle",data:null,error:null};const o=function(e){const t=r.useRef({...s,...e}),[{status:n,data:o,error:a},l]=r.useReducer(((e,t)=>({...e,...t})),t.current),c=(0,i.A)(l),d=r.useCallback((e=>c({data:e,status:"resolved"})),[c]),u=r.useCallback((e=>c({error:e,status:"rejected"})),[c]),p=r.useCallback((()=>c(t.current)),[c]),m=r.useCallback((e=>(c({status:"pending"}),e.then((e=>(d(e),e)),(e=>(u(e),Promise.reject(e)))))),[c,d,u]);return{isIdle:"idle"===n,isLoading:"pending"===n,isError:"rejected"===n,isSuccess:"resolved"===n,setData:d,setError:u,error:a,status:n,data:o,runAsync:m,reset:p}}},309:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(14041);function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const[n,i]=(0,r.useState)(e);return(0,r.useEffect)((()=>{const n=window.setTimeout((()=>{i(e)}),t);return()=>{window.clearTimeout(n)}}),[e,t]),n}},93045:(e,t,n)=>{n.d(t,{U:()=>i});var r=n(14041);function i(){const e=(0,r.useRef)(null),[t,n]=(0,r.useState)(!1),i=(0,r.useCallback)((()=>n(!1)),[]);return(0,r.useEffect)((()=>{if(t)return;let r=null;return e.current&&(r=window.requestAnimationFrame((()=>{e.current&&(e.current.focus(),n(!0),r=null)}))),()=>{null!==r&&window.cancelAnimationFrame(r)}})),{autoFocusedRef:e,resetAutoFocus:i}}},90274:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(14041),i=n(69475);const s=function(e){const t=(0,i.A)();return r.useCallback((n=>{t.current&&e(n)}),[e,t])}},13653:(e,t,n)=>{n.d(t,{Q:()=>s});var r=n(14041),i=n(49791);const s=e=>{const t=(0,i.M)();(0,r.useEffect)((()=>{const n=new AbortController;return t?.addEventListener("message",(t=>{let{data:n}=t;return e(n)}),{signal:n.signal}),()=>n.abort()}),[t,e])}},49791:(e,t,n)=>{n.d(t,{M:()=>i});var r=n(14041);const i=()=>{const e=(0,r.useRef)(null);return null===e.current&&"BroadcastChannel"in window&&(e.current=new BroadcastChannel("user")),(0,r.useEffect)((()=>()=>e.current?.close()),[]),e.current}},37365:(e,t,n)=>{n.d(t,{O:()=>l});var r=n(35573);const i=100,s=200,o=20,a=360;function l(e,t){if(null==e||"anonymous-user"===e)return i;if(t===e)return s;let n=function(e){const t=(0,r.K)(e),n=parseInt(t.toString().slice(0,8),16)%(a-2*o);return n}(e);return n>s-o&&n<s+o&&(n-=s,n=n+a-o),n}},37235:(e,t,n)=>{function r(){return!!document.querySelector("grammarly-desktop-integration")}n.d(t,{A:()=>r})},86954:(e,t,n)=>{n.d(t,{F:()=>o,Y:()=>s});var r=n(99420),i=n.n(r);function s(e,t){return e?(null==t&&(t="Do MMM YYYY, h:mm a"),i()(e).format(t)):"N/A"}function o(e){return i()(e).fromNow()}},18730:(e,t,n)=>{n.d(t,{J:()=>o});var r=n(14041),i=n(37858),s=n(52155);function o(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[n,o]=(0,r.useState)(!1),[a,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),{signal:u}=(0,s.A)();return(0,r.useEffect)((()=>{t&&(o(!0),d(null),l(null),(0,i.hm)(`/${e}/groups`,{signal:u}).then((e=>{l(e.groups)})).catch((e=>{400===e.response.status?e.data.relink&&d("relink"):d("loading_groups")})).finally((()=>{o(!1)})))}),[t,e,u]),{loading:n,data:a,error:c}}}},e=>(e.O(0,[1258,4737,6964,613,5250,6736,8732,2619,9512,676,9420,3642,8777,4415,8496,3173,826,9773,8876,1250,3156,98,4710,9608],(()=>{return t=29868,e(e.s=t);var t})),e.O())])));